"use strict";var Th=Object.create;var ka=Object.defineProperty;var Oh=Object.getOwnPropertyDescriptor;var Lh=Object.getOwnPropertyNames;var Ph=Object.getPrototypeOf,Uh=Object.prototype.hasOwnProperty;var _e=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports);var Dh=(n,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Lh(t))!Uh.call(n,i)&&i!==e&&ka(n,i,{get:()=>t[i],enumerable:!(r=Oh(t,i))||r.enumerable});return n};var ln=(n,t,e)=>(e=n!=null?Th(Ph(n)):{},Dh(t||!n||!n.__esModule?ka(e,"default",{value:n,enumerable:!0}):e,n));var Li=_e(Ir=>{"use strict";Object.defineProperty(Ir,"__esModule",{value:!0});Ir.toCommandProperties=Ir.toCommandValue=void 0;function Qh(n){return n==null?"":typeof n=="string"||n instanceof String?n:JSON.stringify(n)}Ir.toCommandValue=Qh;function Hh(n){return Object.keys(n).length?{title:n.title,file:n.file,line:n.startLine,endLine:n.endLine,col:n.startColumn,endColumn:n.endColumn}:{}}Ir.toCommandProperties=Hh});var Pa=_e(rn=>{"use strict";var Fh=rn&&rn.__createBinding||(Object.create?function(n,t,e,r){r===void 0&&(r=e),Object.defineProperty(n,r,{enumerable:!0,get:function(){return t[e]}})}:function(n,t,e,r){r===void 0&&(r=e),n[r]=t[e]}),qh=rn&&rn.__setModuleDefault||(Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t}),Mh=rn&&rn.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var e in n)e!=="default"&&Object.hasOwnProperty.call(n,e)&&Fh(t,n,e);return qh(t,n),t};Object.defineProperty(rn,"__esModule",{value:!0});rn.issue=rn.issueCommand=void 0;var Kh=Mh(require("os")),Oa=Li();function La(n,t,e){let r=new no(n,t,e);process.stdout.write(r.toString()+Kh.EOL)}rn.issueCommand=La;function Wh(n,t=""){La(n,{},t)}rn.issue=Wh;var Ta="::",no=class{constructor(t,e,r){t||(t="missing.command"),this.command=t,this.properties=e,this.message=r}toString(){let t=Ta+this.command;if(this.properties&&Object.keys(this.properties).length>0){t+=" ";let e=!0;for(let r in this.properties)if(this.properties.hasOwnProperty(r)){let i=this.properties[r];i&&(e?e=!1:t+=",",t+=`${r}=${$h(i)}`)}}return t+=`${Ta}${Gh(this.message)}`,t}};function Gh(n){return Oa.toCommandValue(n).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function $h(n){return Oa.toCommandValue(n).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}});var Qa=_e(bn=>{"use strict";var Yh=bn&&bn.__createBinding||(Object.create?function(n,t,e,r){r===void 0&&(r=e),Object.defineProperty(n,r,{enumerable:!0,get:function(){return t[e]}})}:function(n,t,e,r){r===void 0&&(r=e),n[r]=t[e]}),jh=bn&&bn.__setModuleDefault||(Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t}),Da=bn&&bn.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var e in n)e!=="default"&&Object.hasOwnProperty.call(n,e)&&Yh(t,n,e);return jh(t,n),t};Object.defineProperty(bn,"__esModule",{value:!0});bn.issueCommand=void 0;var Ua=Da(require("fs")),Xh=Da(require("os")),Vh=Li();function zh(n,t){let e=process.env[`GITHUB_${n}`];if(!e)throw new Error(`Unable to find environment variable for file command ${n}`);if(!Ua.existsSync(e))throw new Error(`Missing file at path: ${e}`);Ua.appendFileSync(e,`${Vh.toCommandValue(t)}${Xh.EOL}`,{encoding:"utf8"})}bn.issueCommand=zh});var io=_e(ro=>{"use strict";Object.defineProperty(ro,"__esModule",{value:!0});ro.default=ed;var Jh=Zh(require("crypto"));function Zh(n){return n&&n.__esModule?n:{default:n}}var Ui=new Uint8Array(256),Pi=Ui.length;function ed(){return Pi>Ui.length-16&&(Jh.default.randomFillSync(Ui),Pi=0),Ui.slice(Pi,Pi+=16)}});var Ha=_e(Di=>{"use strict";Object.defineProperty(Di,"__esModule",{value:!0});Di.default=void 0;var td=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;Di.default=td});var Zr=_e(Qi=>{"use strict";Object.defineProperty(Qi,"__esModule",{value:!0});Qi.default=void 0;var nd=rd(Ha());function rd(n){return n&&n.__esModule?n:{default:n}}function id(n){return typeof n=="string"&&nd.default.test(n)}var sd=id;Qi.default=sd});var ei=_e(Hi=>{"use strict";Object.defineProperty(Hi,"__esModule",{value:!0});Hi.default=void 0;var od=fd(Zr());function fd(n){return n&&n.__esModule?n:{default:n}}var Ot=[];for(let n=0;n<256;++n)Ot.push((n+256).toString(16).substr(1));function ad(n,t=0){let e=(Ot[n[t+0]]+Ot[n[t+1]]+Ot[n[t+2]]+Ot[n[t+3]]+"-"+Ot[n[t+4]]+Ot[n[t+5]]+"-"+Ot[n[t+6]]+Ot[n[t+7]]+"-"+Ot[n[t+8]]+Ot[n[t+9]]+"-"+Ot[n[t+10]]+Ot[n[t+11]]+Ot[n[t+12]]+Ot[n[t+13]]+Ot[n[t+14]]+Ot[n[t+15]]).toLowerCase();if(!(0,od.default)(e))throw TypeError("Stringified UUID is invalid");return e}var cd=ad;Hi.default=cd});var Ma=_e(Fi=>{"use strict";Object.defineProperty(Fi,"__esModule",{value:!0});Fi.default=void 0;var ud=qa(io()),ld=qa(ei());function qa(n){return n&&n.__esModule?n:{default:n}}var Fa,so,oo=0,fo=0;function hd(n,t,e){let r=t&&e||0,i=t||new Array(16);n=n||{};let s=n.node||Fa,o=n.clockseq!==void 0?n.clockseq:so;if(s==null||o==null){let A=n.random||(n.rng||ud.default)();s==null&&(s=Fa=[A[0]|1,A[1],A[2],A[3],A[4],A[5]]),o==null&&(o=so=(A[6]<<8|A[7])&16383)}let f=n.msecs!==void 0?n.msecs:Date.now(),a=n.nsecs!==void 0?n.nsecs:fo+1,u=f-oo+(a-fo)/1e4;if(u<0&&n.clockseq===void 0&&(o=o+1&16383),(u<0||f>oo)&&n.nsecs===void 0&&(a=0),a>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");oo=f,fo=a,so=o,f+=122192928e5;let h=((f&268435455)*1e4+a)%4294967296;i[r++]=h>>>24&255,i[r++]=h>>>16&255,i[r++]=h>>>8&255,i[r++]=h&255;let l=f/4294967296*1e4&268435455;i[r++]=l>>>8&255,i[r++]=l&255,i[r++]=l>>>24&15|16,i[r++]=l>>>16&255,i[r++]=o>>>8|128,i[r++]=o&255;for(let A=0;A<6;++A)i[r+A]=s[A];return t||(0,ld.default)(i)}var dd=hd;Fi.default=dd});var ao=_e(qi=>{"use strict";Object.defineProperty(qi,"__esModule",{value:!0});qi.default=void 0;var Ad=_d(Zr());function _d(n){return n&&n.__esModule?n:{default:n}}function gd(n){if(!(0,Ad.default)(n))throw TypeError("Invalid UUID");let t,e=new Uint8Array(16);return e[0]=(t=parseInt(n.slice(0,8),16))>>>24,e[1]=t>>>16&255,e[2]=t>>>8&255,e[3]=t&255,e[4]=(t=parseInt(n.slice(9,13),16))>>>8,e[5]=t&255,e[6]=(t=parseInt(n.slice(14,18),16))>>>8,e[7]=t&255,e[8]=(t=parseInt(n.slice(19,23),16))>>>8,e[9]=t&255,e[10]=(t=parseInt(n.slice(24,36),16))/1099511627776&255,e[11]=t/4294967296&255,e[12]=t>>>24&255,e[13]=t>>>16&255,e[14]=t>>>8&255,e[15]=t&255,e}var Ed=gd;qi.default=Ed});var co=_e(nr=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});nr.default=yd;nr.URL=nr.DNS=void 0;var pd=Ka(ei()),bd=Ka(ao());function Ka(n){return n&&n.__esModule?n:{default:n}}function Id(n){n=unescape(encodeURIComponent(n));let t=[];for(let e=0;e<n.length;++e)t.push(n.charCodeAt(e));return t}var Wa="6ba7b810-9dad-11d1-80b4-00c04fd430c8";nr.DNS=Wa;var Ga="6ba7b811-9dad-11d1-80b4-00c04fd430c8";nr.URL=Ga;function yd(n,t,e){function r(i,s,o,f){if(typeof i=="string"&&(i=Id(i)),typeof s=="string"&&(s=(0,bd.default)(s)),s.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let a=new Uint8Array(16+i.length);if(a.set(s),a.set(i,s.length),a=e(a),a[6]=a[6]&15|t,a[8]=a[8]&63|128,o){f=f||0;for(let u=0;u<16;++u)o[f+u]=a[u];return o}return(0,pd.default)(a)}try{r.name=n}catch{}return r.DNS=Wa,r.URL=Ga,r}});var $a=_e(Mi=>{"use strict";Object.defineProperty(Mi,"__esModule",{value:!0});Mi.default=void 0;var xd=wd(require("crypto"));function wd(n){return n&&n.__esModule?n:{default:n}}function Sd(n){return Array.isArray(n)?n=Buffer.from(n):typeof n=="string"&&(n=Buffer.from(n,"utf8")),xd.default.createHash("md5").update(n).digest()}var md=Sd;Mi.default=md});var ja=_e(Ki=>{"use strict";Object.defineProperty(Ki,"__esModule",{value:!0});Ki.default=void 0;var Cd=Ya(co()),Rd=Ya($a());function Ya(n){return n&&n.__esModule?n:{default:n}}var Bd=(0,Cd.default)("v3",48,Rd.default),vd=Bd;Ki.default=vd});var Va=_e(Wi=>{"use strict";Object.defineProperty(Wi,"__esModule",{value:!0});Wi.default=void 0;var Nd=Xa(io()),kd=Xa(ei());function Xa(n){return n&&n.__esModule?n:{default:n}}function Td(n,t,e){n=n||{};let r=n.random||(n.rng||Nd.default)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){e=e||0;for(let i=0;i<16;++i)t[e+i]=r[i];return t}return(0,kd.default)(r)}var Od=Td;Wi.default=Od});var za=_e(Gi=>{"use strict";Object.defineProperty(Gi,"__esModule",{value:!0});Gi.default=void 0;var Ld=Pd(require("crypto"));function Pd(n){return n&&n.__esModule?n:{default:n}}function Ud(n){return Array.isArray(n)?n=Buffer.from(n):typeof n=="string"&&(n=Buffer.from(n,"utf8")),Ld.default.createHash("sha1").update(n).digest()}var Dd=Ud;Gi.default=Dd});var Za=_e($i=>{"use strict";Object.defineProperty($i,"__esModule",{value:!0});$i.default=void 0;var Qd=Ja(co()),Hd=Ja(za());function Ja(n){return n&&n.__esModule?n:{default:n}}var Fd=(0,Qd.default)("v5",80,Hd.default),qd=Fd;$i.default=qd});var ec=_e(Yi=>{"use strict";Object.defineProperty(Yi,"__esModule",{value:!0});Yi.default=void 0;var Md="00000000-0000-0000-0000-000000000000";Yi.default=Md});var tc=_e(ji=>{"use strict";Object.defineProperty(ji,"__esModule",{value:!0});ji.default=void 0;var Kd=Wd(Zr());function Wd(n){return n&&n.__esModule?n:{default:n}}function Gd(n){if(!(0,Kd.default)(n))throw TypeError("Invalid UUID");return parseInt(n.substr(14,1),16)}var $d=Gd;ji.default=$d});var nc=_e(hn=>{"use strict";Object.defineProperty(hn,"__esModule",{value:!0});Object.defineProperty(hn,"v1",{enumerable:!0,get:function(){return Yd.default}});Object.defineProperty(hn,"v3",{enumerable:!0,get:function(){return jd.default}});Object.defineProperty(hn,"v4",{enumerable:!0,get:function(){return Xd.default}});Object.defineProperty(hn,"v5",{enumerable:!0,get:function(){return Vd.default}});Object.defineProperty(hn,"NIL",{enumerable:!0,get:function(){return zd.default}});Object.defineProperty(hn,"version",{enumerable:!0,get:function(){return Jd.default}});Object.defineProperty(hn,"validate",{enumerable:!0,get:function(){return Zd.default}});Object.defineProperty(hn,"stringify",{enumerable:!0,get:function(){return e0.default}});Object.defineProperty(hn,"parse",{enumerable:!0,get:function(){return t0.default}});var Yd=Bn(Ma()),jd=Bn(ja()),Xd=Bn(Va()),Vd=Bn(Za()),zd=Bn(ec()),Jd=Bn(tc()),Zd=Bn(Zr()),e0=Bn(ei()),t0=Bn(ao());function Bn(n){return n&&n.__esModule?n:{default:n}}});var ic=_e(yr=>{"use strict";Object.defineProperty(yr,"__esModule",{value:!0});yr.checkBypass=yr.getProxyUrl=void 0;function n0(n){let t=n.protocol==="https:";if(rc(n))return;let e=(()=>t?process.env.https_proxy||process.env.HTTPS_PROXY:process.env.http_proxy||process.env.HTTP_PROXY)();if(e)return new URL(e)}yr.getProxyUrl=n0;function rc(n){if(!n.hostname)return!1;let t=process.env.no_proxy||process.env.NO_PROXY||"";if(!t)return!1;let e;n.port?e=Number(n.port):n.protocol==="http:"?e=80:n.protocol==="https:"&&(e=443);let r=[n.hostname.toUpperCase()];typeof e=="number"&&r.push(`${r[0]}:${e}`);for(let i of t.split(",").map(s=>s.trim().toUpperCase()).filter(s=>s))if(r.some(s=>s===i))return!0;return!1}yr.checkBypass=rc});var ac=_e(xr=>{"use strict";var jp=require("net"),r0=require("tls"),uo=require("http"),sc=require("https"),i0=require("events"),Xp=require("assert"),s0=require("util");xr.httpOverHttp=o0;xr.httpsOverHttp=f0;xr.httpOverHttps=a0;xr.httpsOverHttps=c0;function o0(n){var t=new vn(n);return t.request=uo.request,t}function f0(n){var t=new vn(n);return t.request=uo.request,t.createSocket=oc,t.defaultPort=443,t}function a0(n){var t=new vn(n);return t.request=sc.request,t}function c0(n){var t=new vn(n);return t.request=sc.request,t.createSocket=oc,t.defaultPort=443,t}function vn(n){var t=this;t.options=n||{},t.proxyOptions=t.options.proxy||{},t.maxSockets=t.options.maxSockets||uo.Agent.defaultMaxSockets,t.requests=[],t.sockets=[],t.on("free",function(r,i,s,o){for(var f=fc(i,s,o),a=0,u=t.requests.length;a<u;++a){var h=t.requests[a];if(h.host===f.host&&h.port===f.port){t.requests.splice(a,1),h.request.onSocket(r);return}}r.destroy(),t.removeSocket(r)})}s0.inherits(vn,i0.EventEmitter);vn.prototype.addRequest=function(t,e,r,i){var s=this,o=lo({request:t},s.options,fc(e,r,i));if(s.sockets.length>=this.maxSockets){s.requests.push(o);return}s.createSocket(o,function(f){f.on("free",a),f.on("close",u),f.on("agentRemove",u),t.onSocket(f);function a(){s.emit("free",f,o)}function u(h){s.removeSocket(f),f.removeListener("free",a),f.removeListener("close",u),f.removeListener("agentRemove",u)}})};vn.prototype.createSocket=function(t,e){var r=this,i={};r.sockets.push(i);var s=lo({},r.proxyOptions,{method:"CONNECT",path:t.host+":"+t.port,agent:!1,headers:{host:t.host+":"+t.port}});t.localAddress&&(s.localAddress=t.localAddress),s.proxyAuth&&(s.headers=s.headers||{},s.headers["Proxy-Authorization"]="Basic "+new Buffer(s.proxyAuth).toString("base64")),Hn("making CONNECT request");var o=r.request(s);o.useChunkedEncodingByDefault=!1,o.once("response",f),o.once("upgrade",a),o.once("connect",u),o.once("error",h),o.end();function f(l){l.upgrade=!0}function a(l,A,p){process.nextTick(function(){u(l,A,p)})}function u(l,A,p){if(o.removeAllListeners(),A.removeAllListeners(),l.statusCode!==200){Hn("tunneling socket could not be established, statusCode=%d",l.statusCode),A.destroy();var y=new Error("tunneling socket could not be established, statusCode="+l.statusCode);y.code="ECONNRESET",t.request.emit("error",y),r.removeSocket(i);return}if(p.length>0){Hn("got illegal response body from proxy"),A.destroy();var y=new Error("got illegal response body from proxy");y.code="ECONNRESET",t.request.emit("error",y),r.removeSocket(i);return}return Hn("tunneling connection has established"),r.sockets[r.sockets.indexOf(i)]=A,e(A)}function h(l){o.removeAllListeners(),Hn(`tunneling socket could not be established, cause=%s
`,l.message,l.stack);var A=new Error("tunneling socket could not be established, cause="+l.message);A.code="ECONNRESET",t.request.emit("error",A),r.removeSocket(i)}};vn.prototype.removeSocket=function(t){var e=this.sockets.indexOf(t);if(e!==-1){this.sockets.splice(e,1);var r=this.requests.shift();r&&this.createSocket(r,function(i){r.request.onSocket(i)})}};function oc(n,t){var e=this;vn.prototype.createSocket.call(e,n,function(r){var i=n.request.getHeader("host"),s=lo({},e.options,{socket:r,servername:i?i.replace(/:.*$/,""):n.host}),o=r0.connect(0,s);e.sockets[e.sockets.indexOf(r)]=o,t(o)})}function fc(n,t,e){return typeof n=="string"?{host:n,port:t,localAddress:e}:n}function lo(n){for(var t=1,e=arguments.length;t<e;++t){var r=arguments[t];if(typeof r=="object")for(var i=Object.keys(r),s=0,o=i.length;s<o;++s){var f=i[s];r[f]!==void 0&&(n[f]=r[f])}}return n}var Hn;process.env.NODE_DEBUG&&/\btunnel\b/.test(process.env.NODE_DEBUG)?Hn=function(){var n=Array.prototype.slice.call(arguments);typeof n[0]=="string"?n[0]="TUNNEL: "+n[0]:n.unshift("TUNNEL:"),console.error.apply(console,n)}:Hn=function(){};xr.debug=Hn});var uc=_e((zp,cc)=>{cc.exports=ac()});var hc=_e(ut=>{"use strict";var u0=ut&&ut.__createBinding||(Object.create?function(n,t,e,r){r===void 0&&(r=e),Object.defineProperty(n,r,{enumerable:!0,get:function(){return t[e]}})}:function(n,t,e,r){r===void 0&&(r=e),n[r]=t[e]}),l0=ut&&ut.__setModuleDefault||(Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t}),Zi=ut&&ut.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var e in n)e!=="default"&&Object.hasOwnProperty.call(n,e)&&u0(t,n,e);return l0(t,n),t},vt=ut&&ut.__awaiter||function(n,t,e,r){function i(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function f(h){try{u(r.next(h))}catch(l){o(l)}}function a(h){try{u(r.throw(h))}catch(l){o(l)}}function u(h){h.done?s(h.value):i(h.value).then(f,a)}u((r=r.apply(n,t||[])).next())})};Object.defineProperty(ut,"__esModule",{value:!0});ut.HttpClient=ut.isHttps=ut.HttpClientResponse=ut.HttpClientError=ut.getProxyUrl=ut.MediaTypes=ut.Headers=ut.HttpCodes=void 0;var Xi=Zi(require("http")),ho=Zi(require("https")),lc=Zi(ic()),Vi=Zi(uc()),dn;(function(n){n[n.OK=200]="OK",n[n.MultipleChoices=300]="MultipleChoices",n[n.MovedPermanently=301]="MovedPermanently",n[n.ResourceMoved=302]="ResourceMoved",n[n.SeeOther=303]="SeeOther",n[n.NotModified=304]="NotModified",n[n.UseProxy=305]="UseProxy",n[n.SwitchProxy=306]="SwitchProxy",n[n.TemporaryRedirect=307]="TemporaryRedirect",n[n.PermanentRedirect=308]="PermanentRedirect",n[n.BadRequest=400]="BadRequest",n[n.Unauthorized=401]="Unauthorized",n[n.PaymentRequired=402]="PaymentRequired",n[n.Forbidden=403]="Forbidden",n[n.NotFound=404]="NotFound",n[n.MethodNotAllowed=405]="MethodNotAllowed",n[n.NotAcceptable=406]="NotAcceptable",n[n.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",n[n.RequestTimeout=408]="RequestTimeout",n[n.Conflict=409]="Conflict",n[n.Gone=410]="Gone",n[n.TooManyRequests=429]="TooManyRequests",n[n.InternalServerError=500]="InternalServerError",n[n.NotImplemented=501]="NotImplemented",n[n.BadGateway=502]="BadGateway",n[n.ServiceUnavailable=503]="ServiceUnavailable",n[n.GatewayTimeout=504]="GatewayTimeout"})(dn=ut.HttpCodes||(ut.HttpCodes={}));var qt;(function(n){n.Accept="accept",n.ContentType="content-type"})(qt=ut.Headers||(ut.Headers={}));var Fn;(function(n){n.ApplicationJson="application/json"})(Fn=ut.MediaTypes||(ut.MediaTypes={}));function h0(n){let t=lc.getProxyUrl(new URL(n));return t?t.href:""}ut.getProxyUrl=h0;var d0=[dn.MovedPermanently,dn.ResourceMoved,dn.SeeOther,dn.TemporaryRedirect,dn.PermanentRedirect],A0=[dn.BadGateway,dn.ServiceUnavailable,dn.GatewayTimeout],_0=["OPTIONS","GET","DELETE","HEAD"],g0=10,E0=5,wr=class extends Error{constructor(t,e){super(t),this.name="HttpClientError",this.statusCode=e,Object.setPrototypeOf(this,wr.prototype)}};ut.HttpClientError=wr;var Ji=class{constructor(t){this.message=t}readBody(){return vt(this,void 0,void 0,function*(){return new Promise(t=>vt(this,void 0,void 0,function*(){let e=Buffer.alloc(0);this.message.on("data",r=>{e=Buffer.concat([e,r])}),this.message.on("end",()=>{t(e.toString())})}))})}};ut.HttpClientResponse=Ji;function p0(n){return new URL(n).protocol==="https:"}ut.isHttps=p0;var Ao=class{constructor(t,e,r){this._ignoreSslError=!1,this._allowRedirects=!0,this._allowRedirectDowngrade=!1,this._maxRedirects=50,this._allowRetries=!1,this._maxRetries=1,this._keepAlive=!1,this._disposed=!1,this.userAgent=t,this.handlers=e||[],this.requestOptions=r,r&&(r.ignoreSslError!=null&&(this._ignoreSslError=r.ignoreSslError),this._socketTimeout=r.socketTimeout,r.allowRedirects!=null&&(this._allowRedirects=r.allowRedirects),r.allowRedirectDowngrade!=null&&(this._allowRedirectDowngrade=r.allowRedirectDowngrade),r.maxRedirects!=null&&(this._maxRedirects=Math.max(r.maxRedirects,0)),r.keepAlive!=null&&(this._keepAlive=r.keepAlive),r.allowRetries!=null&&(this._allowRetries=r.allowRetries),r.maxRetries!=null&&(this._maxRetries=r.maxRetries))}options(t,e){return vt(this,void 0,void 0,function*(){return this.request("OPTIONS",t,null,e||{})})}get(t,e){return vt(this,void 0,void 0,function*(){return this.request("GET",t,null,e||{})})}del(t,e){return vt(this,void 0,void 0,function*(){return this.request("DELETE",t,null,e||{})})}post(t,e,r){return vt(this,void 0,void 0,function*(){return this.request("POST",t,e,r||{})})}patch(t,e,r){return vt(this,void 0,void 0,function*(){return this.request("PATCH",t,e,r||{})})}put(t,e,r){return vt(this,void 0,void 0,function*(){return this.request("PUT",t,e,r||{})})}head(t,e){return vt(this,void 0,void 0,function*(){return this.request("HEAD",t,null,e||{})})}sendStream(t,e,r,i){return vt(this,void 0,void 0,function*(){return this.request(t,e,r,i)})}getJson(t,e={}){return vt(this,void 0,void 0,function*(){e[qt.Accept]=this._getExistingOrDefaultHeader(e,qt.Accept,Fn.ApplicationJson);let r=yield this.get(t,e);return this._processResponse(r,this.requestOptions)})}postJson(t,e,r={}){return vt(this,void 0,void 0,function*(){let i=JSON.stringify(e,null,2);r[qt.Accept]=this._getExistingOrDefaultHeader(r,qt.Accept,Fn.ApplicationJson),r[qt.ContentType]=this._getExistingOrDefaultHeader(r,qt.ContentType,Fn.ApplicationJson);let s=yield this.post(t,i,r);return this._processResponse(s,this.requestOptions)})}putJson(t,e,r={}){return vt(this,void 0,void 0,function*(){let i=JSON.stringify(e,null,2);r[qt.Accept]=this._getExistingOrDefaultHeader(r,qt.Accept,Fn.ApplicationJson),r[qt.ContentType]=this._getExistingOrDefaultHeader(r,qt.ContentType,Fn.ApplicationJson);let s=yield this.put(t,i,r);return this._processResponse(s,this.requestOptions)})}patchJson(t,e,r={}){return vt(this,void 0,void 0,function*(){let i=JSON.stringify(e,null,2);r[qt.Accept]=this._getExistingOrDefaultHeader(r,qt.Accept,Fn.ApplicationJson),r[qt.ContentType]=this._getExistingOrDefaultHeader(r,qt.ContentType,Fn.ApplicationJson);let s=yield this.patch(t,i,r);return this._processResponse(s,this.requestOptions)})}request(t,e,r,i){return vt(this,void 0,void 0,function*(){if(this._disposed)throw new Error("Client has already been disposed.");let s=new URL(e),o=this._prepareRequest(t,s,i),f=this._allowRetries&&_0.includes(t)?this._maxRetries+1:1,a=0,u;do{if(u=yield this.requestRaw(o,r),u&&u.message&&u.message.statusCode===dn.Unauthorized){let l;for(let A of this.handlers)if(A.canHandleAuthentication(u)){l=A;break}return l?l.handleAuthentication(this,o,r):u}let h=this._maxRedirects;for(;u.message.statusCode&&d0.includes(u.message.statusCode)&&this._allowRedirects&&h>0;){let l=u.message.headers.location;if(!l)break;let A=new URL(l);if(s.protocol==="https:"&&s.protocol!==A.protocol&&!this._allowRedirectDowngrade)throw new Error("Redirect from HTTPS to HTTP protocol. This downgrade is not allowed for security reasons. If you want to allow this behavior, set the allowRedirectDowngrade option to true.");if(yield u.readBody(),A.hostname!==s.hostname)for(let p in i)p.toLowerCase()==="authorization"&&delete i[p];o=this._prepareRequest(t,A,i),u=yield this.requestRaw(o,r),h--}if(!u.message.statusCode||!A0.includes(u.message.statusCode))return u;a+=1,a<f&&(yield u.readBody(),yield this._performExponentialBackoff(a))}while(a<f);return u})}dispose(){this._agent&&this._agent.destroy(),this._disposed=!0}requestRaw(t,e){return vt(this,void 0,void 0,function*(){return new Promise((r,i)=>{function s(o,f){o?i(o):f?r(f):i(new Error("Unknown error"))}this.requestRawWithCallback(t,e,s)})})}requestRawWithCallback(t,e,r){typeof e=="string"&&(t.options.headers||(t.options.headers={}),t.options.headers["Content-Length"]=Buffer.byteLength(e,"utf8"));let i=!1;function s(a,u){i||(i=!0,r(a,u))}let o=t.httpModule.request(t.options,a=>{let u=new Ji(a);s(void 0,u)}),f;o.on("socket",a=>{f=a}),o.setTimeout(this._socketTimeout||3*6e4,()=>{f&&f.end(),s(new Error(`Request timeout: ${t.options.path}`))}),o.on("error",function(a){s(a)}),e&&typeof e=="string"&&o.write(e,"utf8"),e&&typeof e!="string"?(e.on("close",function(){o.end()}),e.pipe(o)):o.end()}getAgent(t){let e=new URL(t);return this._getAgent(e)}_prepareRequest(t,e,r){let i={};i.parsedUrl=e;let s=i.parsedUrl.protocol==="https:";i.httpModule=s?ho:Xi;let o=s?443:80;if(i.options={},i.options.host=i.parsedUrl.hostname,i.options.port=i.parsedUrl.port?parseInt(i.parsedUrl.port):o,i.options.path=(i.parsedUrl.pathname||"")+(i.parsedUrl.search||""),i.options.method=t,i.options.headers=this._mergeHeaders(r),this.userAgent!=null&&(i.options.headers["user-agent"]=this.userAgent),i.options.agent=this._getAgent(i.parsedUrl),this.handlers)for(let f of this.handlers)f.prepareRequest(i.options);return i}_mergeHeaders(t){return this.requestOptions&&this.requestOptions.headers?Object.assign({},zi(this.requestOptions.headers),zi(t||{})):zi(t||{})}_getExistingOrDefaultHeader(t,e,r){let i;return this.requestOptions&&this.requestOptions.headers&&(i=zi(this.requestOptions.headers)[e]),t[e]||i||r}_getAgent(t){let e,r=lc.getProxyUrl(t),i=r&&r.hostname;if(this._keepAlive&&i&&(e=this._proxyAgent),this._keepAlive&&!i&&(e=this._agent),e)return e;let s=t.protocol==="https:",o=100;if(this.requestOptions&&(o=this.requestOptions.maxSockets||Xi.globalAgent.maxSockets),r&&r.hostname){let f={maxSockets:o,keepAlive:this._keepAlive,proxy:Object.assign(Object.assign({},(r.username||r.password)&&{proxyAuth:`${r.username}:${r.password}`}),{host:r.hostname,port:r.port})},a,u=r.protocol==="https:";s?a=u?Vi.httpsOverHttps:Vi.httpsOverHttp:a=u?Vi.httpOverHttps:Vi.httpOverHttp,e=a(f),this._proxyAgent=e}if(this._keepAlive&&!e){let f={keepAlive:this._keepAlive,maxSockets:o};e=s?new ho.Agent(f):new Xi.Agent(f),this._agent=e}return e||(e=s?ho.globalAgent:Xi.globalAgent),s&&this._ignoreSslError&&(e.options=Object.assign(e.options||{},{rejectUnauthorized:!1})),e}_performExponentialBackoff(t){return vt(this,void 0,void 0,function*(){t=Math.min(g0,t);let e=E0*Math.pow(2,t);return new Promise(r=>setTimeout(()=>r(),e))})}_processResponse(t,e){return vt(this,void 0,void 0,function*(){return new Promise((r,i)=>vt(this,void 0,void 0,function*(){let s=t.message.statusCode||0,o={statusCode:s,result:null,headers:{}};s===dn.NotFound&&r(o);function f(h,l){if(typeof l=="string"){let A=new Date(l);if(!isNaN(A.valueOf()))return A}return l}let a,u;try{u=yield t.readBody(),u&&u.length>0&&(e&&e.deserializeDates?a=JSON.parse(u,f):a=JSON.parse(u),o.result=a),o.headers=t.message.headers}catch{}if(s>299){let h;a&&a.message?h=a.message:u&&u.length>0?h=u:h=`Failed request: (${s})`;let l=new wr(h,s);l.result=o.result,i(l)}else r(o)}))})}};ut.HttpClient=Ao;var zi=n=>Object.keys(n).reduce((t,e)=>(t[e.toLowerCase()]=n[e],t),{})});var dc=_e(In=>{"use strict";var po=In&&In.__awaiter||function(n,t,e,r){function i(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function f(h){try{u(r.next(h))}catch(l){o(l)}}function a(h){try{u(r.throw(h))}catch(l){o(l)}}function u(h){h.done?s(h.value):i(h.value).then(f,a)}u((r=r.apply(n,t||[])).next())})};Object.defineProperty(In,"__esModule",{value:!0});In.PersonalAccessTokenCredentialHandler=In.BearerCredentialHandler=In.BasicCredentialHandler=void 0;var _o=class{constructor(t,e){this.username=t,this.password=e}prepareRequest(t){if(!t.headers)throw Error("The request has no headers");t.headers.Authorization=`Basic ${Buffer.from(`${this.username}:${this.password}`).toString("base64")}`}canHandleAuthentication(){return!1}handleAuthentication(){return po(this,void 0,void 0,function*(){throw new Error("not implemented")})}};In.BasicCredentialHandler=_o;var go=class{constructor(t){this.token=t}prepareRequest(t){if(!t.headers)throw Error("The request has no headers");t.headers.Authorization=`Bearer ${this.token}`}canHandleAuthentication(){return!1}handleAuthentication(){return po(this,void 0,void 0,function*(){throw new Error("not implemented")})}};In.BearerCredentialHandler=go;var Eo=class{constructor(t){this.token=t}prepareRequest(t){if(!t.headers)throw Error("The request has no headers");t.headers.Authorization=`Basic ${Buffer.from(`PAT:${this.token}`).toString("base64")}`}canHandleAuthentication(){return!1}handleAuthentication(){return po(this,void 0,void 0,function*(){throw new Error("not implemented")})}};In.PersonalAccessTokenCredentialHandler=Eo});var gc=_e(Sr=>{"use strict";var Ac=Sr&&Sr.__awaiter||function(n,t,e,r){function i(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function f(h){try{u(r.next(h))}catch(l){o(l)}}function a(h){try{u(r.throw(h))}catch(l){o(l)}}function u(h){h.done?s(h.value):i(h.value).then(f,a)}u((r=r.apply(n,t||[])).next())})};Object.defineProperty(Sr,"__esModule",{value:!0});Sr.OidcClient=void 0;var b0=hc(),I0=dc(),_c=bo(),qn=class{static createHttpClient(t=!0,e=10){let r={allowRetries:t,maxRetries:e};return new b0.HttpClient("actions/oidc-client",[new I0.BearerCredentialHandler(qn.getRequestToken())],r)}static getRequestToken(){let t=process.env.ACTIONS_ID_TOKEN_REQUEST_TOKEN;if(!t)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_TOKEN env variable");return t}static getIDTokenUrl(){let t=process.env.ACTIONS_ID_TOKEN_REQUEST_URL;if(!t)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_URL env variable");return t}static getCall(t){var e;return Ac(this,void 0,void 0,function*(){let s=(e=(yield qn.createHttpClient().getJson(t).catch(o=>{throw new Error(`Failed to get ID Token. 
 
        Error Code : ${o.statusCode}
 
        Error Message: ${o.result.message}`)})).result)===null||e===void 0?void 0:e.value;if(!s)throw new Error("Response json body do not have ID Token field");return s})}static getIDToken(t){return Ac(this,void 0,void 0,function*(){try{let e=qn.getIDTokenUrl();if(t){let i=encodeURIComponent(t);e=`${e}&audience=${i}`}_c.debug(`ID token url is ${e}`);let r=yield qn.getCall(e);return _c.setSecret(r),r}catch(e){throw new Error(`Error message: ${e.message}`)}})}};Sr.OidcClient=qn});var wo=_e(Gt=>{"use strict";var Io=Gt&&Gt.__awaiter||function(n,t,e,r){function i(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function f(h){try{u(r.next(h))}catch(l){o(l)}}function a(h){try{u(r.throw(h))}catch(l){o(l)}}function u(h){h.done?s(h.value):i(h.value).then(f,a)}u((r=r.apply(n,t||[])).next())})};Object.defineProperty(Gt,"__esModule",{value:!0});Gt.summary=Gt.markdownSummary=Gt.SUMMARY_DOCS_URL=Gt.SUMMARY_ENV_VAR=void 0;var y0=require("os"),yo=require("fs"),{access:x0,appendFile:w0,writeFile:S0}=yo.promises;Gt.SUMMARY_ENV_VAR="GITHUB_STEP_SUMMARY";Gt.SUMMARY_DOCS_URL="https://docs.github.com/actions/using-workflows/workflow-commands-for-github-actions#adding-a-job-summary";var xo=class{constructor(){this._buffer=""}filePath(){return Io(this,void 0,void 0,function*(){if(this._filePath)return this._filePath;let t=process.env[Gt.SUMMARY_ENV_VAR];if(!t)throw new Error(`Unable to find environment variable for $${Gt.SUMMARY_ENV_VAR}. Check if your runtime environment supports job summaries.`);try{yield x0(t,yo.constants.R_OK|yo.constants.W_OK)}catch{throw new Error(`Unable to access summary file: '${t}'. Check if the file has correct read/write permissions.`)}return this._filePath=t,this._filePath})}wrap(t,e,r={}){let i=Object.entries(r).map(([s,o])=>` ${s}="${o}"`).join("");return e?`<${t}${i}>${e}</${t}>`:`<${t}${i}>`}write(t){return Io(this,void 0,void 0,function*(){let e=!!t?.overwrite,r=yield this.filePath();return yield(e?S0:w0)(r,this._buffer,{encoding:"utf8"}),this.emptyBuffer()})}clear(){return Io(this,void 0,void 0,function*(){return this.emptyBuffer().write({overwrite:!0})})}stringify(){return this._buffer}isEmptyBuffer(){return this._buffer.length===0}emptyBuffer(){return this._buffer="",this}addRaw(t,e=!1){return this._buffer+=t,e?this.addEOL():this}addEOL(){return this.addRaw(y0.EOL)}addCodeBlock(t,e){let r=Object.assign({},e&&{lang:e}),i=this.wrap("pre",this.wrap("code",t),r);return this.addRaw(i).addEOL()}addList(t,e=!1){let r=e?"ol":"ul",i=t.map(o=>this.wrap("li",o)).join(""),s=this.wrap(r,i);return this.addRaw(s).addEOL()}addTable(t){let e=t.map(i=>{let s=i.map(o=>{if(typeof o=="string")return this.wrap("td",o);let{header:f,data:a,colspan:u,rowspan:h}=o,l=f?"th":"td",A=Object.assign(Object.assign({},u&&{colspan:u}),h&&{rowspan:h});return this.wrap(l,a,A)}).join("");return this.wrap("tr",s)}).join(""),r=this.wrap("table",e);return this.addRaw(r).addEOL()}addDetails(t,e){let r=this.wrap("details",this.wrap("summary",t)+e);return this.addRaw(r).addEOL()}addImage(t,e,r){let{width:i,height:s}=r||{},o=Object.assign(Object.assign({},i&&{width:i}),s&&{height:s}),f=this.wrap("img",null,Object.assign({src:t,alt:e},o));return this.addRaw(f).addEOL()}addHeading(t,e){let r=`h${e}`,i=["h1","h2","h3","h4","h5","h6"].includes(r)?r:"h1",s=this.wrap(i,t);return this.addRaw(s).addEOL()}addSeparator(){let t=this.wrap("hr",null);return this.addRaw(t).addEOL()}addBreak(){let t=this.wrap("br",null);return this.addRaw(t).addEOL()}addQuote(t,e){let r=Object.assign({},e&&{cite:e}),i=this.wrap("blockquote",t,r);return this.addRaw(i).addEOL()}addLink(t,e){let r=this.wrap("a",t,{href:e});return this.addRaw(r).addEOL()}},Ec=new xo;Gt.markdownSummary=Ec;Gt.summary=Ec});var pc=_e($t=>{"use strict";var m0=$t&&$t.__createBinding||(Object.create?function(n,t,e,r){r===void 0&&(r=e),Object.defineProperty(n,r,{enumerable:!0,get:function(){return t[e]}})}:function(n,t,e,r){r===void 0&&(r=e),n[r]=t[e]}),C0=$t&&$t.__setModuleDefault||(Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t}),R0=$t&&$t.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var e in n)e!=="default"&&Object.hasOwnProperty.call(n,e)&&m0(t,n,e);return C0(t,n),t};Object.defineProperty($t,"__esModule",{value:!0});$t.toPlatformPath=$t.toWin32Path=$t.toPosixPath=void 0;var B0=R0(require("path"));function v0(n){return n.replace(/[\\]/g,"/")}$t.toPosixPath=v0;function N0(n){return n.replace(/[/]/g,"\\")}$t.toWin32Path=N0;function k0(n){return n.replace(/[/\\]/g,B0.sep)}$t.toPlatformPath=k0});var bo=_e(ge=>{"use strict";var T0=ge&&ge.__createBinding||(Object.create?function(n,t,e,r){r===void 0&&(r=e),Object.defineProperty(n,r,{enumerable:!0,get:function(){return t[e]}})}:function(n,t,e,r){r===void 0&&(r=e),n[r]=t[e]}),O0=ge&&ge.__setModuleDefault||(Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t}),bc=ge&&ge.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var e in n)e!=="default"&&Object.hasOwnProperty.call(n,e)&&T0(t,n,e);return O0(t,n),t},Ic=ge&&ge.__awaiter||function(n,t,e,r){function i(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function f(h){try{u(r.next(h))}catch(l){o(l)}}function a(h){try{u(r.throw(h))}catch(l){o(l)}}function u(h){h.done?s(h.value):i(h.value).then(f,a)}u((r=r.apply(n,t||[])).next())})};Object.defineProperty(ge,"__esModule",{value:!0});ge.getIDToken=ge.getState=ge.saveState=ge.group=ge.endGroup=ge.startGroup=ge.info=ge.notice=ge.warning=ge.error=ge.debug=ge.isDebug=ge.setFailed=ge.setCommandEcho=ge.setOutput=ge.getBooleanInput=ge.getMultilineInput=ge.getInput=ge.addPath=ge.setSecret=ge.exportVariable=ge.ExitCode=void 0;var sn=Pa(),yc=Qa(),ts=Li(),es=bc(require("os")),L0=bc(require("path")),P0=nc(),U0=gc(),xc;(function(n){n[n.Success=0]="Success",n[n.Failure=1]="Failure"})(xc=ge.ExitCode||(ge.ExitCode={}));function D0(n,t){let e=ts.toCommandValue(t);if(process.env[n]=e,process.env.GITHUB_ENV||""){let i=`ghadelimiter_${P0.v4()}`;if(n.includes(i))throw new Error(`Unexpected input: name should not contain the delimiter "${i}"`);if(e.includes(i))throw new Error(`Unexpected input: value should not contain the delimiter "${i}"`);let s=`${n}<<${i}${es.EOL}${e}${es.EOL}${i}`;yc.issueCommand("ENV",s)}else sn.issueCommand("set-env",{name:n},e)}ge.exportVariable=D0;function Q0(n){sn.issueCommand("add-mask",{},n)}ge.setSecret=Q0;function H0(n){process.env.GITHUB_PATH||""?yc.issueCommand("PATH",n):sn.issueCommand("add-path",{},n),process.env.PATH=`${n}${L0.delimiter}${process.env.PATH}`}ge.addPath=H0;function So(n,t){let e=process.env[`INPUT_${n.replace(/ /g,"_").toUpperCase()}`]||"";if(t&&t.required&&!e)throw new Error(`Input required and not supplied: ${n}`);return t&&t.trimWhitespace===!1?e:e.trim()}ge.getInput=So;function F0(n,t){return So(n,t).split(`
`).filter(r=>r!=="")}ge.getMultilineInput=F0;function q0(n,t){let e=["true","True","TRUE"],r=["false","False","FALSE"],i=So(n,t);if(e.includes(i))return!0;if(r.includes(i))return!1;throw new TypeError(`Input does not meet YAML 1.2 "Core Schema" specification: ${n}
Support boolean input list: \`true | True | TRUE | false | False | FALSE\``)}ge.getBooleanInput=q0;function M0(n,t){process.stdout.write(es.EOL),sn.issueCommand("set-output",{name:n},t)}ge.setOutput=M0;function K0(n){sn.issue("echo",n?"on":"off")}ge.setCommandEcho=K0;function W0(n){process.exitCode=xc.Failure,wc(n)}ge.setFailed=W0;function G0(){return process.env.RUNNER_DEBUG==="1"}ge.isDebug=G0;function $0(n){sn.issueCommand("debug",{},n)}ge.debug=$0;function wc(n,t={}){sn.issueCommand("error",ts.toCommandProperties(t),n instanceof Error?n.toString():n)}ge.error=wc;function Y0(n,t={}){sn.issueCommand("warning",ts.toCommandProperties(t),n instanceof Error?n.toString():n)}ge.warning=Y0;function j0(n,t={}){sn.issueCommand("notice",ts.toCommandProperties(t),n instanceof Error?n.toString():n)}ge.notice=j0;function X0(n){process.stdout.write(n+es.EOL)}ge.info=X0;function Sc(n){sn.issue("group",n)}ge.startGroup=Sc;function mc(){sn.issue("endgroup")}ge.endGroup=mc;function V0(n,t){return Ic(this,void 0,void 0,function*(){Sc(n);let e;try{e=yield t()}finally{mc()}return e})}ge.group=V0;function z0(n,t){sn.issueCommand("save-state",{name:n},t)}ge.saveState=z0;function J0(n){return process.env[`STATE_${n}`]||""}ge.getState=J0;function Z0(n){return Ic(this,void 0,void 0,function*(){return yield U0.OidcClient.getIDToken(n)})}ge.getIDToken=Z0;var eA=wo();Object.defineProperty(ge,"summary",{enumerable:!0,get:function(){return eA.summary}});var tA=wo();Object.defineProperty(ge,"markdownSummary",{enumerable:!0,get:function(){return tA.markdownSummary}});var mo=pc();Object.defineProperty(ge,"toPosixPath",{enumerable:!0,get:function(){return mo.toPosixPath}});Object.defineProperty(ge,"toWin32Path",{enumerable:!0,get:function(){return mo.toWin32Path}});Object.defineProperty(ge,"toPlatformPath",{enumerable:!0,get:function(){return mo.toPlatformPath}})});var kc=_e((Pe,Nc)=>{Pe=Nc.exports=We;var at;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?at=function(){var n=Array.prototype.slice.call(arguments,0);n.unshift("SEMVER"),console.log.apply(console,n)}:at=function(){};Pe.SEMVER_SPEC_VERSION="2.0.0";var Ro=256,ns=Number.MAX_SAFE_INTEGER||9007199254740991,Co=16,ft=Pe.re=[],V=Pe.src=[],U=Pe.tokens={},Bc=0;function je(n){U[n]=Bc++}je("NUMERICIDENTIFIER");V[U.NUMERICIDENTIFIER]="0|[1-9]\\d*";je("NUMERICIDENTIFIERLOOSE");V[U.NUMERICIDENTIFIERLOOSE]="[0-9]+";je("NONNUMERICIDENTIFIER");V[U.NONNUMERICIDENTIFIER]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";je("MAINVERSION");V[U.MAINVERSION]="("+V[U.NUMERICIDENTIFIER]+")\\.("+V[U.NUMERICIDENTIFIER]+")\\.("+V[U.NUMERICIDENTIFIER]+")";je("MAINVERSIONLOOSE");V[U.MAINVERSIONLOOSE]="("+V[U.NUMERICIDENTIFIERLOOSE]+")\\.("+V[U.NUMERICIDENTIFIERLOOSE]+")\\.("+V[U.NUMERICIDENTIFIERLOOSE]+")";je("PRERELEASEIDENTIFIER");V[U.PRERELEASEIDENTIFIER]="(?:"+V[U.NUMERICIDENTIFIER]+"|"+V[U.NONNUMERICIDENTIFIER]+")";je("PRERELEASEIDENTIFIERLOOSE");V[U.PRERELEASEIDENTIFIERLOOSE]="(?:"+V[U.NUMERICIDENTIFIERLOOSE]+"|"+V[U.NONNUMERICIDENTIFIER]+")";je("PRERELEASE");V[U.PRERELEASE]="(?:-("+V[U.PRERELEASEIDENTIFIER]+"(?:\\."+V[U.PRERELEASEIDENTIFIER]+")*))";je("PRERELEASELOOSE");V[U.PRERELEASELOOSE]="(?:-?("+V[U.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+V[U.PRERELEASEIDENTIFIERLOOSE]+")*))";je("BUILDIDENTIFIER");V[U.BUILDIDENTIFIER]="[0-9A-Za-z-]+";je("BUILD");V[U.BUILD]="(?:\\+("+V[U.BUILDIDENTIFIER]+"(?:\\."+V[U.BUILDIDENTIFIER]+")*))";je("FULL");je("FULLPLAIN");V[U.FULLPLAIN]="v?"+V[U.MAINVERSION]+V[U.PRERELEASE]+"?"+V[U.BUILD]+"?";V[U.FULL]="^"+V[U.FULLPLAIN]+"$";je("LOOSEPLAIN");V[U.LOOSEPLAIN]="[v=\\s]*"+V[U.MAINVERSIONLOOSE]+V[U.PRERELEASELOOSE]+"?"+V[U.BUILD]+"?";je("LOOSE");V[U.LOOSE]="^"+V[U.LOOSEPLAIN]+"$";je("GTLT");V[U.GTLT]="((?:<|>)?=?)";je("XRANGEIDENTIFIERLOOSE");V[U.XRANGEIDENTIFIERLOOSE]=V[U.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*";je("XRANGEIDENTIFIER");V[U.XRANGEIDENTIFIER]=V[U.NUMERICIDENTIFIER]+"|x|X|\\*";je("XRANGEPLAIN");V[U.XRANGEPLAIN]="[v=\\s]*("+V[U.XRANGEIDENTIFIER]+")(?:\\.("+V[U.XRANGEIDENTIFIER]+")(?:\\.("+V[U.XRANGEIDENTIFIER]+")(?:"+V[U.PRERELEASE]+")?"+V[U.BUILD]+"?)?)?";je("XRANGEPLAINLOOSE");V[U.XRANGEPLAINLOOSE]="[v=\\s]*("+V[U.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+V[U.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+V[U.XRANGEIDENTIFIERLOOSE]+")(?:"+V[U.PRERELEASELOOSE]+")?"+V[U.BUILD]+"?)?)?";je("XRANGE");V[U.XRANGE]="^"+V[U.GTLT]+"\\s*"+V[U.XRANGEPLAIN]+"$";je("XRANGELOOSE");V[U.XRANGELOOSE]="^"+V[U.GTLT]+"\\s*"+V[U.XRANGEPLAINLOOSE]+"$";je("COERCE");V[U.COERCE]="(^|[^\\d])(\\d{1,"+Co+"})(?:\\.(\\d{1,"+Co+"}))?(?:\\.(\\d{1,"+Co+"}))?(?:$|[^\\d])";je("COERCERTL");ft[U.COERCERTL]=new RegExp(V[U.COERCE],"g");je("LONETILDE");V[U.LONETILDE]="(?:~>?)";je("TILDETRIM");V[U.TILDETRIM]="(\\s*)"+V[U.LONETILDE]+"\\s+";ft[U.TILDETRIM]=new RegExp(V[U.TILDETRIM],"g");var nA="$1~";je("TILDE");V[U.TILDE]="^"+V[U.LONETILDE]+V[U.XRANGEPLAIN]+"$";je("TILDELOOSE");V[U.TILDELOOSE]="^"+V[U.LONETILDE]+V[U.XRANGEPLAINLOOSE]+"$";je("LONECARET");V[U.LONECARET]="(?:\\^)";je("CARETTRIM");V[U.CARETTRIM]="(\\s*)"+V[U.LONECARET]+"\\s+";ft[U.CARETTRIM]=new RegExp(V[U.CARETTRIM],"g");var rA="$1^";je("CARET");V[U.CARET]="^"+V[U.LONECARET]+V[U.XRANGEPLAIN]+"$";je("CARETLOOSE");V[U.CARETLOOSE]="^"+V[U.LONECARET]+V[U.XRANGEPLAINLOOSE]+"$";je("COMPARATORLOOSE");V[U.COMPARATORLOOSE]="^"+V[U.GTLT]+"\\s*("+V[U.LOOSEPLAIN]+")$|^$";je("COMPARATOR");V[U.COMPARATOR]="^"+V[U.GTLT]+"\\s*("+V[U.FULLPLAIN]+")$|^$";je("COMPARATORTRIM");V[U.COMPARATORTRIM]="(\\s*)"+V[U.GTLT]+"\\s*("+V[U.LOOSEPLAIN]+"|"+V[U.XRANGEPLAIN]+")";ft[U.COMPARATORTRIM]=new RegExp(V[U.COMPARATORTRIM],"g");var iA="$1$2$3";je("HYPHENRANGE");V[U.HYPHENRANGE]="^\\s*("+V[U.XRANGEPLAIN]+")\\s+-\\s+("+V[U.XRANGEPLAIN]+")\\s*$";je("HYPHENRANGELOOSE");V[U.HYPHENRANGELOOSE]="^\\s*("+V[U.XRANGEPLAINLOOSE]+")\\s+-\\s+("+V[U.XRANGEPLAINLOOSE]+")\\s*$";je("STAR");V[U.STAR]="(<|>)?=?\\s*\\*";for(Mn=0;Mn<Bc;Mn++)at(Mn,V[Mn]),ft[Mn]||(ft[Mn]=new RegExp(V[Mn]));var Mn;Pe.parse=ir;function ir(n,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),n instanceof We)return n;if(typeof n!="string"||n.length>Ro)return null;var e=t.loose?ft[U.LOOSE]:ft[U.FULL];if(!e.test(n))return null;try{return new We(n,t)}catch{return null}}Pe.valid=sA;function sA(n,t){var e=ir(n,t);return e?e.version:null}Pe.clean=oA;function oA(n,t){var e=ir(n.trim().replace(/^[=v]+/,""),t);return e?e.version:null}Pe.SemVer=We;function We(n,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),n instanceof We){if(n.loose===t.loose)return n;n=n.version}else if(typeof n!="string")throw new TypeError("Invalid Version: "+n);if(n.length>Ro)throw new TypeError("version is longer than "+Ro+" characters");if(!(this instanceof We))return new We(n,t);at("SemVer",n,t),this.options=t,this.loose=!!t.loose;var e=n.trim().match(t.loose?ft[U.LOOSE]:ft[U.FULL]);if(!e)throw new TypeError("Invalid Version: "+n);if(this.raw=n,this.major=+e[1],this.minor=+e[2],this.patch=+e[3],this.major>ns||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ns||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ns||this.patch<0)throw new TypeError("Invalid patch version");e[4]?this.prerelease=e[4].split(".").map(function(r){if(/^[0-9]+$/.test(r)){var i=+r;if(i>=0&&i<ns)return i}return r}):this.prerelease=[],this.build=e[5]?e[5].split("."):[],this.format()}We.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};We.prototype.toString=function(){return this.version};We.prototype.compare=function(n){return at("SemVer.compare",this.version,this.options,n),n instanceof We||(n=new We(n,this.options)),this.compareMain(n)||this.comparePre(n)};We.prototype.compareMain=function(n){return n instanceof We||(n=new We(n,this.options)),rr(this.major,n.major)||rr(this.minor,n.minor)||rr(this.patch,n.patch)};We.prototype.comparePre=function(n){if(n instanceof We||(n=new We(n,this.options)),this.prerelease.length&&!n.prerelease.length)return-1;if(!this.prerelease.length&&n.prerelease.length)return 1;if(!this.prerelease.length&&!n.prerelease.length)return 0;var t=0;do{var e=this.prerelease[t],r=n.prerelease[t];if(at("prerelease compare",t,e,r),e===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(e===void 0)return-1;if(e===r)continue;return rr(e,r)}while(++t)};We.prototype.compareBuild=function(n){n instanceof We||(n=new We(n,this.options));var t=0;do{var e=this.build[t],r=n.build[t];if(at("prerelease compare",t,e,r),e===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(e===void 0)return-1;if(e===r)continue;return rr(e,r)}while(++t)};We.prototype.inc=function(n,t){switch(n){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t),this.inc("pre",t);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var e=this.prerelease.length;--e>=0;)typeof this.prerelease[e]=="number"&&(this.prerelease[e]++,e=-2);e===-1&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+n)}return this.format(),this.raw=this.version,this};Pe.inc=fA;function fA(n,t,e,r){typeof e=="string"&&(r=e,e=void 0);try{return new We(n,e).inc(t,r).version}catch{return null}}Pe.diff=aA;function aA(n,t){if(Bo(n,t))return null;var e=ir(n),r=ir(t),i="";if(e.prerelease.length||r.prerelease.length){i="pre";var s="prerelease"}for(var o in e)if((o==="major"||o==="minor"||o==="patch")&&e[o]!==r[o])return i+o;return s}Pe.compareIdentifiers=rr;var Cc=/^[0-9]+$/;function rr(n,t){var e=Cc.test(n),r=Cc.test(t);return e&&r&&(n=+n,t=+t),n===t?0:e&&!r?-1:r&&!e?1:n<t?-1:1}Pe.rcompareIdentifiers=cA;function cA(n,t){return rr(t,n)}Pe.major=uA;function uA(n,t){return new We(n,t).major}Pe.minor=lA;function lA(n,t){return new We(n,t).minor}Pe.patch=hA;function hA(n,t){return new We(n,t).patch}Pe.compare=Nn;function Nn(n,t,e){return new We(n,e).compare(new We(t,e))}Pe.compareLoose=dA;function dA(n,t){return Nn(n,t,!0)}Pe.compareBuild=AA;function AA(n,t,e){var r=new We(n,e),i=new We(t,e);return r.compare(i)||r.compareBuild(i)}Pe.rcompare=_A;function _A(n,t,e){return Nn(t,n,e)}Pe.sort=gA;function gA(n,t){return n.sort(function(e,r){return Pe.compareBuild(e,r,t)})}Pe.rsort=EA;function EA(n,t){return n.sort(function(e,r){return Pe.compareBuild(r,e,t)})}Pe.gt=ti;function ti(n,t,e){return Nn(n,t,e)>0}Pe.lt=rs;function rs(n,t,e){return Nn(n,t,e)<0}Pe.eq=Bo;function Bo(n,t,e){return Nn(n,t,e)===0}Pe.neq=vc;function vc(n,t,e){return Nn(n,t,e)!==0}Pe.gte=vo;function vo(n,t,e){return Nn(n,t,e)>=0}Pe.lte=No;function No(n,t,e){return Nn(n,t,e)<=0}Pe.cmp=is;function is(n,t,e,r){switch(t){case"===":return typeof n=="object"&&(n=n.version),typeof e=="object"&&(e=e.version),n===e;case"!==":return typeof n=="object"&&(n=n.version),typeof e=="object"&&(e=e.version),n!==e;case"":case"=":case"==":return Bo(n,e,r);case"!=":return vc(n,e,r);case">":return ti(n,e,r);case">=":return vo(n,e,r);case"<":return rs(n,e,r);case"<=":return No(n,e,r);default:throw new TypeError("Invalid operator: "+t)}}Pe.Comparator=on;function on(n,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),n instanceof on){if(n.loose===!!t.loose)return n;n=n.value}if(!(this instanceof on))return new on(n,t);at("comparator",n,t),this.options=t,this.loose=!!t.loose,this.parse(n),this.semver===mr?this.value="":this.value=this.operator+this.semver.version,at("comp",this)}var mr={};on.prototype.parse=function(n){var t=this.options.loose?ft[U.COMPARATORLOOSE]:ft[U.COMPARATOR],e=n.match(t);if(!e)throw new TypeError("Invalid comparator: "+n);this.operator=e[1]!==void 0?e[1]:"",this.operator==="="&&(this.operator=""),e[2]?this.semver=new We(e[2],this.options.loose):this.semver=mr};on.prototype.toString=function(){return this.value};on.prototype.test=function(n){if(at("Comparator.test",n,this.options.loose),this.semver===mr||n===mr)return!0;if(typeof n=="string")try{n=new We(n,this.options)}catch{return!1}return is(n,this.operator,this.semver,this.options)};on.prototype.intersects=function(n,t){if(!(n instanceof on))throw new TypeError("a Comparator is required");(!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1});var e;if(this.operator==="")return this.value===""?!0:(e=new gt(n.value,t),ss(this.value,e,t));if(n.operator==="")return n.value===""?!0:(e=new gt(this.value,t),ss(n.semver,e,t));var r=(this.operator===">="||this.operator===">")&&(n.operator===">="||n.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(n.operator==="<="||n.operator==="<"),s=this.semver.version===n.semver.version,o=(this.operator===">="||this.operator==="<=")&&(n.operator===">="||n.operator==="<="),f=is(this.semver,"<",n.semver,t)&&(this.operator===">="||this.operator===">")&&(n.operator==="<="||n.operator==="<"),a=is(this.semver,">",n.semver,t)&&(this.operator==="<="||this.operator==="<")&&(n.operator===">="||n.operator===">");return r||i||s&&o||f||a};Pe.Range=gt;function gt(n,t){if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),n instanceof gt)return n.loose===!!t.loose&&n.includePrerelease===!!t.includePrerelease?n:new gt(n.raw,t);if(n instanceof on)return new gt(n.value,t);if(!(this instanceof gt))return new gt(n,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=n,this.set=n.split(/\s*\|\|\s*/).map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+n);this.format()}gt.prototype.format=function(){return this.range=this.set.map(function(n){return n.join(" ").trim()}).join("||").trim(),this.range};gt.prototype.toString=function(){return this.range};gt.prototype.parseRange=function(n){var t=this.options.loose;n=n.trim();var e=t?ft[U.HYPHENRANGELOOSE]:ft[U.HYPHENRANGE];n=n.replace(e,RA),at("hyphen replace",n),n=n.replace(ft[U.COMPARATORTRIM],iA),at("comparator trim",n,ft[U.COMPARATORTRIM]),n=n.replace(ft[U.TILDETRIM],nA),n=n.replace(ft[U.CARETTRIM],rA),n=n.split(/\s+/).join(" ");var r=t?ft[U.COMPARATORLOOSE]:ft[U.COMPARATOR],i=n.split(" ").map(function(s){return bA(s,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(s){return!!s.match(r)})),i=i.map(function(s){return new on(s,this.options)},this),i};gt.prototype.intersects=function(n,t){if(!(n instanceof gt))throw new TypeError("a Range is required");return this.set.some(function(e){return Rc(e,t)&&n.set.some(function(r){return Rc(r,t)&&e.every(function(i){return r.every(function(s){return i.intersects(s,t)})})})})};function Rc(n,t){for(var e=!0,r=n.slice(),i=r.pop();e&&r.length;)e=r.every(function(s){return i.intersects(s,t)}),i=r.pop();return e}Pe.toComparators=pA;function pA(n,t){return new gt(n,t).set.map(function(e){return e.map(function(r){return r.value}).join(" ").trim().split(" ")})}function bA(n,t){return at("comp",n,t),n=xA(n,t),at("caret",n),n=IA(n,t),at("tildes",n),n=SA(n,t),at("xrange",n),n=CA(n,t),at("stars",n),n}function Mt(n){return!n||n.toLowerCase()==="x"||n==="*"}function IA(n,t){return n.trim().split(/\s+/).map(function(e){return yA(e,t)}).join(" ")}function yA(n,t){var e=t.loose?ft[U.TILDELOOSE]:ft[U.TILDE];return n.replace(e,function(r,i,s,o,f){at("tilde",n,r,i,s,o,f);var a;return Mt(i)?a="":Mt(s)?a=">="+i+".0.0 <"+(+i+1)+".0.0":Mt(o)?a=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0":f?(at("replaceTilde pr",f),a=">="+i+"."+s+"."+o+"-"+f+" <"+i+"."+(+s+1)+".0"):a=">="+i+"."+s+"."+o+" <"+i+"."+(+s+1)+".0",at("tilde return",a),a})}function xA(n,t){return n.trim().split(/\s+/).map(function(e){return wA(e,t)}).join(" ")}function wA(n,t){at("caret",n,t);var e=t.loose?ft[U.CARETLOOSE]:ft[U.CARET];return n.replace(e,function(r,i,s,o,f){at("caret",n,r,i,s,o,f);var a;return Mt(i)?a="":Mt(s)?a=">="+i+".0.0 <"+(+i+1)+".0.0":Mt(o)?i==="0"?a=">="+i+"."+s+".0 <"+i+"."+(+s+1)+".0":a=">="+i+"."+s+".0 <"+(+i+1)+".0.0":f?(at("replaceCaret pr",f),i==="0"?s==="0"?a=">="+i+"."+s+"."+o+"-"+f+" <"+i+"."+s+"."+(+o+1):a=">="+i+"."+s+"."+o+"-"+f+" <"+i+"."+(+s+1)+".0":a=">="+i+"."+s+"."+o+"-"+f+" <"+(+i+1)+".0.0"):(at("no pr"),i==="0"?s==="0"?a=">="+i+"."+s+"."+o+" <"+i+"."+s+"."+(+o+1):a=">="+i+"."+s+"."+o+" <"+i+"."+(+s+1)+".0":a=">="+i+"."+s+"."+o+" <"+(+i+1)+".0.0"),at("caret return",a),a})}function SA(n,t){return at("replaceXRanges",n,t),n.split(/\s+/).map(function(e){return mA(e,t)}).join(" ")}function mA(n,t){n=n.trim();var e=t.loose?ft[U.XRANGELOOSE]:ft[U.XRANGE];return n.replace(e,function(r,i,s,o,f,a){at("xRange",n,r,i,s,o,f,a);var u=Mt(s),h=u||Mt(o),l=h||Mt(f),A=l;return i==="="&&A&&(i=""),a=t.includePrerelease?"-0":"",u?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&A?(h&&(o=0),f=0,i===">"?(i=">=",h?(s=+s+1,o=0,f=0):(o=+o+1,f=0)):i==="<="&&(i="<",h?s=+s+1:o=+o+1),r=i+s+"."+o+"."+f+a):h?r=">="+s+".0.0"+a+" <"+(+s+1)+".0.0"+a:l&&(r=">="+s+"."+o+".0"+a+" <"+s+"."+(+o+1)+".0"+a),at("xRange return",r),r})}function CA(n,t){return at("replaceStars",n,t),n.trim().replace(ft[U.STAR],"")}function RA(n,t,e,r,i,s,o,f,a,u,h,l,A){return Mt(e)?t="":Mt(r)?t=">="+e+".0.0":Mt(i)?t=">="+e+"."+r+".0":t=">="+t,Mt(a)?f="":Mt(u)?f="<"+(+a+1)+".0.0":Mt(h)?f="<"+a+"."+(+u+1)+".0":l?f="<="+a+"."+u+"."+h+"-"+l:f="<="+f,(t+" "+f).trim()}gt.prototype.test=function(n){if(!n)return!1;if(typeof n=="string")try{n=new We(n,this.options)}catch{return!1}for(var t=0;t<this.set.length;t++)if(BA(this.set[t],n,this.options))return!0;return!1};function BA(n,t,e){for(var r=0;r<n.length;r++)if(!n[r].test(t))return!1;if(t.prerelease.length&&!e.includePrerelease){for(r=0;r<n.length;r++)if(at(n[r].semver),n[r].semver!==mr&&n[r].semver.prerelease.length>0){var i=n[r].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}Pe.satisfies=ss;function ss(n,t,e){try{t=new gt(t,e)}catch{return!1}return t.test(n)}Pe.maxSatisfying=vA;function vA(n,t,e){var r=null,i=null;try{var s=new gt(t,e)}catch{return null}return n.forEach(function(o){s.test(o)&&(!r||i.compare(o)===-1)&&(r=o,i=new We(r,e))}),r}Pe.minSatisfying=NA;function NA(n,t,e){var r=null,i=null;try{var s=new gt(t,e)}catch{return null}return n.forEach(function(o){s.test(o)&&(!r||i.compare(o)===1)&&(r=o,i=new We(r,e))}),r}Pe.minVersion=kA;function kA(n,t){n=new gt(n,t);var e=new We("0.0.0");if(n.test(e)||(e=new We("0.0.0-0"),n.test(e)))return e;e=null;for(var r=0;r<n.set.length;++r){var i=n.set[r];i.forEach(function(s){var o=new We(s.semver.version);switch(s.operator){case">":o.prerelease.length===0?o.patch++:o.prerelease.push(0),o.raw=o.format();case"":case">=":(!e||ti(e,o))&&(e=o);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+s.operator)}})}return e&&n.test(e)?e:null}Pe.validRange=TA;function TA(n,t){try{return new gt(n,t).range||"*"}catch{return null}}Pe.ltr=OA;function OA(n,t,e){return ko(n,t,"<",e)}Pe.gtr=LA;function LA(n,t,e){return ko(n,t,">",e)}Pe.outside=ko;function ko(n,t,e,r){n=new We(n,r),t=new gt(t,r);var i,s,o,f,a;switch(e){case">":i=ti,s=No,o=rs,f=">",a=">=";break;case"<":i=rs,s=vo,o=ti,f="<",a="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(ss(n,t,r))return!1;for(var u=0;u<t.set.length;++u){var h=t.set[u],l=null,A=null;if(h.forEach(function(p){p.semver===mr&&(p=new on(">=0.0.0")),l=l||p,A=A||p,i(p.semver,l.semver,r)?l=p:o(p.semver,A.semver,r)&&(A=p)}),l.operator===f||l.operator===a||(!A.operator||A.operator===f)&&s(n,A.semver))return!1;if(A.operator===a&&o(n,A.semver))return!1}return!0}Pe.prerelease=PA;function PA(n,t){var e=ir(n,t);return e&&e.prerelease.length?e.prerelease:null}Pe.intersects=UA;function UA(n,t,e){return n=new gt(n,e),t=new gt(t,e),n.intersects(t)}Pe.coerce=DA;function DA(n,t){if(n instanceof We)return n;if(typeof n=="number"&&(n=String(n)),typeof n!="string")return null;t=t||{};var e=null;if(!t.rtl)e=n.match(ft[U.COERCE]);else{for(var r;(r=ft[U.COERCERTL].exec(n))&&(!e||e.index+e[0].length!==n.length);)(!e||r.index+r[0].length!==e.index+e[0].length)&&(e=r),ft[U.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;ft[U.COERCERTL].lastIndex=-1}return e===null?null:ir(e[2]+"."+(e[3]||"0")+"."+(e[4]||"0"),t)}});var Dc=_e((ib,To)=>{"use strict";var os=require("fs"),kn=require("path"),{promisify:Tc}=require("util"),QA=kc(),Oc=QA.satisfies(process.version,">=10.12.0"),Lc=n=>{if(process.platform==="win32"&&/[<>:"|?*]/.test(n.replace(kn.parse(n).root,""))){let e=new Error(`Path contains invalid characters: ${n}`);throw e.code="EINVAL",e}},Pc=n=>({...{mode:511,fs:os},...n}),Uc=n=>{let t=new Error(`operation not permitted, mkdir '${n}'`);return t.code="EPERM",t.errno=-4048,t.path=n,t.syscall="mkdir",t},HA=async(n,t)=>{Lc(n),t=Pc(t);let e=Tc(t.fs.mkdir),r=Tc(t.fs.stat);if(Oc&&t.fs.mkdir===os.mkdir){let s=kn.resolve(n);return await e(s,{mode:t.mode,recursive:!0}),s}let i=async s=>{try{return await e(s,t.mode),s}catch(o){if(o.code==="EPERM")throw o;if(o.code==="ENOENT"){if(kn.dirname(s)===s)throw Uc(s);if(o.message.includes("null bytes"))throw o;return await i(kn.dirname(s)),i(s)}try{if(!(await r(s)).isDirectory())throw new Error("The path is not a directory")}catch{throw o}return s}};return i(kn.resolve(n))};To.exports=HA;To.exports.sync=(n,t)=>{if(Lc(n),t=Pc(t),Oc&&t.fs.mkdirSync===os.mkdirSync){let r=kn.resolve(n);return os.mkdirSync(r,{mode:t.mode,recursive:!0}),r}let e=r=>{try{t.fs.mkdirSync(r,t.mode)}catch(i){if(i.code==="EPERM")throw i;if(i.code==="ENOENT"){if(kn.dirname(r)===r)throw Uc(r);if(i.message.includes("null bytes"))throw i;return e(kn.dirname(r)),e(r)}try{if(!t.fs.statSync(r).isDirectory())throw new Error("The path is not a directory")}catch{throw i}}return r};return e(kn.resolve(n))}});var Hc=_e((sb,Qc)=>{"use strict";var yn=n=>n!==null&&typeof n=="object"&&typeof n.pipe=="function";yn.writable=n=>yn(n)&&n.writable!==!1&&typeof n._write=="function"&&typeof n._writableState=="object";yn.readable=n=>yn(n)&&n.readable!==!1&&typeof n._read=="function"&&typeof n._readableState=="object";yn.duplex=n=>yn.writable(n)&&yn.readable(n);yn.transform=n=>yn.duplex(n)&&typeof n._transform=="function";Qc.exports=yn});var qc=_e((ob,Fc)=>{Fc.exports=FA;function FA(n){var t=[];return n.forEach(function(e){/^[A-Za-z0-9_\/-]+$/.test(e)||(e="'"+e.replace(/'/g,"'\\''")+"'",e=e.replace(/^(?:'')+/g,"").replace(/\\'''/g,"\\'")),t.push(e)}),t.join(" ")}});var fs=_e((ub,Wc)=>{Wc.exports={newInvalidAsn1Error:function(n){var t=new Error;return t.name="InvalidAsn1Error",t.message=n||"",t}}});var as=_e((lb,Gc)=>{Gc.exports={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128}});var Uo=_e((hb,$c)=>{"use strict";var cs=require("buffer"),Rr=cs.Buffer,fn={},an;for(an in cs)!cs.hasOwnProperty(an)||an==="SlowBuffer"||an==="Buffer"||(fn[an]=cs[an]);var Br=fn.Buffer={};for(an in Rr)!Rr.hasOwnProperty(an)||an==="allocUnsafe"||an==="allocUnsafeSlow"||(Br[an]=Rr[an]);fn.Buffer.prototype=Rr.prototype;(!Br.from||Br.from===Uint8Array.from)&&(Br.from=function(n,t,e){if(typeof n=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof n);if(n&&typeof n.length>"u")throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n);return Rr(n,t,e)});Br.alloc||(Br.alloc=function(n,t,e){if(typeof n!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof n);if(n<0||n>=2*(1<<30))throw new RangeError('The value "'+n+'" is invalid for option "size"');var r=Rr(n);return!t||t.length===0?r.fill(0):typeof e=="string"?r.fill(t,e):r.fill(t),r});if(!fn.kStringMaxLength)try{fn.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch{}fn.constants||(fn.constants={MAX_LENGTH:fn.kMaxLength},fn.kStringMaxLength&&(fn.constants.MAX_STRING_LENGTH=fn.kStringMaxLength));$c.exports=fn});var Xc=_e((db,jc)=>{var MA=require("assert"),Yc=Uo().Buffer,ni=as(),KA=fs(),vr=KA.newInvalidAsn1Error;function Kt(n){if(!n||!Yc.isBuffer(n))throw new TypeError("data must be a node Buffer");this._buf=n,this._size=n.length,this._len=0,this._offset=0}Object.defineProperty(Kt.prototype,"length",{enumerable:!0,get:function(){return this._len}});Object.defineProperty(Kt.prototype,"offset",{enumerable:!0,get:function(){return this._offset}});Object.defineProperty(Kt.prototype,"remain",{get:function(){return this._size-this._offset}});Object.defineProperty(Kt.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}});Kt.prototype.readByte=function(n){if(this._size-this._offset<1)return null;var t=this._buf[this._offset]&255;return n||(this._offset+=1),t};Kt.prototype.peek=function(){return this.readByte(!0)};Kt.prototype.readLength=function(n){if(n===void 0&&(n=this._offset),n>=this._size)return null;var t=this._buf[n++]&255;if(t===null)return null;if((t&128)===128){if(t&=127,t===0)throw vr("Indefinite length not supported");if(t>4)throw vr("encoding too long");if(this._size-n<t)return null;this._len=0;for(var e=0;e<t;e++)this._len=(this._len<<8)+(this._buf[n++]&255)}else this._len=t;return n};Kt.prototype.readSequence=function(n){var t=this.peek();if(t===null)return null;if(n!==void 0&&n!==t)throw vr("Expected 0x"+n.toString(16)+": got 0x"+t.toString(16));var e=this.readLength(this._offset+1);return e===null?null:(this._offset=e,t)};Kt.prototype.readInt=function(){return this._readTag(ni.Integer)};Kt.prototype.readBoolean=function(){return this._readTag(ni.Boolean)!==0};Kt.prototype.readEnumeration=function(){return this._readTag(ni.Enumeration)};Kt.prototype.readString=function(n,t){n||(n=ni.OctetString);var e=this.peek();if(e===null)return null;if(e!==n)throw vr("Expected 0x"+n.toString(16)+": got 0x"+e.toString(16));var r=this.readLength(this._offset+1);if(r===null||this.length>this._size-r)return null;if(this._offset=r,this.length===0)return t?Yc.alloc(0):"";var i=this._buf.slice(this._offset,this._offset+this.length);return this._offset+=this.length,t?i:i.toString("utf8")};Kt.prototype.readOID=function(n){n||(n=ni.OID);var t=this.readString(n,!0);if(t===null)return null;for(var e=[],r=0,i=0;i<t.length;i++){var s=t[i]&255;r<<=7,r+=s&127,(s&128)===0&&(e.push(r),r=0)}return r=e.shift(),e.unshift(r%40),e.unshift(r/40>>0),e.join(".")};Kt.prototype._readTag=function(n){MA.ok(n!==void 0);var t=this.peek();if(t===null)return null;if(t!==n)throw vr("Expected 0x"+n.toString(16)+": got 0x"+t.toString(16));var e=this.readLength(this._offset+1);if(e===null)return null;if(this.length>4)throw vr("Integer too long: "+this.length);if(this.length>this._size-e)return null;this._offset=e;for(var r=this._buf[this._offset],i=0,s=0;s<this.length;s++)i<<=8,i|=this._buf[this._offset++]&255;return(r&128)===128&&s!==4&&(i-=1<<s*8),i>>0};jc.exports=Kt});var zc=_e((Ab,Vc)=>{var Kn=require("assert"),us=Uo().Buffer,Wn=as(),WA=fs(),ls=WA.newInvalidAsn1Error,GA={size:1024,growthFactor:8};function $A(n,t){Kn.ok(n),Kn.equal(typeof n,"object"),Kn.ok(t),Kn.equal(typeof t,"object");var e=Object.getOwnPropertyNames(n);return e.forEach(function(r){if(!t[r]){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i)}}),t}function Qt(n){n=$A(GA,n||{}),this._buf=us.alloc(n.size||1024),this._size=this._buf.length,this._offset=0,this._options=n,this._seq=[]}Object.defineProperty(Qt.prototype,"buffer",{get:function(){if(this._seq.length)throw ls(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}});Qt.prototype.writeByte=function(n){if(typeof n!="number")throw new TypeError("argument must be a Number");this._ensure(1),this._buf[this._offset++]=n};Qt.prototype.writeInt=function(n,t){if(typeof n!="number")throw new TypeError("argument must be a Number");typeof t!="number"&&(t=Wn.Integer);for(var e=4;((n&4286578688)===0||(n&4286578688)===-8388608)&&e>1;)e--,n<<=8;if(e>4)throw ls("BER ints cannot be > 0xffffffff");for(this._ensure(2+e),this._buf[this._offset++]=t,this._buf[this._offset++]=e;e-- >0;)this._buf[this._offset++]=(n&4278190080)>>>24,n<<=8};Qt.prototype.writeNull=function(){this.writeByte(Wn.Null),this.writeByte(0)};Qt.prototype.writeEnumeration=function(n,t){if(typeof n!="number")throw new TypeError("argument must be a Number");return typeof t!="number"&&(t=Wn.Enumeration),this.writeInt(n,t)};Qt.prototype.writeBoolean=function(n,t){if(typeof n!="boolean")throw new TypeError("argument must be a Boolean");typeof t!="number"&&(t=Wn.Boolean),this._ensure(3),this._buf[this._offset++]=t,this._buf[this._offset++]=1,this._buf[this._offset++]=n?255:0};Qt.prototype.writeString=function(n,t){if(typeof n!="string")throw new TypeError("argument must be a string (was: "+typeof n+")");typeof t!="number"&&(t=Wn.OctetString);var e=us.byteLength(n);this.writeByte(t),this.writeLength(e),e&&(this._ensure(e),this._buf.write(n,this._offset),this._offset+=e)};Qt.prototype.writeBuffer=function(n,t){if(typeof t!="number")throw new TypeError("tag must be a number");if(!us.isBuffer(n))throw new TypeError("argument must be a buffer");this.writeByte(t),this.writeLength(n.length),this._ensure(n.length),n.copy(this._buf,this._offset,0,n.length),this._offset+=n.length};Qt.prototype.writeStringArray=function(n){if(!n instanceof Array)throw new TypeError("argument must be an Array[String]");var t=this;n.forEach(function(e){t.writeString(e)})};Qt.prototype.writeOID=function(n,t){if(typeof n!="string")throw new TypeError("argument must be a string");if(typeof t!="number"&&(t=Wn.OID),!/^([0-9]+\.){3,}[0-9]+$/.test(n))throw new Error("argument is not a valid OID string");function e(o,f){f<128?o.push(f):f<16384?(o.push(f>>>7|128),o.push(f&127)):f<2097152?(o.push(f>>>14|128),o.push((f>>>7|128)&255),o.push(f&127)):f<268435456?(o.push(f>>>21|128),o.push((f>>>14|128)&255),o.push((f>>>7|128)&255),o.push(f&127)):(o.push((f>>>28|128)&255),o.push((f>>>21|128)&255),o.push((f>>>14|128)&255),o.push((f>>>7|128)&255),o.push(f&127))}var r=n.split("."),i=[];i.push(parseInt(r[0],10)*40+parseInt(r[1],10)),r.slice(2).forEach(function(o){e(i,parseInt(o,10))});var s=this;this._ensure(2+i.length),this.writeByte(t),this.writeLength(i.length),i.forEach(function(o){s.writeByte(o)})};Qt.prototype.writeLength=function(n){if(typeof n!="number")throw new TypeError("argument must be a Number");if(this._ensure(4),n<=127)this._buf[this._offset++]=n;else if(n<=255)this._buf[this._offset++]=129,this._buf[this._offset++]=n;else if(n<=65535)this._buf[this._offset++]=130,this._buf[this._offset++]=n>>8,this._buf[this._offset++]=n;else if(n<=16777215)this._buf[this._offset++]=131,this._buf[this._offset++]=n>>16,this._buf[this._offset++]=n>>8,this._buf[this._offset++]=n;else throw ls("Length too long (> 4 bytes)")};Qt.prototype.startSequence=function(n){typeof n!="number"&&(n=Wn.Sequence|Wn.Constructor),this.writeByte(n),this._seq.push(this._offset),this._ensure(3),this._offset+=3};Qt.prototype.endSequence=function(){var n=this._seq.pop(),t=n+3,e=this._offset-t;if(e<=127)this._shift(t,e,-2),this._buf[n]=e;else if(e<=255)this._shift(t,e,-1),this._buf[n]=129,this._buf[n+1]=e;else if(e<=65535)this._buf[n]=130,this._buf[n+1]=e>>8,this._buf[n+2]=e;else if(e<=16777215)this._shift(t,e,1),this._buf[n]=131,this._buf[n+1]=e>>16,this._buf[n+2]=e>>8,this._buf[n+3]=e;else throw ls("Sequence too long")};Qt.prototype._shift=function(n,t,e){Kn.ok(n!==void 0),Kn.ok(t!==void 0),Kn.ok(e),this._buf.copy(this._buf,n+e,n,n+t),this._offset+=e};Qt.prototype._ensure=function(n){if(Kn.ok(n),this._size-this._offset<n){var t=this._size*this._options.growthFactor;t-this._offset<n&&(t+=n);var e=us.alloc(t);this._buf.copy(e,0,0,this._offset),this._buf=e,this._size=t}};Vc.exports=Qt});var Jc=_e((_b,As)=>{var Do=fs(),Qo=as(),YA=Xc(),jA=zc();As.exports={Reader:YA,Writer:jA};for(hs in Qo)Qo.hasOwnProperty(hs)&&(As.exports[hs]=Qo[hs]);var hs;for(ds in Do)Do.hasOwnProperty(ds)&&(As.exports[ds]=Do[ds]);var ds});var _s=_e((gb,Zc)=>{var Ho=Jc();Zc.exports={Ber:Ho,BerReader:Ho.Reader,BerWriter:Ho.Writer}});var eu=_e((Eb,gs)=>{(function(n){"use strict";var t=function(d){var g,_=new Float64Array(16);if(d)for(g=0;g<d.length;g++)_[g]=d[g];return _},e=function(){throw new Error("no PRNG")},r=new Uint8Array(16),i=new Uint8Array(32);i[0]=9;var s=t(),o=t([1]),f=t([56129,1]),a=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),u=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),h=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),l=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),A=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function p(d,g,_,c){d[g]=_>>24&255,d[g+1]=_>>16&255,d[g+2]=_>>8&255,d[g+3]=_&255,d[g+4]=c>>24&255,d[g+5]=c>>16&255,d[g+6]=c>>8&255,d[g+7]=c&255}function y(d,g,_,c,E){var S,B=0;for(S=0;S<E;S++)B|=d[g+S]^_[c+S];return(1&B-1>>>8)-1}function I(d,g,_,c){return y(d,g,_,c,16)}function v(d,g,_,c){return y(d,g,_,c,32)}function x(d,g,_,c){for(var E=c[0]&255|(c[1]&255)<<8|(c[2]&255)<<16|(c[3]&255)<<24,S=_[0]&255|(_[1]&255)<<8|(_[2]&255)<<16|(_[3]&255)<<24,B=_[4]&255|(_[5]&255)<<8|(_[6]&255)<<16|(_[7]&255)<<24,Y=_[8]&255|(_[9]&255)<<8|(_[10]&255)<<16|(_[11]&255)<<24,Z=_[12]&255|(_[13]&255)<<8|(_[14]&255)<<16|(_[15]&255)<<24,le=c[4]&255|(c[5]&255)<<8|(c[6]&255)<<16|(c[7]&255)<<24,fe=g[0]&255|(g[1]&255)<<8|(g[2]&255)<<16|(g[3]&255)<<24,nt=g[4]&255|(g[5]&255)<<8|(g[6]&255)<<16|(g[7]&255)<<24,ue=g[8]&255|(g[9]&255)<<8|(g[10]&255)<<16|(g[11]&255)<<24,ke=g[12]&255|(g[13]&255)<<8|(g[14]&255)<<16|(g[15]&255)<<24,Te=c[8]&255|(c[9]&255)<<8|(c[10]&255)<<16|(c[11]&255)<<24,He=_[16]&255|(_[17]&255)<<8|(_[18]&255)<<16|(_[19]&255)<<24,De=_[20]&255|(_[21]&255)<<8|(_[22]&255)<<16|(_[23]&255)<<24,Oe=_[24]&255|(_[25]&255)<<8|(_[26]&255)<<16|(_[27]&255)<<24,Ue=_[28]&255|(_[29]&255)<<8|(_[30]&255)<<16|(_[31]&255)<<24,Le=c[12]&255|(c[13]&255)<<8|(c[14]&255)<<16|(c[15]&255)<<24,he=E,Ee=S,ae=B,de=Y,Ae=Z,oe=le,L=fe,P=nt,z=ue,G=ke,j=Te,J=He,Se=De,Fe=Oe,Me=Ue,qe=Le,b,Ge=0;Ge<20;Ge+=2)b=he+Se|0,Ae^=b<<7|b>>>32-7,b=Ae+he|0,z^=b<<9|b>>>32-9,b=z+Ae|0,Se^=b<<13|b>>>32-13,b=Se+z|0,he^=b<<18|b>>>32-18,b=oe+Ee|0,G^=b<<7|b>>>32-7,b=G+oe|0,Fe^=b<<9|b>>>32-9,b=Fe+G|0,Ee^=b<<13|b>>>32-13,b=Ee+Fe|0,oe^=b<<18|b>>>32-18,b=j+L|0,Me^=b<<7|b>>>32-7,b=Me+j|0,ae^=b<<9|b>>>32-9,b=ae+Me|0,L^=b<<13|b>>>32-13,b=L+ae|0,j^=b<<18|b>>>32-18,b=qe+J|0,de^=b<<7|b>>>32-7,b=de+qe|0,P^=b<<9|b>>>32-9,b=P+de|0,J^=b<<13|b>>>32-13,b=J+P|0,qe^=b<<18|b>>>32-18,b=he+de|0,Ee^=b<<7|b>>>32-7,b=Ee+he|0,ae^=b<<9|b>>>32-9,b=ae+Ee|0,de^=b<<13|b>>>32-13,b=de+ae|0,he^=b<<18|b>>>32-18,b=oe+Ae|0,L^=b<<7|b>>>32-7,b=L+oe|0,P^=b<<9|b>>>32-9,b=P+L|0,Ae^=b<<13|b>>>32-13,b=Ae+P|0,oe^=b<<18|b>>>32-18,b=j+G|0,J^=b<<7|b>>>32-7,b=J+j|0,z^=b<<9|b>>>32-9,b=z+J|0,G^=b<<13|b>>>32-13,b=G+z|0,j^=b<<18|b>>>32-18,b=qe+Me|0,Se^=b<<7|b>>>32-7,b=Se+qe|0,Fe^=b<<9|b>>>32-9,b=Fe+Se|0,Me^=b<<13|b>>>32-13,b=Me+Fe|0,qe^=b<<18|b>>>32-18;he=he+E|0,Ee=Ee+S|0,ae=ae+B|0,de=de+Y|0,Ae=Ae+Z|0,oe=oe+le|0,L=L+fe|0,P=P+nt|0,z=z+ue|0,G=G+ke|0,j=j+Te|0,J=J+He|0,Se=Se+De|0,Fe=Fe+Oe|0,Me=Me+Ue|0,qe=qe+Le|0,d[0]=he>>>0&255,d[1]=he>>>8&255,d[2]=he>>>16&255,d[3]=he>>>24&255,d[4]=Ee>>>0&255,d[5]=Ee>>>8&255,d[6]=Ee>>>16&255,d[7]=Ee>>>24&255,d[8]=ae>>>0&255,d[9]=ae>>>8&255,d[10]=ae>>>16&255,d[11]=ae>>>24&255,d[12]=de>>>0&255,d[13]=de>>>8&255,d[14]=de>>>16&255,d[15]=de>>>24&255,d[16]=Ae>>>0&255,d[17]=Ae>>>8&255,d[18]=Ae>>>16&255,d[19]=Ae>>>24&255,d[20]=oe>>>0&255,d[21]=oe>>>8&255,d[22]=oe>>>16&255,d[23]=oe>>>24&255,d[24]=L>>>0&255,d[25]=L>>>8&255,d[26]=L>>>16&255,d[27]=L>>>24&255,d[28]=P>>>0&255,d[29]=P>>>8&255,d[30]=P>>>16&255,d[31]=P>>>24&255,d[32]=z>>>0&255,d[33]=z>>>8&255,d[34]=z>>>16&255,d[35]=z>>>24&255,d[36]=G>>>0&255,d[37]=G>>>8&255,d[38]=G>>>16&255,d[39]=G>>>24&255,d[40]=j>>>0&255,d[41]=j>>>8&255,d[42]=j>>>16&255,d[43]=j>>>24&255,d[44]=J>>>0&255,d[45]=J>>>8&255,d[46]=J>>>16&255,d[47]=J>>>24&255,d[48]=Se>>>0&255,d[49]=Se>>>8&255,d[50]=Se>>>16&255,d[51]=Se>>>24&255,d[52]=Fe>>>0&255,d[53]=Fe>>>8&255,d[54]=Fe>>>16&255,d[55]=Fe>>>24&255,d[56]=Me>>>0&255,d[57]=Me>>>8&255,d[58]=Me>>>16&255,d[59]=Me>>>24&255,d[60]=qe>>>0&255,d[61]=qe>>>8&255,d[62]=qe>>>16&255,d[63]=qe>>>24&255}function O(d,g,_,c){for(var E=c[0]&255|(c[1]&255)<<8|(c[2]&255)<<16|(c[3]&255)<<24,S=_[0]&255|(_[1]&255)<<8|(_[2]&255)<<16|(_[3]&255)<<24,B=_[4]&255|(_[5]&255)<<8|(_[6]&255)<<16|(_[7]&255)<<24,Y=_[8]&255|(_[9]&255)<<8|(_[10]&255)<<16|(_[11]&255)<<24,Z=_[12]&255|(_[13]&255)<<8|(_[14]&255)<<16|(_[15]&255)<<24,le=c[4]&255|(c[5]&255)<<8|(c[6]&255)<<16|(c[7]&255)<<24,fe=g[0]&255|(g[1]&255)<<8|(g[2]&255)<<16|(g[3]&255)<<24,nt=g[4]&255|(g[5]&255)<<8|(g[6]&255)<<16|(g[7]&255)<<24,ue=g[8]&255|(g[9]&255)<<8|(g[10]&255)<<16|(g[11]&255)<<24,ke=g[12]&255|(g[13]&255)<<8|(g[14]&255)<<16|(g[15]&255)<<24,Te=c[8]&255|(c[9]&255)<<8|(c[10]&255)<<16|(c[11]&255)<<24,He=_[16]&255|(_[17]&255)<<8|(_[18]&255)<<16|(_[19]&255)<<24,De=_[20]&255|(_[21]&255)<<8|(_[22]&255)<<16|(_[23]&255)<<24,Oe=_[24]&255|(_[25]&255)<<8|(_[26]&255)<<16|(_[27]&255)<<24,Ue=_[28]&255|(_[29]&255)<<8|(_[30]&255)<<16|(_[31]&255)<<24,Le=c[12]&255|(c[13]&255)<<8|(c[14]&255)<<16|(c[15]&255)<<24,he=E,Ee=S,ae=B,de=Y,Ae=Z,oe=le,L=fe,P=nt,z=ue,G=ke,j=Te,J=He,Se=De,Fe=Oe,Me=Ue,qe=Le,b,Ge=0;Ge<20;Ge+=2)b=he+Se|0,Ae^=b<<7|b>>>32-7,b=Ae+he|0,z^=b<<9|b>>>32-9,b=z+Ae|0,Se^=b<<13|b>>>32-13,b=Se+z|0,he^=b<<18|b>>>32-18,b=oe+Ee|0,G^=b<<7|b>>>32-7,b=G+oe|0,Fe^=b<<9|b>>>32-9,b=Fe+G|0,Ee^=b<<13|b>>>32-13,b=Ee+Fe|0,oe^=b<<18|b>>>32-18,b=j+L|0,Me^=b<<7|b>>>32-7,b=Me+j|0,ae^=b<<9|b>>>32-9,b=ae+Me|0,L^=b<<13|b>>>32-13,b=L+ae|0,j^=b<<18|b>>>32-18,b=qe+J|0,de^=b<<7|b>>>32-7,b=de+qe|0,P^=b<<9|b>>>32-9,b=P+de|0,J^=b<<13|b>>>32-13,b=J+P|0,qe^=b<<18|b>>>32-18,b=he+de|0,Ee^=b<<7|b>>>32-7,b=Ee+he|0,ae^=b<<9|b>>>32-9,b=ae+Ee|0,de^=b<<13|b>>>32-13,b=de+ae|0,he^=b<<18|b>>>32-18,b=oe+Ae|0,L^=b<<7|b>>>32-7,b=L+oe|0,P^=b<<9|b>>>32-9,b=P+L|0,Ae^=b<<13|b>>>32-13,b=Ae+P|0,oe^=b<<18|b>>>32-18,b=j+G|0,J^=b<<7|b>>>32-7,b=J+j|0,z^=b<<9|b>>>32-9,b=z+J|0,G^=b<<13|b>>>32-13,b=G+z|0,j^=b<<18|b>>>32-18,b=qe+Me|0,Se^=b<<7|b>>>32-7,b=Se+qe|0,Fe^=b<<9|b>>>32-9,b=Fe+Se|0,Me^=b<<13|b>>>32-13,b=Me+Fe|0,qe^=b<<18|b>>>32-18;d[0]=he>>>0&255,d[1]=he>>>8&255,d[2]=he>>>16&255,d[3]=he>>>24&255,d[4]=oe>>>0&255,d[5]=oe>>>8&255,d[6]=oe>>>16&255,d[7]=oe>>>24&255,d[8]=j>>>0&255,d[9]=j>>>8&255,d[10]=j>>>16&255,d[11]=j>>>24&255,d[12]=qe>>>0&255,d[13]=qe>>>8&255,d[14]=qe>>>16&255,d[15]=qe>>>24&255,d[16]=L>>>0&255,d[17]=L>>>8&255,d[18]=L>>>16&255,d[19]=L>>>24&255,d[20]=P>>>0&255,d[21]=P>>>8&255,d[22]=P>>>16&255,d[23]=P>>>24&255,d[24]=z>>>0&255,d[25]=z>>>8&255,d[26]=z>>>16&255,d[27]=z>>>24&255,d[28]=G>>>0&255,d[29]=G>>>8&255,d[30]=G>>>16&255,d[31]=G>>>24&255}function X(d,g,_,c){x(d,g,_,c)}function H(d,g,_,c){O(d,g,_,c)}var te=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function ce(d,g,_,c,E,S,B){var Y=new Uint8Array(16),Z=new Uint8Array(64),le,fe;for(fe=0;fe<16;fe++)Y[fe]=0;for(fe=0;fe<8;fe++)Y[fe]=S[fe];for(;E>=64;){for(X(Z,Y,B,te),fe=0;fe<64;fe++)d[g+fe]=_[c+fe]^Z[fe];for(le=1,fe=8;fe<16;fe++)le=le+(Y[fe]&255)|0,Y[fe]=le&255,le>>>=8;E-=64,g+=64,c+=64}if(E>0)for(X(Z,Y,B,te),fe=0;fe<E;fe++)d[g+fe]=_[c+fe]^Z[fe];return 0}function M(d,g,_,c,E){var S=new Uint8Array(16),B=new Uint8Array(64),Y,Z;for(Z=0;Z<16;Z++)S[Z]=0;for(Z=0;Z<8;Z++)S[Z]=c[Z];for(;_>=64;){for(X(B,S,E,te),Z=0;Z<64;Z++)d[g+Z]=B[Z];for(Y=1,Z=8;Z<16;Z++)Y=Y+(S[Z]&255)|0,S[Z]=Y&255,Y>>>=8;_-=64,g+=64}if(_>0)for(X(B,S,E,te),Z=0;Z<_;Z++)d[g+Z]=B[Z];return 0}function q(d,g,_,c,E){var S=new Uint8Array(32);H(S,c,E,te);for(var B=new Uint8Array(8),Y=0;Y<8;Y++)B[Y]=c[Y+16];return M(d,g,_,B,S)}function C(d,g,_,c,E,S,B){var Y=new Uint8Array(32);H(Y,S,B,te);for(var Z=new Uint8Array(8),le=0;le<8;le++)Z[le]=S[le+16];return ce(d,g,_,c,E,Z,Y)}var T=function(d){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var g,_,c,E,S,B,Y,Z;g=d[0]&255|(d[1]&255)<<8,this.r[0]=g&8191,_=d[2]&255|(d[3]&255)<<8,this.r[1]=(g>>>13|_<<3)&8191,c=d[4]&255|(d[5]&255)<<8,this.r[2]=(_>>>10|c<<6)&7939,E=d[6]&255|(d[7]&255)<<8,this.r[3]=(c>>>7|E<<9)&8191,S=d[8]&255|(d[9]&255)<<8,this.r[4]=(E>>>4|S<<12)&255,this.r[5]=S>>>1&8190,B=d[10]&255|(d[11]&255)<<8,this.r[6]=(S>>>14|B<<2)&8191,Y=d[12]&255|(d[13]&255)<<8,this.r[7]=(B>>>11|Y<<5)&8065,Z=d[14]&255|(d[15]&255)<<8,this.r[8]=(Y>>>8|Z<<8)&8191,this.r[9]=Z>>>5&127,this.pad[0]=d[16]&255|(d[17]&255)<<8,this.pad[1]=d[18]&255|(d[19]&255)<<8,this.pad[2]=d[20]&255|(d[21]&255)<<8,this.pad[3]=d[22]&255|(d[23]&255)<<8,this.pad[4]=d[24]&255|(d[25]&255)<<8,this.pad[5]=d[26]&255|(d[27]&255)<<8,this.pad[6]=d[28]&255|(d[29]&255)<<8,this.pad[7]=d[30]&255|(d[31]&255)<<8};T.prototype.blocks=function(d,g,_){for(var c=this.fin?0:2048,E,S,B,Y,Z,le,fe,nt,ue,ke,Te,He,De,Oe,Ue,Le,he,Ee,ae,de=this.h[0],Ae=this.h[1],oe=this.h[2],L=this.h[3],P=this.h[4],z=this.h[5],G=this.h[6],j=this.h[7],J=this.h[8],Se=this.h[9],Fe=this.r[0],Me=this.r[1],qe=this.r[2],b=this.r[3],Ge=this.r[4],rt=this.r[5],it=this.r[6],Ke=this.r[7],Je=this.r[8],Ze=this.r[9];_>=16;)E=d[g+0]&255|(d[g+1]&255)<<8,de+=E&8191,S=d[g+2]&255|(d[g+3]&255)<<8,Ae+=(E>>>13|S<<3)&8191,B=d[g+4]&255|(d[g+5]&255)<<8,oe+=(S>>>10|B<<6)&8191,Y=d[g+6]&255|(d[g+7]&255)<<8,L+=(B>>>7|Y<<9)&8191,Z=d[g+8]&255|(d[g+9]&255)<<8,P+=(Y>>>4|Z<<12)&8191,z+=Z>>>1&8191,le=d[g+10]&255|(d[g+11]&255)<<8,G+=(Z>>>14|le<<2)&8191,fe=d[g+12]&255|(d[g+13]&255)<<8,j+=(le>>>11|fe<<5)&8191,nt=d[g+14]&255|(d[g+15]&255)<<8,J+=(fe>>>8|nt<<8)&8191,Se+=nt>>>5|c,ue=0,ke=ue,ke+=de*Fe,ke+=Ae*(5*Ze),ke+=oe*(5*Je),ke+=L*(5*Ke),ke+=P*(5*it),ue=ke>>>13,ke&=8191,ke+=z*(5*rt),ke+=G*(5*Ge),ke+=j*(5*b),ke+=J*(5*qe),ke+=Se*(5*Me),ue+=ke>>>13,ke&=8191,Te=ue,Te+=de*Me,Te+=Ae*Fe,Te+=oe*(5*Ze),Te+=L*(5*Je),Te+=P*(5*Ke),ue=Te>>>13,Te&=8191,Te+=z*(5*it),Te+=G*(5*rt),Te+=j*(5*Ge),Te+=J*(5*b),Te+=Se*(5*qe),ue+=Te>>>13,Te&=8191,He=ue,He+=de*qe,He+=Ae*Me,He+=oe*Fe,He+=L*(5*Ze),He+=P*(5*Je),ue=He>>>13,He&=8191,He+=z*(5*Ke),He+=G*(5*it),He+=j*(5*rt),He+=J*(5*Ge),He+=Se*(5*b),ue+=He>>>13,He&=8191,De=ue,De+=de*b,De+=Ae*qe,De+=oe*Me,De+=L*Fe,De+=P*(5*Ze),ue=De>>>13,De&=8191,De+=z*(5*Je),De+=G*(5*Ke),De+=j*(5*it),De+=J*(5*rt),De+=Se*(5*Ge),ue+=De>>>13,De&=8191,Oe=ue,Oe+=de*Ge,Oe+=Ae*b,Oe+=oe*qe,Oe+=L*Me,Oe+=P*Fe,ue=Oe>>>13,Oe&=8191,Oe+=z*(5*Ze),Oe+=G*(5*Je),Oe+=j*(5*Ke),Oe+=J*(5*it),Oe+=Se*(5*rt),ue+=Oe>>>13,Oe&=8191,Ue=ue,Ue+=de*rt,Ue+=Ae*Ge,Ue+=oe*b,Ue+=L*qe,Ue+=P*Me,ue=Ue>>>13,Ue&=8191,Ue+=z*Fe,Ue+=G*(5*Ze),Ue+=j*(5*Je),Ue+=J*(5*Ke),Ue+=Se*(5*it),ue+=Ue>>>13,Ue&=8191,Le=ue,Le+=de*it,Le+=Ae*rt,Le+=oe*Ge,Le+=L*b,Le+=P*qe,ue=Le>>>13,Le&=8191,Le+=z*Me,Le+=G*Fe,Le+=j*(5*Ze),Le+=J*(5*Je),Le+=Se*(5*Ke),ue+=Le>>>13,Le&=8191,he=ue,he+=de*Ke,he+=Ae*it,he+=oe*rt,he+=L*Ge,he+=P*b,ue=he>>>13,he&=8191,he+=z*qe,he+=G*Me,he+=j*Fe,he+=J*(5*Ze),he+=Se*(5*Je),ue+=he>>>13,he&=8191,Ee=ue,Ee+=de*Je,Ee+=Ae*Ke,Ee+=oe*it,Ee+=L*rt,Ee+=P*Ge,ue=Ee>>>13,Ee&=8191,Ee+=z*b,Ee+=G*qe,Ee+=j*Me,Ee+=J*Fe,Ee+=Se*(5*Ze),ue+=Ee>>>13,Ee&=8191,ae=ue,ae+=de*Ze,ae+=Ae*Je,ae+=oe*Ke,ae+=L*it,ae+=P*rt,ue=ae>>>13,ae&=8191,ae+=z*Ge,ae+=G*b,ae+=j*qe,ae+=J*Me,ae+=Se*Fe,ue+=ae>>>13,ae&=8191,ue=(ue<<2)+ue|0,ue=ue+ke|0,ke=ue&8191,ue=ue>>>13,Te+=ue,de=ke,Ae=Te,oe=He,L=De,P=Oe,z=Ue,G=Le,j=he,J=Ee,Se=ae,g+=16,_-=16;this.h[0]=de,this.h[1]=Ae,this.h[2]=oe,this.h[3]=L,this.h[4]=P,this.h[5]=z,this.h[6]=G,this.h[7]=j,this.h[8]=J,this.h[9]=Se},T.prototype.finish=function(d,g){var _=new Uint16Array(10),c,E,S,B;if(this.leftover){for(B=this.leftover,this.buffer[B++]=1;B<16;B++)this.buffer[B]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(c=this.h[1]>>>13,this.h[1]&=8191,B=2;B<10;B++)this.h[B]+=c,c=this.h[B]>>>13,this.h[B]&=8191;for(this.h[0]+=c*5,c=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=c,c=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=c,_[0]=this.h[0]+5,c=_[0]>>>13,_[0]&=8191,B=1;B<10;B++)_[B]=this.h[B]+c,c=_[B]>>>13,_[B]&=8191;for(_[9]-=1<<13,E=(c^1)-1,B=0;B<10;B++)_[B]&=E;for(E=~E,B=0;B<10;B++)this.h[B]=this.h[B]&E|_[B];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,S=this.h[0]+this.pad[0],this.h[0]=S&65535,B=1;B<8;B++)S=(this.h[B]+this.pad[B]|0)+(S>>>16)|0,this.h[B]=S&65535;d[g+0]=this.h[0]>>>0&255,d[g+1]=this.h[0]>>>8&255,d[g+2]=this.h[1]>>>0&255,d[g+3]=this.h[1]>>>8&255,d[g+4]=this.h[2]>>>0&255,d[g+5]=this.h[2]>>>8&255,d[g+6]=this.h[3]>>>0&255,d[g+7]=this.h[3]>>>8&255,d[g+8]=this.h[4]>>>0&255,d[g+9]=this.h[4]>>>8&255,d[g+10]=this.h[5]>>>0&255,d[g+11]=this.h[5]>>>8&255,d[g+12]=this.h[6]>>>0&255,d[g+13]=this.h[6]>>>8&255,d[g+14]=this.h[7]>>>0&255,d[g+15]=this.h[7]>>>8&255},T.prototype.update=function(d,g,_){var c,E;if(this.leftover){for(E=16-this.leftover,E>_&&(E=_),c=0;c<E;c++)this.buffer[this.leftover+c]=d[g+c];if(_-=E,g+=E,this.leftover+=E,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(_>=16&&(E=_-_%16,this.blocks(d,g,E),g+=E,_-=E),_){for(c=0;c<_;c++)this.buffer[this.leftover+c]=d[g+c];this.leftover+=_}};function F(d,g,_,c,E,S){var B=new T(S);return B.update(_,c,E),B.finish(d,g),0}function D(d,g,_,c,E,S){var B=new Uint8Array(16);return F(B,0,_,c,E,S),I(d,g,B,0)}function ne(d,g,_,c,E){var S;if(_<32)return-1;for(C(d,0,g,0,_,c,E),F(d,16,d,32,_-32,d),S=0;S<16;S++)d[S]=0;return 0}function re(d,g,_,c,E){var S,B=new Uint8Array(32);if(_<32||(q(B,0,32,c,E),D(g,16,g,32,_-32,B)!==0))return-1;for(C(d,0,g,0,_,c,E),S=0;S<32;S++)d[S]=0;return 0}function ie(d,g){var _;for(_=0;_<16;_++)d[_]=g[_]|0}function ee(d){var g,_,c=1;for(g=0;g<16;g++)_=d[g]+c+65535,c=Math.floor(_/65536),d[g]=_-c*65536;d[0]+=c-1+37*(c-1)}function w(d,g,_){for(var c,E=~(_-1),S=0;S<16;S++)c=E&(d[S]^g[S]),d[S]^=c,g[S]^=c}function k(d,g){var _,c,E,S=t(),B=t();for(_=0;_<16;_++)B[_]=g[_];for(ee(B),ee(B),ee(B),c=0;c<2;c++){for(S[0]=B[0]-65517,_=1;_<15;_++)S[_]=B[_]-65535-(S[_-1]>>16&1),S[_-1]&=65535;S[15]=B[15]-32767-(S[14]>>16&1),E=S[15]>>16&1,S[14]&=65535,w(B,S,1-E)}for(_=0;_<16;_++)d[2*_]=B[_]&255,d[2*_+1]=B[_]>>8}function $(d,g){var _=new Uint8Array(32),c=new Uint8Array(32);return k(_,d),k(c,g),v(_,0,c,0)}function K(d){var g=new Uint8Array(32);return k(g,d),g[0]&1}function pe(d,g){var _;for(_=0;_<16;_++)d[_]=g[2*_]+(g[2*_+1]<<8);d[15]&=32767}function Ne(d,g,_){for(var c=0;c<16;c++)d[c]=g[c]+_[c]}function Ye(d,g,_){for(var c=0;c<16;c++)d[c]=g[c]-_[c]}function Qe(d,g,_){var c,E,S=0,B=0,Y=0,Z=0,le=0,fe=0,nt=0,ue=0,ke=0,Te=0,He=0,De=0,Oe=0,Ue=0,Le=0,he=0,Ee=0,ae=0,de=0,Ae=0,oe=0,L=0,P=0,z=0,G=0,j=0,J=0,Se=0,Fe=0,Me=0,qe=0,b=_[0],Ge=_[1],rt=_[2],it=_[3],Ke=_[4],Je=_[5],Ze=_[6],wt=_[7],ct=_[8],It=_[9],yt=_[10],xt=_[11],Bt=_[12],Pt=_[13],Ut=_[14],Dt=_[15];c=g[0],S+=c*b,B+=c*Ge,Y+=c*rt,Z+=c*it,le+=c*Ke,fe+=c*Je,nt+=c*Ze,ue+=c*wt,ke+=c*ct,Te+=c*It,He+=c*yt,De+=c*xt,Oe+=c*Bt,Ue+=c*Pt,Le+=c*Ut,he+=c*Dt,c=g[1],B+=c*b,Y+=c*Ge,Z+=c*rt,le+=c*it,fe+=c*Ke,nt+=c*Je,ue+=c*Ze,ke+=c*wt,Te+=c*ct,He+=c*It,De+=c*yt,Oe+=c*xt,Ue+=c*Bt,Le+=c*Pt,he+=c*Ut,Ee+=c*Dt,c=g[2],Y+=c*b,Z+=c*Ge,le+=c*rt,fe+=c*it,nt+=c*Ke,ue+=c*Je,ke+=c*Ze,Te+=c*wt,He+=c*ct,De+=c*It,Oe+=c*yt,Ue+=c*xt,Le+=c*Bt,he+=c*Pt,Ee+=c*Ut,ae+=c*Dt,c=g[3],Z+=c*b,le+=c*Ge,fe+=c*rt,nt+=c*it,ue+=c*Ke,ke+=c*Je,Te+=c*Ze,He+=c*wt,De+=c*ct,Oe+=c*It,Ue+=c*yt,Le+=c*xt,he+=c*Bt,Ee+=c*Pt,ae+=c*Ut,de+=c*Dt,c=g[4],le+=c*b,fe+=c*Ge,nt+=c*rt,ue+=c*it,ke+=c*Ke,Te+=c*Je,He+=c*Ze,De+=c*wt,Oe+=c*ct,Ue+=c*It,Le+=c*yt,he+=c*xt,Ee+=c*Bt,ae+=c*Pt,de+=c*Ut,Ae+=c*Dt,c=g[5],fe+=c*b,nt+=c*Ge,ue+=c*rt,ke+=c*it,Te+=c*Ke,He+=c*Je,De+=c*Ze,Oe+=c*wt,Ue+=c*ct,Le+=c*It,he+=c*yt,Ee+=c*xt,ae+=c*Bt,de+=c*Pt,Ae+=c*Ut,oe+=c*Dt,c=g[6],nt+=c*b,ue+=c*Ge,ke+=c*rt,Te+=c*it,He+=c*Ke,De+=c*Je,Oe+=c*Ze,Ue+=c*wt,Le+=c*ct,he+=c*It,Ee+=c*yt,ae+=c*xt,de+=c*Bt,Ae+=c*Pt,oe+=c*Ut,L+=c*Dt,c=g[7],ue+=c*b,ke+=c*Ge,Te+=c*rt,He+=c*it,De+=c*Ke,Oe+=c*Je,Ue+=c*Ze,Le+=c*wt,he+=c*ct,Ee+=c*It,ae+=c*yt,de+=c*xt,Ae+=c*Bt,oe+=c*Pt,L+=c*Ut,P+=c*Dt,c=g[8],ke+=c*b,Te+=c*Ge,He+=c*rt,De+=c*it,Oe+=c*Ke,Ue+=c*Je,Le+=c*Ze,he+=c*wt,Ee+=c*ct,ae+=c*It,de+=c*yt,Ae+=c*xt,oe+=c*Bt,L+=c*Pt,P+=c*Ut,z+=c*Dt,c=g[9],Te+=c*b,He+=c*Ge,De+=c*rt,Oe+=c*it,Ue+=c*Ke,Le+=c*Je,he+=c*Ze,Ee+=c*wt,ae+=c*ct,de+=c*It,Ae+=c*yt,oe+=c*xt,L+=c*Bt,P+=c*Pt,z+=c*Ut,G+=c*Dt,c=g[10],He+=c*b,De+=c*Ge,Oe+=c*rt,Ue+=c*it,Le+=c*Ke,he+=c*Je,Ee+=c*Ze,ae+=c*wt,de+=c*ct,Ae+=c*It,oe+=c*yt,L+=c*xt,P+=c*Bt,z+=c*Pt,G+=c*Ut,j+=c*Dt,c=g[11],De+=c*b,Oe+=c*Ge,Ue+=c*rt,Le+=c*it,he+=c*Ke,Ee+=c*Je,ae+=c*Ze,de+=c*wt,Ae+=c*ct,oe+=c*It,L+=c*yt,P+=c*xt,z+=c*Bt,G+=c*Pt,j+=c*Ut,J+=c*Dt,c=g[12],Oe+=c*b,Ue+=c*Ge,Le+=c*rt,he+=c*it,Ee+=c*Ke,ae+=c*Je,de+=c*Ze,Ae+=c*wt,oe+=c*ct,L+=c*It,P+=c*yt,z+=c*xt,G+=c*Bt,j+=c*Pt,J+=c*Ut,Se+=c*Dt,c=g[13],Ue+=c*b,Le+=c*Ge,he+=c*rt,Ee+=c*it,ae+=c*Ke,de+=c*Je,Ae+=c*Ze,oe+=c*wt,L+=c*ct,P+=c*It,z+=c*yt,G+=c*xt,j+=c*Bt,J+=c*Pt,Se+=c*Ut,Fe+=c*Dt,c=g[14],Le+=c*b,he+=c*Ge,Ee+=c*rt,ae+=c*it,de+=c*Ke,Ae+=c*Je,oe+=c*Ze,L+=c*wt,P+=c*ct,z+=c*It,G+=c*yt,j+=c*xt,J+=c*Bt,Se+=c*Pt,Fe+=c*Ut,Me+=c*Dt,c=g[15],he+=c*b,Ee+=c*Ge,ae+=c*rt,de+=c*it,Ae+=c*Ke,oe+=c*Je,L+=c*Ze,P+=c*wt,z+=c*ct,G+=c*It,j+=c*yt,J+=c*xt,Se+=c*Bt,Fe+=c*Pt,Me+=c*Ut,qe+=c*Dt,S+=38*Ee,B+=38*ae,Y+=38*de,Z+=38*Ae,le+=38*oe,fe+=38*L,nt+=38*P,ue+=38*z,ke+=38*G,Te+=38*j,He+=38*J,De+=38*Se,Oe+=38*Fe,Ue+=38*Me,Le+=38*qe,E=1,c=S+E+65535,E=Math.floor(c/65536),S=c-E*65536,c=B+E+65535,E=Math.floor(c/65536),B=c-E*65536,c=Y+E+65535,E=Math.floor(c/65536),Y=c-E*65536,c=Z+E+65535,E=Math.floor(c/65536),Z=c-E*65536,c=le+E+65535,E=Math.floor(c/65536),le=c-E*65536,c=fe+E+65535,E=Math.floor(c/65536),fe=c-E*65536,c=nt+E+65535,E=Math.floor(c/65536),nt=c-E*65536,c=ue+E+65535,E=Math.floor(c/65536),ue=c-E*65536,c=ke+E+65535,E=Math.floor(c/65536),ke=c-E*65536,c=Te+E+65535,E=Math.floor(c/65536),Te=c-E*65536,c=He+E+65535,E=Math.floor(c/65536),He=c-E*65536,c=De+E+65535,E=Math.floor(c/65536),De=c-E*65536,c=Oe+E+65535,E=Math.floor(c/65536),Oe=c-E*65536,c=Ue+E+65535,E=Math.floor(c/65536),Ue=c-E*65536,c=Le+E+65535,E=Math.floor(c/65536),Le=c-E*65536,c=he+E+65535,E=Math.floor(c/65536),he=c-E*65536,S+=E-1+37*(E-1),E=1,c=S+E+65535,E=Math.floor(c/65536),S=c-E*65536,c=B+E+65535,E=Math.floor(c/65536),B=c-E*65536,c=Y+E+65535,E=Math.floor(c/65536),Y=c-E*65536,c=Z+E+65535,E=Math.floor(c/65536),Z=c-E*65536,c=le+E+65535,E=Math.floor(c/65536),le=c-E*65536,c=fe+E+65535,E=Math.floor(c/65536),fe=c-E*65536,c=nt+E+65535,E=Math.floor(c/65536),nt=c-E*65536,c=ue+E+65535,E=Math.floor(c/65536),ue=c-E*65536,c=ke+E+65535,E=Math.floor(c/65536),ke=c-E*65536,c=Te+E+65535,E=Math.floor(c/65536),Te=c-E*65536,c=He+E+65535,E=Math.floor(c/65536),He=c-E*65536,c=De+E+65535,E=Math.floor(c/65536),De=c-E*65536,c=Oe+E+65535,E=Math.floor(c/65536),Oe=c-E*65536,c=Ue+E+65535,E=Math.floor(c/65536),Ue=c-E*65536,c=Le+E+65535,E=Math.floor(c/65536),Le=c-E*65536,c=he+E+65535,E=Math.floor(c/65536),he=c-E*65536,S+=E-1+37*(E-1),d[0]=S,d[1]=B,d[2]=Y,d[3]=Z,d[4]=le,d[5]=fe,d[6]=nt,d[7]=ue,d[8]=ke,d[9]=Te,d[10]=He,d[11]=De,d[12]=Oe,d[13]=Ue,d[14]=Le,d[15]=he}function St(d,g){Qe(d,g,g)}function ki(d,g){var _=t(),c;for(c=0;c<16;c++)_[c]=g[c];for(c=253;c>=0;c--)St(_,_),c!==2&&c!==4&&Qe(_,_,g);for(c=0;c<16;c++)d[c]=_[c]}function Yr(d,g){var _=t(),c;for(c=0;c<16;c++)_[c]=g[c];for(c=250;c>=0;c--)St(_,_),c!==1&&Qe(_,_,g);for(c=0;c<16;c++)d[c]=_[c]}function hr(d,g,_){var c=new Uint8Array(32),E=new Float64Array(80),S,B,Y=t(),Z=t(),le=t(),fe=t(),nt=t(),ue=t();for(B=0;B<31;B++)c[B]=g[B];for(c[31]=g[31]&127|64,c[0]&=248,pe(E,_),B=0;B<16;B++)Z[B]=E[B],fe[B]=Y[B]=le[B]=0;for(Y[0]=fe[0]=1,B=254;B>=0;--B)S=c[B>>>3]>>>(B&7)&1,w(Y,Z,S),w(le,fe,S),Ne(nt,Y,le),Ye(Y,Y,le),Ne(le,Z,fe),Ye(Z,Z,fe),St(fe,nt),St(ue,Y),Qe(Y,le,Y),Qe(le,Z,nt),Ne(nt,Y,le),Ye(Y,Y,le),St(Z,Y),Ye(le,fe,ue),Qe(Y,le,f),Ne(Y,Y,fe),Qe(le,le,Y),Qe(Y,fe,ue),Qe(fe,Z,E),St(Z,nt),w(Y,Z,S),w(le,fe,S);for(B=0;B<16;B++)E[B+16]=Y[B],E[B+32]=le[B],E[B+48]=Z[B],E[B+64]=fe[B];var ke=E.subarray(32),Te=E.subarray(16);return ki(ke,ke),Qe(Te,Te,ke),k(d,Te),0}function dr(d,g){return hr(d,g,i)}function Cn(d,g){return e(g,32),dr(d,g)}function Ar(d,g,_){var c=new Uint8Array(32);return hr(c,_,g),H(d,r,c,te)}var jr=ne,Ti=re;function Xr(d,g,_,c,E,S){var B=new Uint8Array(32);return Ar(B,E,S),jr(d,g,_,c,B)}function _r(d,g,_,c,E,S){var B=new Uint8Array(32);return Ar(B,E,S),Ti(d,g,_,c,B)}var gr=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function W(d,g,_,c){for(var E=new Int32Array(16),S=new Int32Array(16),B,Y,Z,le,fe,nt,ue,ke,Te,He,De,Oe,Ue,Le,he,Ee,ae,de,Ae,oe,L,P,z,G,j,J,Se=d[0],Fe=d[1],Me=d[2],qe=d[3],b=d[4],Ge=d[5],rt=d[6],it=d[7],Ke=g[0],Je=g[1],Ze=g[2],wt=g[3],ct=g[4],It=g[5],yt=g[6],xt=g[7],Bt=0;c>=128;){for(Ae=0;Ae<16;Ae++)oe=8*Ae+Bt,E[Ae]=_[oe+0]<<24|_[oe+1]<<16|_[oe+2]<<8|_[oe+3],S[Ae]=_[oe+4]<<24|_[oe+5]<<16|_[oe+6]<<8|_[oe+7];for(Ae=0;Ae<80;Ae++)if(B=Se,Y=Fe,Z=Me,le=qe,fe=b,nt=Ge,ue=rt,ke=it,Te=Ke,He=Je,De=Ze,Oe=wt,Ue=ct,Le=It,he=yt,Ee=xt,L=it,P=xt,z=P&65535,G=P>>>16,j=L&65535,J=L>>>16,L=(b>>>14|ct<<32-14)^(b>>>18|ct<<32-18)^(ct>>>41-32|b<<32-(41-32)),P=(ct>>>14|b<<32-14)^(ct>>>18|b<<32-18)^(b>>>41-32|ct<<32-(41-32)),z+=P&65535,G+=P>>>16,j+=L&65535,J+=L>>>16,L=b&Ge^~b&rt,P=ct&It^~ct&yt,z+=P&65535,G+=P>>>16,j+=L&65535,J+=L>>>16,L=gr[Ae*2],P=gr[Ae*2+1],z+=P&65535,G+=P>>>16,j+=L&65535,J+=L>>>16,L=E[Ae%16],P=S[Ae%16],z+=P&65535,G+=P>>>16,j+=L&65535,J+=L>>>16,G+=z>>>16,j+=G>>>16,J+=j>>>16,ae=j&65535|J<<16,de=z&65535|G<<16,L=ae,P=de,z=P&65535,G=P>>>16,j=L&65535,J=L>>>16,L=(Se>>>28|Ke<<32-28)^(Ke>>>34-32|Se<<32-(34-32))^(Ke>>>39-32|Se<<32-(39-32)),P=(Ke>>>28|Se<<32-28)^(Se>>>34-32|Ke<<32-(34-32))^(Se>>>39-32|Ke<<32-(39-32)),z+=P&65535,G+=P>>>16,j+=L&65535,J+=L>>>16,L=Se&Fe^Se&Me^Fe&Me,P=Ke&Je^Ke&Ze^Je&Ze,z+=P&65535,G+=P>>>16,j+=L&65535,J+=L>>>16,G+=z>>>16,j+=G>>>16,J+=j>>>16,ke=j&65535|J<<16,Ee=z&65535|G<<16,L=le,P=Oe,z=P&65535,G=P>>>16,j=L&65535,J=L>>>16,L=ae,P=de,z+=P&65535,G+=P>>>16,j+=L&65535,J+=L>>>16,G+=z>>>16,j+=G>>>16,J+=j>>>16,le=j&65535|J<<16,Oe=z&65535|G<<16,Fe=B,Me=Y,qe=Z,b=le,Ge=fe,rt=nt,it=ue,Se=ke,Je=Te,Ze=He,wt=De,ct=Oe,It=Ue,yt=Le,xt=he,Ke=Ee,Ae%16===15)for(oe=0;oe<16;oe++)L=E[oe],P=S[oe],z=P&65535,G=P>>>16,j=L&65535,J=L>>>16,L=E[(oe+9)%16],P=S[(oe+9)%16],z+=P&65535,G+=P>>>16,j+=L&65535,J+=L>>>16,ae=E[(oe+1)%16],de=S[(oe+1)%16],L=(ae>>>1|de<<32-1)^(ae>>>8|de<<32-8)^ae>>>7,P=(de>>>1|ae<<32-1)^(de>>>8|ae<<32-8)^(de>>>7|ae<<32-7),z+=P&65535,G+=P>>>16,j+=L&65535,J+=L>>>16,ae=E[(oe+14)%16],de=S[(oe+14)%16],L=(ae>>>19|de<<32-19)^(de>>>61-32|ae<<32-(61-32))^ae>>>6,P=(de>>>19|ae<<32-19)^(ae>>>61-32|de<<32-(61-32))^(de>>>6|ae<<32-6),z+=P&65535,G+=P>>>16,j+=L&65535,J+=L>>>16,G+=z>>>16,j+=G>>>16,J+=j>>>16,E[oe]=j&65535|J<<16,S[oe]=z&65535|G<<16;L=Se,P=Ke,z=P&65535,G=P>>>16,j=L&65535,J=L>>>16,L=d[0],P=g[0],z+=P&65535,G+=P>>>16,j+=L&65535,J+=L>>>16,G+=z>>>16,j+=G>>>16,J+=j>>>16,d[0]=Se=j&65535|J<<16,g[0]=Ke=z&65535|G<<16,L=Fe,P=Je,z=P&65535,G=P>>>16,j=L&65535,J=L>>>16,L=d[1],P=g[1],z+=P&65535,G+=P>>>16,j+=L&65535,J+=L>>>16,G+=z>>>16,j+=G>>>16,J+=j>>>16,d[1]=Fe=j&65535|J<<16,g[1]=Je=z&65535|G<<16,L=Me,P=Ze,z=P&65535,G=P>>>16,j=L&65535,J=L>>>16,L=d[2],P=g[2],z+=P&65535,G+=P>>>16,j+=L&65535,J+=L>>>16,G+=z>>>16,j+=G>>>16,J+=j>>>16,d[2]=Me=j&65535|J<<16,g[2]=Ze=z&65535|G<<16,L=qe,P=wt,z=P&65535,G=P>>>16,j=L&65535,J=L>>>16,L=d[3],P=g[3],z+=P&65535,G+=P>>>16,j+=L&65535,J+=L>>>16,G+=z>>>16,j+=G>>>16,J+=j>>>16,d[3]=qe=j&65535|J<<16,g[3]=wt=z&65535|G<<16,L=b,P=ct,z=P&65535,G=P>>>16,j=L&65535,J=L>>>16,L=d[4],P=g[4],z+=P&65535,G+=P>>>16,j+=L&65535,J+=L>>>16,G+=z>>>16,j+=G>>>16,J+=j>>>16,d[4]=b=j&65535|J<<16,g[4]=ct=z&65535|G<<16,L=Ge,P=It,z=P&65535,G=P>>>16,j=L&65535,J=L>>>16,L=d[5],P=g[5],z+=P&65535,G+=P>>>16,j+=L&65535,J+=L>>>16,G+=z>>>16,j+=G>>>16,J+=j>>>16,d[5]=Ge=j&65535|J<<16,g[5]=It=z&65535|G<<16,L=rt,P=yt,z=P&65535,G=P>>>16,j=L&65535,J=L>>>16,L=d[6],P=g[6],z+=P&65535,G+=P>>>16,j+=L&65535,J+=L>>>16,G+=z>>>16,j+=G>>>16,J+=j>>>16,d[6]=rt=j&65535|J<<16,g[6]=yt=z&65535|G<<16,L=it,P=xt,z=P&65535,G=P>>>16,j=L&65535,J=L>>>16,L=d[7],P=g[7],z+=P&65535,G+=P>>>16,j+=L&65535,J+=L>>>16,G+=z>>>16,j+=G>>>16,J+=j>>>16,d[7]=it=j&65535|J<<16,g[7]=xt=z&65535|G<<16,Bt+=128,c-=128}return c}function se(d,g,_){var c=new Int32Array(8),E=new Int32Array(8),S=new Uint8Array(256),B,Y=_;for(c[0]=1779033703,c[1]=3144134277,c[2]=1013904242,c[3]=2773480762,c[4]=1359893119,c[5]=2600822924,c[6]=528734635,c[7]=1541459225,E[0]=4089235720,E[1]=2227873595,E[2]=4271175723,E[3]=1595750129,E[4]=2917565137,E[5]=725511199,E[6]=4215389547,E[7]=327033209,W(c,E,g,_),_%=128,B=0;B<_;B++)S[B]=g[Y-_+B];for(S[_]=128,_=256-128*(_<112?1:0),S[_-9]=0,p(S,_-8,Y/536870912|0,Y<<3),W(c,E,S,_),B=0;B<8;B++)p(d,8*B,c[B],E[B]);return 0}function be(d,g){var _=t(),c=t(),E=t(),S=t(),B=t(),Y=t(),Z=t(),le=t(),fe=t();Ye(_,d[1],d[0]),Ye(fe,g[1],g[0]),Qe(_,_,fe),Ne(c,d[0],d[1]),Ne(fe,g[0],g[1]),Qe(c,c,fe),Qe(E,d[3],g[3]),Qe(E,E,u),Qe(S,d[2],g[2]),Ne(S,S,S),Ye(B,c,_),Ye(Y,S,E),Ne(Z,S,E),Ne(le,c,_),Qe(d[0],B,Y),Qe(d[1],le,Z),Qe(d[2],Z,Y),Qe(d[3],B,le)}function ve(d,g,_){var c;for(c=0;c<4;c++)w(d[c],g[c],_)}function ze(d,g){var _=t(),c=t(),E=t();ki(E,g[2]),Qe(_,g[0],E),Qe(c,g[1],E),k(d,c),d[31]^=K(_)<<7}function mt(d,g,_){var c,E;for(ie(d[0],s),ie(d[1],o),ie(d[2],o),ie(d[3],s),E=255;E>=0;--E)c=_[E/8|0]>>(E&7)&1,ve(d,g,c),be(g,d),be(d,d),ve(d,g,c)}function pn(d,g){var _=[t(),t(),t(),t()];ie(_[0],h),ie(_[1],l),ie(_[2],o),Qe(_[3],h,l),mt(d,_,g)}function Jt(d,g,_){var c=new Uint8Array(64),E=[t(),t(),t(),t()],S;for(_||e(g,32),se(c,g,32),c[0]&=248,c[31]&=127,c[31]|=64,pn(E,c),ze(d,E),S=0;S<32;S++)g[S+32]=d[S];return 0}var Er=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function ot(d,g){var _,c,E,S;for(c=63;c>=32;--c){for(_=0,E=c-32,S=c-12;E<S;++E)g[E]+=_-16*g[c]*Er[E-(c-32)],_=g[E]+128>>8,g[E]-=_*256;g[E]+=_,g[c]=0}for(_=0,E=0;E<32;E++)g[E]+=_-(g[31]>>4)*Er[E],_=g[E]>>8,g[E]&=255;for(E=0;E<32;E++)g[E]-=_*Er[E];for(c=0;c<32;c++)g[c+1]+=g[c]>>8,d[c]=g[c]&255}function Nt(d){var g=new Float64Array(64),_;for(_=0;_<64;_++)g[_]=d[_];for(_=0;_<64;_++)d[_]=0;ot(d,g)}function Rt(d,g,_,c){var E=new Uint8Array(64),S=new Uint8Array(64),B=new Uint8Array(64),Y,Z,le=new Float64Array(64),fe=[t(),t(),t(),t()];se(E,c,32),E[0]&=248,E[31]&=127,E[31]|=64;var nt=_+64;for(Y=0;Y<_;Y++)d[64+Y]=g[Y];for(Y=0;Y<32;Y++)d[32+Y]=E[32+Y];for(se(B,d.subarray(32),_+32),Nt(B),pn(fe,B),ze(d,fe),Y=32;Y<64;Y++)d[Y]=c[Y];for(se(S,d,_+64),Nt(S),Y=0;Y<64;Y++)le[Y]=0;for(Y=0;Y<32;Y++)le[Y]=B[Y];for(Y=0;Y<32;Y++)for(Z=0;Z<32;Z++)le[Y+Z]+=S[Y]*E[Z];return ot(d.subarray(32),le),nt}function pt(d,g){var _=t(),c=t(),E=t(),S=t(),B=t(),Y=t(),Z=t();return ie(d[2],o),pe(d[1],g),St(E,d[1]),Qe(S,E,a),Ye(E,E,d[2]),Ne(S,d[2],S),St(B,S),St(Y,B),Qe(Z,Y,B),Qe(_,Z,E),Qe(_,_,S),Yr(_,_),Qe(_,_,E),Qe(_,_,S),Qe(_,_,S),Qe(d[0],_,S),St(c,d[0]),Qe(c,c,S),$(c,E)&&Qe(d[0],d[0],A),St(c,d[0]),Qe(c,c,S),$(c,E)?-1:(K(d[0])===g[31]>>7&&Ye(d[0],s,d[0]),Qe(d[3],d[0],d[1]),0)}function dt(d,g,_,c){var E,S,B=new Uint8Array(32),Y=new Uint8Array(64),Z=[t(),t(),t(),t()],le=[t(),t(),t(),t()];if(S=-1,_<64||pt(le,c))return-1;for(E=0;E<_;E++)d[E]=g[E];for(E=0;E<32;E++)d[E+32]=c[E];if(se(Y,d,_),Nt(Y),mt(Z,le,Y),pn(le,g.subarray(32)),be(Z,le),ze(B,Z),_-=64,v(g,0,B,0)){for(E=0;E<_;E++)d[E]=0;return-1}for(E=0;E<_;E++)d[E]=g[E+64];return S=_,S}var nn=32,bt=24,er=32,pr=16,Vr=32,Oi=32,zr=32,Jr=32,Zs=32,Ba=bt,vh=er,Nh=pr,Rn=64,tr=32,br=64,eo=32,to=64;n.lowlevel={crypto_core_hsalsa20:H,crypto_stream_xor:C,crypto_stream:q,crypto_stream_salsa20_xor:ce,crypto_stream_salsa20:M,crypto_onetimeauth:F,crypto_onetimeauth_verify:D,crypto_verify_16:I,crypto_verify_32:v,crypto_secretbox:ne,crypto_secretbox_open:re,crypto_scalarmult:hr,crypto_scalarmult_base:dr,crypto_box_beforenm:Ar,crypto_box_afternm:jr,crypto_box:Xr,crypto_box_open:_r,crypto_box_keypair:Cn,crypto_hash:se,crypto_sign:Rt,crypto_sign_keypair:Jt,crypto_sign_open:dt,crypto_secretbox_KEYBYTES:nn,crypto_secretbox_NONCEBYTES:bt,crypto_secretbox_ZEROBYTES:er,crypto_secretbox_BOXZEROBYTES:pr,crypto_scalarmult_BYTES:Vr,crypto_scalarmult_SCALARBYTES:Oi,crypto_box_PUBLICKEYBYTES:zr,crypto_box_SECRETKEYBYTES:Jr,crypto_box_BEFORENMBYTES:Zs,crypto_box_NONCEBYTES:Ba,crypto_box_ZEROBYTES:vh,crypto_box_BOXZEROBYTES:Nh,crypto_sign_BYTES:Rn,crypto_sign_PUBLICKEYBYTES:tr,crypto_sign_SECRETKEYBYTES:br,crypto_sign_SEEDBYTES:eo,crypto_hash_BYTES:to};function va(d,g){if(d.length!==nn)throw new Error("bad key size");if(g.length!==bt)throw new Error("bad nonce size")}function kh(d,g){if(d.length!==zr)throw new Error("bad public key size");if(g.length!==Jr)throw new Error("bad secret key size")}function Zt(){var d,g;for(g=0;g<arguments.length;g++)if((d=Object.prototype.toString.call(arguments[g]))!=="[object Uint8Array]")throw new TypeError("unexpected type "+d+", use Uint8Array")}function Na(d){for(var g=0;g<d.length;g++)d[g]=0}n.util||(n.util={},n.util.decodeUTF8=n.util.encodeUTF8=n.util.encodeBase64=n.util.decodeBase64=function(){throw new Error("nacl.util moved into separate package: https://github.com/dchest/tweetnacl-util-js")}),n.randomBytes=function(d){var g=new Uint8Array(d);return e(g,d),g},n.secretbox=function(d,g,_){Zt(d,g,_),va(_,g);for(var c=new Uint8Array(er+d.length),E=new Uint8Array(c.length),S=0;S<d.length;S++)c[S+er]=d[S];return ne(E,c,c.length,g,_),E.subarray(pr)},n.secretbox.open=function(d,g,_){Zt(d,g,_),va(_,g);for(var c=new Uint8Array(pr+d.length),E=new Uint8Array(c.length),S=0;S<d.length;S++)c[S+pr]=d[S];return c.length<32||re(E,c,c.length,g,_)!==0?!1:E.subarray(er)},n.secretbox.keyLength=nn,n.secretbox.nonceLength=bt,n.secretbox.overheadLength=pr,n.scalarMult=function(d,g){if(Zt(d,g),d.length!==Oi)throw new Error("bad n size");if(g.length!==Vr)throw new Error("bad p size");var _=new Uint8Array(Vr);return hr(_,d,g),_},n.scalarMult.base=function(d){if(Zt(d),d.length!==Oi)throw new Error("bad n size");var g=new Uint8Array(Vr);return dr(g,d),g},n.scalarMult.scalarLength=Oi,n.scalarMult.groupElementLength=Vr,n.box=function(d,g,_,c){var E=n.box.before(_,c);return n.secretbox(d,g,E)},n.box.before=function(d,g){Zt(d,g),kh(d,g);var _=new Uint8Array(Zs);return Ar(_,d,g),_},n.box.after=n.secretbox,n.box.open=function(d,g,_,c){var E=n.box.before(_,c);return n.secretbox.open(d,g,E)},n.box.open.after=n.secretbox.open,n.box.keyPair=function(){var d=new Uint8Array(zr),g=new Uint8Array(Jr);return Cn(d,g),{publicKey:d,secretKey:g}},n.box.keyPair.fromSecretKey=function(d){if(Zt(d),d.length!==Jr)throw new Error("bad secret key size");var g=new Uint8Array(zr);return dr(g,d),{publicKey:g,secretKey:new Uint8Array(d)}},n.box.publicKeyLength=zr,n.box.secretKeyLength=Jr,n.box.sharedKeyLength=Zs,n.box.nonceLength=Ba,n.box.overheadLength=n.secretbox.overheadLength,n.sign=function(d,g){if(Zt(d,g),g.length!==br)throw new Error("bad secret key size");var _=new Uint8Array(Rn+d.length);return Rt(_,d,d.length,g),_},n.sign.open=function(d,g){if(arguments.length!==2)throw new Error("nacl.sign.open accepts 2 arguments; did you mean to use nacl.sign.detached.verify?");if(Zt(d,g),g.length!==tr)throw new Error("bad public key size");var _=new Uint8Array(d.length),c=dt(_,d,d.length,g);if(c<0)return null;for(var E=new Uint8Array(c),S=0;S<E.length;S++)E[S]=_[S];return E},n.sign.detached=function(d,g){for(var _=n.sign(d,g),c=new Uint8Array(Rn),E=0;E<c.length;E++)c[E]=_[E];return c},n.sign.detached.verify=function(d,g,_){if(Zt(d,g,_),g.length!==Rn)throw new Error("bad signature size");if(_.length!==tr)throw new Error("bad public key size");var c=new Uint8Array(Rn+d.length),E=new Uint8Array(Rn+d.length),S;for(S=0;S<Rn;S++)c[S]=g[S];for(S=0;S<d.length;S++)c[S+Rn]=d[S];return dt(E,c,c.length,_)>=0},n.sign.keyPair=function(){var d=new Uint8Array(tr),g=new Uint8Array(br);return Jt(d,g),{publicKey:d,secretKey:g}},n.sign.keyPair.fromSecretKey=function(d){if(Zt(d),d.length!==br)throw new Error("bad secret key size");for(var g=new Uint8Array(tr),_=0;_<g.length;_++)g[_]=d[32+_];return{publicKey:g,secretKey:new Uint8Array(d)}},n.sign.keyPair.fromSeed=function(d){if(Zt(d),d.length!==eo)throw new Error("bad seed size");for(var g=new Uint8Array(tr),_=new Uint8Array(br),c=0;c<32;c++)_[c]=d[c];return Jt(g,_,!0),{publicKey:g,secretKey:_}},n.sign.publicKeyLength=tr,n.sign.secretKeyLength=br,n.sign.seedLength=eo,n.sign.signatureLength=Rn,n.hash=function(d){Zt(d);var g=new Uint8Array(to);return se(g,d,d.length),g},n.hash.hashLength=to,n.verify=function(d,g){return Zt(d,g),d.length===0||g.length===0||d.length!==g.length?!1:y(d,0,g,0,d.length)===0},n.setPRNG=function(d){e=d},function(){var d=typeof self<"u"?self.crypto||self.msCrypto:null;if(d&&d.getRandomValues){var g=65536;n.setPRNG(function(_,c){var E,S=new Uint8Array(c);for(E=0;E<c;E+=g)d.getRandomValues(S.subarray(E,E+Math.min(c-E,g)));for(E=0;E<c;E++)_[E]=S[E];Na(S)})}else typeof require<"u"&&(d=require("crypto"),d&&d.randomBytes&&n.setPRNG(function(_,c){var E,S=d.randomBytes(c);for(E=0;E<c;E++)_[E]=S[E];Na(S)}))}()})(typeof gs<"u"&&gs.exports?gs.exports:self.nacl=self.nacl||{})});var nu=_e((pb,tu)=>{"use strict";var Fo=eu().lowlevel.crypto_hash,Tn=0,or=function(){this.S=[new Uint32Array([3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946]),new Uint32Array([1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055]),new Uint32Array([3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504]),new Uint32Array([976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462])],this.P=new Uint32Array([608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731])};function ps(n,t,e){return(n[0][t[e+3]]+n[1][t[e+2]]^n[2][t[e+1]])+n[3][t[e]]}or.prototype.encipher=function(n,t){t===void 0&&(t=new Uint8Array(n.buffer),n.byteOffset!==0&&(t=t.subarray(n.byteOffset))),n[0]^=this.P[0];for(var e=1;e<16;e+=2)n[1]^=ps(this.S,t,0)^this.P[e],n[0]^=ps(this.S,t,4)^this.P[e+1];var r=n[0];n[0]=n[1]^this.P[17],n[1]=r};or.prototype.decipher=function(n){var t=new Uint8Array(n.buffer);n.byteOffset!==0&&(t=t.subarray(n.byteOffset)),n[0]^=this.P[17];for(var e=16;e>0;e-=2)n[1]^=ps(this.S,t,0)^this.P[e],n[0]^=ps(this.S,t,4)^this.P[e-1];var r=n[0];n[0]=n[1]^this.P[0],n[1]=r};function sr(n,t){var e,r=0;for(e=0;e<4;e++,Tn++)Tn>=t&&(Tn=0),r=r<<8|n[Tn];return r}or.prototype.expand0state=function(n,t){var e=new Uint32Array(2),r,i,s=new Uint8Array(e.buffer);for(r=0,Tn=0;r<18;r++)this.P[r]^=sr(n,t);for(Tn=0,r=0;r<18;r+=2)this.encipher(e,s),this.P[r]=e[0],this.P[r+1]=e[1];for(r=0;r<4;r++)for(i=0;i<256;i+=2)this.encipher(e,s),this.S[r][i]=e[0],this.S[r][i+1]=e[1]};or.prototype.expandstate=function(n,t,e,r){var i=new Uint32Array(2),s,o;for(s=0,Tn=0;s<18;s++)this.P[s]^=sr(e,r);for(s=0,Tn=0;s<18;s+=2)i[0]^=sr(n,t),i[1]^=sr(n,t),this.encipher(i),this.P[s]=i[0],this.P[s+1]=i[1];for(s=0;s<4;s++)for(o=0;o<256;o+=2)i[0]^=sr(n,t),i[1]^=sr(n,t),this.encipher(i),this.S[s][o]=i[0],this.S[s][o+1]=i[1];Tn=0};or.prototype.enc=function(n,t){for(var e=0;e<t;e++)this.encipher(n.subarray(e*2))};or.prototype.dec=function(n,t){for(var e=0;e<t;e++)this.decipher(n.subarray(e*2))};var Es=8,qo=32;function Mo(n,t,e){var r=new or,i=new Uint32Array(Es),s,o=new Uint8Array([79,120,121,99,104,114,111,109,97,116,105,99,66,108,111,119,102,105,115,104,83,119,97,116,68,121,110,97,109,105,116,101]);for(r.expandstate(t,64,n,64),s=0;s<64;s++)r.expand0state(t,64),r.expand0state(n,64);for(s=0;s<Es;s++)i[s]=sr(o,o.byteLength);for(s=0;s<64;s++)r.enc(i,i.byteLength/8);for(s=0;s<Es;s++)e[4*s+3]=i[s]>>>24,e[4*s+2]=i[s]>>>16,e[4*s+1]=i[s]>>>8,e[4*s+0]=i[s]}function XA(n,t,e,r,i,s,o){var f=new Uint8Array(64),a=new Uint8Array(64),u=new Uint8Array(qo),h=new Uint8Array(qo),l=new Uint8Array(r+4),A,p,y,I,v,x,O=s;if(o<1||t===0||r===0||s===0||s>u.byteLength*u.byteLength||r>1<<20)return-1;for(I=Math.floor((s+u.byteLength-1)/u.byteLength),y=Math.floor((s+I-1)/I),A=0;A<r;A++)l[A]=e[A];for(Fo(f,n,t),x=1;s>0;x++){for(l[r+0]=x>>>24,l[r+1]=x>>>16,l[r+2]=x>>>8,l[r+3]=x,Fo(a,l,r+4),Mo(f,a,h),A=u.byteLength;A--;)u[A]=h[A];for(A=1;A<o;A++)for(Fo(a,h,h.byteLength),Mo(f,a,h),p=0;p<u.byteLength;p++)u[p]^=h[p];for(y=Math.min(y,s),A=0;A<y&&(v=A*I+(x-1),!(v>=O));A++)i[v]=u[A];s-=A}return 0}tu.exports={BLOCKS:Es,HASHSIZE:qo,hash:Mo,pbkdf:XA}});var iu=_e((bb,ru)=>{"use strict";var VA=require("./cpufeatures-NH63NRCT.node");ru.exports=VA.getCPUInfo});var Ln=_e((Ib,Is)=>{"use strict";var On=require("crypto"),Nr;try{Nr=iu()()}catch{}var{bindingAvailable:su,CIPHER_INFO:zA,MAC_INFO:JA}=fr(),ou=(()=>{if(typeof On.sign=="function"&&typeof On.verify=="function"){let n=`-----BEGIN PRIVATE KEY-----\r
MC4CAQAwBQYDK2VwBCIEIHKj+sVa9WcD/q2DJUJaf43Kptc8xYuUQA4bOFj9vC8T\r
-----END PRIVATE KEY-----`,t=Buffer.from("a"),e,r;try{e=On.sign(null,t,n),r=On.verify(null,t,n,e)}catch{}return Buffer.isBuffer(e)&&e.length===64&&r===!0}return!1})(),fu=typeof On.diffieHellman=="function"&&typeof On.generateKeyPairSync=="function"&&typeof On.createPublicKey=="function",bs=["ecdh-sha2-nistp256","ecdh-sha2-nistp384","ecdh-sha2-nistp521","diffie-hellman-group-exchange-sha256","diffie-hellman-group14-sha256","diffie-hellman-group15-sha512","diffie-hellman-group16-sha512","diffie-hellman-group17-sha512","diffie-hellman-group18-sha512"];fu&&(bs.unshift("curve25519-sha256"),bs.unshift("curve25519-sha256@libssh.org"));var ZA=bs.concat(["diffie-hellman-group-exchange-sha1","diffie-hellman-group14-sha1","diffie-hellman-group1-sha1"]),Ko=["ecdsa-sha2-nistp256","ecdsa-sha2-nistp384","ecdsa-sha2-nistp521","rsa-sha2-512","rsa-sha2-256","ssh-rsa"];ou&&Ko.unshift("ssh-ed25519");var e_=Ko.concat(["ssh-dss"]),au=(()=>{let n=On.getCiphers();return t=>n.includes(zA[t].sslName)})(),Gn=["aes128-gcm@openssh.com","aes256-gcm@openssh.com","aes128-ctr","aes192-ctr","aes256-ctr"];Nr&&Nr.flags&&!Nr.flags.aes?su?Gn.unshift("chacha20-poly1305@openssh.com"):Gn.push("chacha20-poly1305@openssh.com"):su&&Nr&&Nr.arch==="x86"?Gn.splice(4,0,"chacha20-poly1305@openssh.com"):Gn.push("chacha20-poly1305@openssh.com");Gn=Gn.filter(au);var t_=Gn.concat(["aes256-cbc","aes192-cbc","aes128-cbc","blowfish-cbc","3des-cbc","aes128-gcm","aes256-gcm","arcfour256","arcfour128","cast128-cbc","arcfour"].filter(au)),cu=(()=>{let n=On.getHashes();return t=>n.includes(JA[t].sslName)})(),uu=["hmac-sha2-256-etm@openssh.com","hmac-sha2-512-etm@openssh.com","hmac-sha1-etm@openssh.com","hmac-sha2-256","hmac-sha2-512","hmac-sha1"].filter(cu),n_=uu.concat(["hmac-md5","hmac-sha2-256-96","hmac-sha2-512-96","hmac-ripemd160","hmac-sha1-96","hmac-md5-96"].filter(cu)),lu=["none","zlib@openssh.com","zlib"],r_=lu.concat([]),ri={BAD_DHGEX:1<<0,OLD_EXIT:1<<1,DYN_RPORT_BUG:1<<2,BUG_DHGEX_LARGE:1<<3};Is.exports={MESSAGE:{DISCONNECT:1,IGNORE:2,UNIMPLEMENTED:3,DEBUG:4,SERVICE_REQUEST:5,SERVICE_ACCEPT:6,KEXINIT:20,NEWKEYS:21,KEXDH_INIT:30,KEXDH_REPLY:31,KEXDH_GEX_GROUP:31,KEXDH_GEX_INIT:32,KEXDH_GEX_REPLY:33,KEXDH_GEX_REQUEST:34,KEXECDH_INIT:30,KEXECDH_REPLY:31,USERAUTH_REQUEST:50,USERAUTH_FAILURE:51,USERAUTH_SUCCESS:52,USERAUTH_BANNER:53,USERAUTH_PASSWD_CHANGEREQ:60,USERAUTH_PK_OK:60,USERAUTH_INFO_REQUEST:60,USERAUTH_INFO_RESPONSE:61,GLOBAL_REQUEST:80,REQUEST_SUCCESS:81,REQUEST_FAILURE:82,CHANNEL_OPEN:90,CHANNEL_OPEN_CONFIRMATION:91,CHANNEL_OPEN_FAILURE:92,CHANNEL_WINDOW_ADJUST:93,CHANNEL_DATA:94,CHANNEL_EXTENDED_DATA:95,CHANNEL_EOF:96,CHANNEL_CLOSE:97,CHANNEL_REQUEST:98,CHANNEL_SUCCESS:99,CHANNEL_FAILURE:100},DISCONNECT_REASON:{HOST_NOT_ALLOWED_TO_CONNECT:1,PROTOCOL_ERROR:2,KEY_EXCHANGE_FAILED:3,RESERVED:4,MAC_ERROR:5,COMPRESSION_ERROR:6,SERVICE_NOT_AVAILABLE:7,PROTOCOL_VERSION_NOT_SUPPORTED:8,HOST_KEY_NOT_VERIFIABLE:9,CONNECTION_LOST:10,BY_APPLICATION:11,TOO_MANY_CONNECTIONS:12,AUTH_CANCELED_BY_USER:13,NO_MORE_AUTH_METHODS_AVAILABLE:14,ILLEGAL_USER_NAME:15},DISCONNECT_REASON_STR:void 0,CHANNEL_OPEN_FAILURE:{ADMINISTRATIVELY_PROHIBITED:1,CONNECT_FAILED:2,UNKNOWN_CHANNEL_TYPE:3,RESOURCE_SHORTAGE:4},TERMINAL_MODE:{TTY_OP_END:0,VINTR:1,VQUIT:2,VERASE:3,VKILL:4,VEOF:5,VEOL:6,VEOL2:7,VSTART:8,VSTOP:9,VSUSP:10,VDSUSP:11,VREPRINT:12,VWERASE:13,VLNEXT:14,VFLUSH:15,VSWTCH:16,VSTATUS:17,VDISCARD:18,IGNPAR:30,PARMRK:31,INPCK:32,ISTRIP:33,INLCR:34,IGNCR:35,ICRNL:36,IUCLC:37,IXON:38,IXANY:39,IXOFF:40,IMAXBEL:41,ISIG:50,ICANON:51,XCASE:52,ECHO:53,ECHOE:54,ECHOK:55,ECHONL:56,NOFLSH:57,TOSTOP:58,IEXTEN:59,ECHOCTL:60,ECHOKE:61,PENDIN:62,OPOST:70,OLCUC:71,ONLCR:72,OCRNL:73,ONOCR:74,ONLRET:75,CS7:90,CS8:91,PARENB:92,PARODD:93,TTY_OP_ISPEED:128,TTY_OP_OSPEED:129},CHANNEL_EXTENDED_DATATYPE:{STDERR:1},SIGNALS:["ABRT","ALRM","FPE","HUP","ILL","INT","QUIT","SEGV","TERM","USR1","USR2","KILL","PIPE"].reduce((n,t)=>({...n,[t]:1}),{}),COMPAT:ri,COMPAT_CHECKS:[["Cisco-1.25",ri.BAD_DHGEX],[/^Cisco-1\./,ri.BUG_DHGEX_LARGE],[/^[0-9.]+$/,ri.OLD_EXIT],[/^OpenSSH_5\.\d+/,ri.DYN_RPORT_BUG]],DEFAULT_KEX:bs,SUPPORTED_KEX:ZA,DEFAULT_SERVER_HOST_KEY:Ko,SUPPORTED_SERVER_HOST_KEY:e_,DEFAULT_CIPHER:Gn,SUPPORTED_CIPHER:t_,DEFAULT_MAC:uu,SUPPORTED_MAC:n_,DEFAULT_COMPRESSION:lu,SUPPORTED_COMPRESSION:r_,curve25519Supported:fu,eddsaSupported:ou};Is.exports.DISCONNECT_REASON_BY_VALUE=Array.from(Object.entries(Is.exports.DISCONNECT_REASON)).reduce((n,[t,e])=>({...n,[e]:t}),{})});var An=_e((yb,_u)=>{"use strict";var cn=_s().Ber,ys,Au=Buffer[Symbol.species],i_=Object.getPrototypeOf(Uint8Array.prototype).fill;function hu(n,t){return n[t++]*16777216+n[t++]*65536+n[t++]*256+n[t]}function ii(n,t,e,r,i){i||(i=0),r>n.length&&(r=n.length);let s=r-e,o=t.length-i;return s>o&&(s=o),t.set(new Uint8Array(n.buffer,n.byteOffset+e,s),i),s}function si(n,t,e){return e===void 0&&(e=n.length),new Au(n.buffer,n.byteOffset+t,e-t)}function Go(){let n=0,t,e={init:(r,i)=>{t=r,n=typeof i=="number"?i:0},pos:()=>n,length:()=>t?t.length:0,avail:()=>t&&n<t.length?t.length-n:0,clear:()=>{t=void 0},readUInt32BE:()=>{if(!(!t||n+3>=t.length))return t[n++]*16777216+t[n++]*65536+t[n++]*256+t[n++]},readUInt64BE:r=>{if(!(!t||n+7>=t.length))switch(r){case"always":return BigInt(`0x${t.hexSlice(n,n+=8)}`);case"maybe":if(t[n]>31)return BigInt(`0x${t.hexSlice(n,n+=8)}`);default:return t[n++]*72057594037927940+t[n++]*281474976710656+t[n++]*1099511627776+t[n++]*4294967296+t[n++]*16777216+t[n++]*65536+t[n++]*256+t[n++]}},skip:r=>{t&&r>0&&(n+=r)},skipString:()=>{let r=e.readUInt32BE();if(r!==void 0)return n+=r,n<=t.length?r:void 0},readByte:()=>{if(t&&n<t.length)return t[n++]},readBool:()=>{if(t&&n<t.length)return!!t[n++]},readList:()=>{let r=e.readString(!0);if(r!==void 0)return r?r.split(","):[]},readString:(r,i)=>{typeof r=="number"&&(i=r,r=void 0);let s=e.readUInt32BE();if(s!==void 0&&!(t.length-n<s||typeof i=="number"&&s>i))return r?Buffer.isBuffer(r)?ii(t,r,n,n+=s):t.utf8Slice(n,n+=s):si(t,n,n+=s)},readRaw:r=>{if(!!t){if(typeof r!="number")return si(t,n,n+=t.length-n);if(t.length-n>=r)return si(t,n,n+=r)}}};return e}function du(n,t,e){let r=new Error(n);return typeof t=="boolean"?(e=t,r.level="protocol"):r.level=t||"protocol",r.fatal=!!e,r}function Wo(n,t,e){return n[e++]=t>>>24,n[e++]=t>>>16,n[e++]=t>>>8,n[e++]=t,e}var xs=Go();_u.exports={bufferCopy:ii,bufferSlice:si,FastBuffer:Au,bufferFill:(n,t,e,r)=>i_.call(n,t,e,r),makeError:du,doFatalError:(n,t,e,r)=>{let i;return ys===void 0&&({DISCONNECT_REASON:ys}=Ln()),t instanceof Error?(i=t,typeof e!="number"?r=ys.PROTOCOL_ERROR:r=e):i=du(t,e,!0),typeof r!="number"&&(r=ys.PROTOCOL_ERROR),n.disconnect(r),n._destruct(),n._onError(i),1/0},readUInt32BE:hu,writeUInt32BE:Wo,writeUInt32LE:(n,t,e)=>(n[e++]=t,n[e++]=t>>>8,n[e++]=t>>>16,n[e++]=t>>>24,e),makeBufferParser:Go,bufferParser:Go(),readString:(n,t,e,r)=>{typeof e=="number"&&(r=e,e=void 0),t===void 0&&(t=0);let i=n.length-t;if(t<0||t>=n.length||i<4)return;let s=hu(n,t);if(i<4+s||typeof r=="number"&&s>r)return;t+=4;let o=t+s;return n._pos=o,e?Buffer.isBuffer(e)?ii(n,e,t,o):n.utf8Slice(t,o):si(n,t,o)},sigSSHToASN1:(n,t)=>{switch(t){case"ssh-dss":{if(n.length>40)return n;let e=new cn.Writer;e.startSequence();let r=n.slice(0,20),i=n.slice(20);if(r[0]&128){let s=Buffer.allocUnsafe(21);s[0]=0,r.copy(s,1),r=s}else r[0]===0&&!(r[1]&128)&&(r=r.slice(1));if(i[0]&128){let s=Buffer.allocUnsafe(21);s[0]=0,i.copy(s,1),i=s}else i[0]===0&&!(i[1]&128)&&(i=i.slice(1));return e.writeBuffer(r,cn.Integer),e.writeBuffer(i,cn.Integer),e.endSequence(),e.buffer}case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":{xs.init(n,0);let e=xs.readString(),r=xs.readString();if(xs.clear(),e===void 0||r===void 0)return;let i=new cn.Writer;return i.startSequence(),i.writeBuffer(e,cn.Integer),i.writeBuffer(r,cn.Integer),i.endSequence(),i.buffer}default:return n}},convertSignature:(n,t)=>{switch(t){case"ssh-dss":{if(n.length<=40)return n;let e=new cn.Reader(n);e.readSequence();let r=e.readString(cn.Integer,!0),i=e.readString(cn.Integer,!0),s=0,o=0;if(r.length<20){let a=Buffer.allocUnsafe(20);a.set(r,1),r=a,r[0]=0}if(i.length<20){let a=Buffer.allocUnsafe(20);a.set(i,1),i=a,i[0]=0}r.length>20&&r[0]===0&&(s=1),i.length>20&&i[0]===0&&(o=1);let f=Buffer.allocUnsafe(r.length-s+(i.length-o));return ii(r,f,s,r.length,0),ii(i,f,o,i.length,r.length-s),f}case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":{if(n[0]===0)return n;let e=new cn.Reader(n);e.readSequence();let r=e.readString(cn.Integer,!0),i=e.readString(cn.Integer,!0);if(r===null||i===null)return;let s=Buffer.allocUnsafe(4+r.length+4+i.length);return Wo(s,r.length,0),s.set(r,4),Wo(s,i.length,4+r.length),s.set(i,4+4+r.length),s}}return n},sendPacket:(n,t,e)=>!e&&n._kexinit!==void 0?(n._queue===void 0&&(n._queue=[]),n._queue.push(t),n._debug&&n._debug("Outbound: ... packet queued"),!1):(n._cipher.encrypt(t),!0)}});var gu=_e((ws,Yo)=>{var $o=function(){var n=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(n=n||__filename),function(t){t=t||{};var e;e||(e=typeof t<"u"?t:{});var r,i;e.ready=new Promise(function(W,se){r=W,i=se});var s={},o;for(o in e)e.hasOwnProperty(o)&&(s[o]=e[o]);var f=typeof window=="object",a=typeof importScripts=="function",u=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",h="",l,A,p,y,I;u?(h=a?require("path").dirname(h)+"/":__dirname+"/",l=function(W,se){var be=Cn(W);return be?se?be:be.toString():(y||(y=require("fs")),I||(I=require("path")),W=I.normalize(W),y.readFileSync(W,se?null:"utf8"))},p=function(W){return W=l(W,!0),W.buffer||(W=new Uint8Array(W)),te(W.buffer),W},A=function(W,se,be){var ve=Cn(W);ve&&se(ve),y||(y=require("fs")),I||(I=require("path")),W=I.normalize(W),y.readFile(W,function(ze,mt){ze?be(ze):se(mt.buffer)})},1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),e.inspect=function(){return"[Emscripten Module object]"}):(f||a)&&(a?h=self.location.href:typeof document<"u"&&document.currentScript&&(h=document.currentScript.src),n&&(h=n),h.indexOf("blob:")!==0?h=h.substr(0,h.lastIndexOf("/")+1):h="",l=function(W){try{var se=new XMLHttpRequest;return se.open("GET",W,!1),se.send(null),se.responseText}catch(ze){if(W=Cn(W)){se=[];for(var be=0;be<W.length;be++){var ve=W[be];255<ve&&(hr&&te(!1,"Character code "+ve+" ("+String.fromCharCode(ve)+")  at offset "+be+" not in 0x00-0xFF."),ve&=255),se.push(String.fromCharCode(ve))}return se.join("")}throw ze}},a&&(p=function(W){try{var se=new XMLHttpRequest;return se.open("GET",W,!1),se.responseType="arraybuffer",se.send(null),new Uint8Array(se.response)}catch(be){if(W=Cn(W))return W;throw be}}),A=function(W,se,be){var ve=new XMLHttpRequest;ve.open("GET",W,!0),ve.responseType="arraybuffer",ve.onload=function(){if(ve.status==200||ve.status==0&&ve.response)se(ve.response);else{var ze=Cn(W);ze?se(ze.buffer):be()}},ve.onerror=be,ve.send(null)}),e.print||console.log.bind(console);var v=e.printErr||console.warn.bind(console);for(o in s)s.hasOwnProperty(o)&&(e[o]=s[o]);s=null;var x;e.wasmBinary&&(x=e.wasmBinary);var O=e.noExitRuntime||!0;typeof WebAssembly!="object"&&pe("no native wasm support detected");var X,H=!1;function te(W,se){W||pe("Assertion failed: "+se)}function ce(W){var se=e["_"+W];return te(se,"Cannot call unknown function "+W+", make sure it is exported"),se}function M(W,se,be,ve){var ze={string:function(ot){var Nt=0;if(ot!=null&&ot!==0){var Rt=(ot.length<<2)+1;Nt=Xr(Rt);var pt=Nt,dt=F;if(0<Rt){Rt=pt+Rt-1;for(var nn=0;nn<ot.length;++nn){var bt=ot.charCodeAt(nn);if(55296<=bt&&57343>=bt){var er=ot.charCodeAt(++nn);bt=65536+((bt&1023)<<10)|er&1023}if(127>=bt){if(pt>=Rt)break;dt[pt++]=bt}else{if(2047>=bt){if(pt+1>=Rt)break;dt[pt++]=192|bt>>6}else{if(65535>=bt){if(pt+2>=Rt)break;dt[pt++]=224|bt>>12}else{if(pt+3>=Rt)break;dt[pt++]=240|bt>>18,dt[pt++]=128|bt>>12&63}dt[pt++]=128|bt>>6&63}dt[pt++]=128|bt&63}}dt[pt]=0}}return Nt},array:function(ot){var Nt=Xr(ot.length);return T.set(ot,Nt),Nt}},mt=ce(W),pn=[];if(W=0,ve)for(var Jt=0;Jt<ve.length;Jt++){var Er=ze[be[Jt]];Er?(W===0&&(W=jr()),pn[Jt]=Er(ve[Jt])):pn[Jt]=ve[Jt]}return be=mt.apply(null,pn),be=function(ot){if(se==="string")if(ot){for(var Nt=F,Rt=ot+NaN,pt=ot;Nt[pt]&&!(pt>=Rt);)++pt;if(16<pt-ot&&Nt.subarray&&q)ot=q.decode(Nt.subarray(ot,pt));else{for(Rt="";ot<pt;){var dt=Nt[ot++];if(dt&128){var nn=Nt[ot++]&63;if((dt&224)==192)Rt+=String.fromCharCode((dt&31)<<6|nn);else{var bt=Nt[ot++]&63;dt=(dt&240)==224?(dt&15)<<12|nn<<6|bt:(dt&7)<<18|nn<<12|bt<<6|Nt[ot++]&63,65536>dt?Rt+=String.fromCharCode(dt):(dt-=65536,Rt+=String.fromCharCode(55296|dt>>10,56320|dt&1023))}}else Rt+=String.fromCharCode(dt)}ot=Rt}}else ot="";else ot=se==="boolean"?!!ot:ot;return ot}(be),W!==0&&Ti(W),be}var q=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,C,T,F;function D(){var W=X.buffer;C=W,e.HEAP8=T=new Int8Array(W),e.HEAP16=new Int16Array(W),e.HEAP32=new Int32Array(W),e.HEAPU8=F=new Uint8Array(W),e.HEAPU16=new Uint16Array(W),e.HEAPU32=new Uint32Array(W),e.HEAPF32=new Float32Array(W),e.HEAPF64=new Float64Array(W)}var ne,re=[],ie=[],ee=[];function w(){var W=e.preRun.shift();re.unshift(W)}var k=0,$=null,K=null;e.preloadedImages={},e.preloadedAudios={};function pe(W){throw e.onAbort&&e.onAbort(W),v(W),H=!0,W=new WebAssembly.RuntimeError("abort("+W+"). Build with -s ASSERTIONS=1 for more info."),i(W),W}var Ne="data:application/octet-stream;base64,",Ye;if(Ye="data:application/octet-stream;base64,AGFzbQEAAAABIAZgAX8Bf2ADf39/AGABfwBgAABgAAF/YAZ/f39/f38AAgcBAWEBYQAAAwsKAAEDAQAAAgQFAgQFAXABAQEFBwEBgAKAgAIGCQF/AUGAjMACCwclCQFiAgABYwADAWQACQFlAAgBZgAHAWcABgFoAAUBaQAKAWoBAAqGTQpPAQJ/QYAIKAIAIgEgAEEDakF8cSICaiEAAkAgAkEAIAAgAU0bDQAgAD8AQRB0SwRAIAAQAEUNAQtBgAggADYCACABDwtBhAhBMDYCAEF/C4wFAg5+Cn8gACgCJCEUIAAoAiAhFSAAKAIcIREgACgCGCESIAAoAhQhEyACQRBPBEAgAC0ATEVBGHQhFyAAKAIEIhZBBWytIQ8gACgCCCIYQQVsrSENIAAoAgwiGUEFbK0hCyAAKAIQIhpBBWytIQkgADUCACEIIBqtIRAgGa0hDiAYrSEMIBatIQoDQCASIAEtAAMiEiABLQAEQQh0ciABLQAFQRB0ciABLQAGIhZBGHRyQQJ2Qf///x9xaq0iAyAOfiABLwAAIAEtAAJBEHRyIBNqIBJBGHRBgICAGHFqrSIEIBB+fCARIAEtAAdBCHQgFnIgAS0ACEEQdHIgAS0ACSIRQRh0ckEEdkH///8fcWqtIgUgDH58IAEtAApBCHQgEXIgAS0AC0EQdHIgAS0ADEEYdHJBBnYgFWqtIgYgCn58IBQgF2ogAS8ADSABLQAPQRB0cmqtIgcgCH58IAMgDH4gBCAOfnwgBSAKfnwgBiAIfnwgByAJfnwgAyAKfiAEIAx+fCAFIAh+fCAGIAl+fCAHIAt+fCADIAh+IAQgCn58IAUgCX58IAYgC358IAcgDX58IAMgCX4gBCAIfnwgBSALfnwgBiANfnwgByAPfnwiA0IaiEL/////D4N8IgRCGohC/////w+DfCIFQhqIQv////8Pg3wiBkIaiEL/////D4N8IgdCGoinQQVsIAOnQf///x9xaiITQRp2IASnQf///x9xaiESIAWnQf///x9xIREgBqdB////H3EhFSAHp0H///8fcSEUIBNB////H3EhEyABQRBqIQEgAkEQayICQQ9LDQALCyAAIBQ2AiQgACAVNgIgIAAgETYCHCAAIBI2AhggACATNgIUCwMAAQu2BAEGfwJAIAAoAjgiBARAIABBPGohBQJAIAJBECAEayIDIAIgA0kbIgZFDQAgBkEDcSEHAkAgBkEBa0EDSQRAQQAhAwwBCyAGQXxxIQhBACEDA0AgBSADIARqaiABIANqLQAAOgAAIAUgA0EBciIEIAAoAjhqaiABIARqLQAAOgAAIAUgA0ECciIEIAAoAjhqaiABIARqLQAAOgAAIAUgA0EDciIEIAAoAjhqaiABIARqLQAAOgAAIANBBGohAyAAKAI4IQQgCEEEayIIDQALCyAHRQ0AA0AgBSADIARqaiABIANqLQAAOgAAIANBAWohAyAAKAI4IQQgB0EBayIHDQALCyAAIAQgBmoiAzYCOCADQRBJDQEgACAFQRAQAiAAQQA2AjggAiAGayECIAEgBmohAQsgAkEQTwRAIAAgASACQXBxIgMQAiACQQ9xIQIgASADaiEBCyACRQ0AIAJBA3EhBCAAQTxqIQVBACEDIAJBAWtBA08EQCACQXxxIQcDQCAFIAAoAjggA2pqIAEgA2otAAA6AAAgBSADQQFyIgYgACgCOGpqIAEgBmotAAA6AAAgBSADQQJyIgYgACgCOGpqIAEgBmotAAA6AAAgBSADQQNyIgYgACgCOGpqIAEgBmotAAA6AAAgA0EEaiEDIAdBBGsiBw0ACwsgBARAA0AgBSAAKAI4IANqaiABIANqLQAAOgAAIANBAWohAyAEQQFrIgQNAAsLIAAgACgCOCACajYCOAsLoS0BDH8jAEEQayIMJAACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgAEH0AU0EQEGICCgCACIFQRAgAEELakF4cSAAQQtJGyIIQQN2IgJ2IgFBA3EEQCABQX9zQQFxIAJqIgNBA3QiAUG4CGooAgAiBEEIaiEAAkAgBCgCCCICIAFBsAhqIgFGBEBBiAggBUF+IAN3cTYCAAwBCyACIAE2AgwgASACNgIICyAEIANBA3QiAUEDcjYCBCABIARqIgEgASgCBEEBcjYCBAwNCyAIQZAIKAIAIgpNDQEgAQRAAkBBAiACdCIAQQAgAGtyIAEgAnRxIgBBACAAa3FBAWsiACAAQQx2QRBxIgJ2IgFBBXZBCHEiACACciABIAB2IgFBAnZBBHEiAHIgASAAdiIBQQF2QQJxIgByIAEgAHYiAUEBdkEBcSIAciABIAB2aiIDQQN0IgBBuAhqKAIAIgQoAggiASAAQbAIaiIARgRAQYgIIAVBfiADd3EiBTYCAAwBCyABIAA2AgwgACABNgIICyAEQQhqIQAgBCAIQQNyNgIEIAQgCGoiAiADQQN0IgEgCGsiA0EBcjYCBCABIARqIAM2AgAgCgRAIApBA3YiAUEDdEGwCGohB0GcCCgCACEEAn8gBUEBIAF0IgFxRQRAQYgIIAEgBXI2AgAgBwwBCyAHKAIICyEBIAcgBDYCCCABIAQ2AgwgBCAHNgIMIAQgATYCCAtBnAggAjYCAEGQCCADNgIADA0LQYwIKAIAIgZFDQEgBkEAIAZrcUEBayIAIABBDHZBEHEiAnYiAUEFdkEIcSIAIAJyIAEgAHYiAUECdkEEcSIAciABIAB2IgFBAXZBAnEiAHIgASAAdiIBQQF2QQFxIgByIAEgAHZqQQJ0QbgKaigCACIBKAIEQXhxIAhrIQMgASECA0ACQCACKAIQIgBFBEAgAigCFCIARQ0BCyAAKAIEQXhxIAhrIgIgAyACIANJIgIbIQMgACABIAIbIQEgACECDAELCyABIAhqIgkgAU0NAiABKAIYIQsgASABKAIMIgRHBEAgASgCCCIAQZgIKAIASRogACAENgIMIAQgADYCCAwMCyABQRRqIgIoAgAiAEUEQCABKAIQIgBFDQQgAUEQaiECCwNAIAIhByAAIgRBFGoiAigCACIADQAgBEEQaiECIAQoAhAiAA0ACyAHQQA2AgAMCwtBfyEIIABBv39LDQAgAEELaiIAQXhxIQhBjAgoAgAiCUUNAEEAIAhrIQMCQAJAAkACf0EAIAhBgAJJDQAaQR8gCEH///8HSw0AGiAAQQh2IgAgAEGA/j9qQRB2QQhxIgJ0IgAgAEGA4B9qQRB2QQRxIgF0IgAgAEGAgA9qQRB2QQJxIgB0QQ92IAEgAnIgAHJrIgBBAXQgCCAAQRVqdkEBcXJBHGoLIgVBAnRBuApqKAIAIgJFBEBBACEADAELQQAhACAIQQBBGSAFQQF2ayAFQR9GG3QhAQNAAkAgAigCBEF4cSAIayIHIANPDQAgAiEEIAciAw0AQQAhAyACIQAMAwsgACACKAIUIgcgByACIAFBHXZBBHFqKAIQIgJGGyAAIAcbIQAgAUEBdCEBIAINAAsLIAAgBHJFBEBBACEEQQIgBXQiAEEAIABrciAJcSIARQ0DIABBACAAa3FBAWsiACAAQQx2QRBxIgJ2IgFBBXZBCHEiACACciABIAB2IgFBAnZBBHEiAHIgASAAdiIBQQF2QQJxIgByIAEgAHYiAUEBdkEBcSIAciABIAB2akECdEG4CmooAgAhAAsgAEUNAQsDQCAAKAIEQXhxIAhrIgEgA0khAiABIAMgAhshAyAAIAQgAhshBCAAKAIQIgEEfyABBSAAKAIUCyIADQALCyAERQ0AIANBkAgoAgAgCGtPDQAgBCAIaiIGIARNDQEgBCgCGCEFIAQgBCgCDCIBRwRAIAQoAggiAEGYCCgCAEkaIAAgATYCDCABIAA2AggMCgsgBEEUaiICKAIAIgBFBEAgBCgCECIARQ0EIARBEGohAgsDQCACIQcgACIBQRRqIgIoAgAiAA0AIAFBEGohAiABKAIQIgANAAsgB0EANgIADAkLIAhBkAgoAgAiAk0EQEGcCCgCACEDAkAgAiAIayIBQRBPBEBBkAggATYCAEGcCCADIAhqIgA2AgAgACABQQFyNgIEIAIgA2ogATYCACADIAhBA3I2AgQMAQtBnAhBADYCAEGQCEEANgIAIAMgAkEDcjYCBCACIANqIgAgACgCBEEBcjYCBAsgA0EIaiEADAsLIAhBlAgoAgAiBkkEQEGUCCAGIAhrIgE2AgBBoAhBoAgoAgAiAiAIaiIANgIAIAAgAUEBcjYCBCACIAhBA3I2AgQgAkEIaiEADAsLQQAhACAIQS9qIgkCf0HgCygCAARAQegLKAIADAELQewLQn83AgBB5AtCgKCAgICABDcCAEHgCyAMQQxqQXBxQdiq1aoFczYCAEH0C0EANgIAQcQLQQA2AgBBgCALIgFqIgVBACABayIHcSICIAhNDQpBwAsoAgAiBARAQbgLKAIAIgMgAmoiASADTQ0LIAEgBEsNCwtBxAstAABBBHENBQJAAkBBoAgoAgAiAwRAQcgLIQADQCADIAAoAgAiAU8EQCABIAAoAgRqIANLDQMLIAAoAggiAA0ACwtBABABIgFBf0YNBiACIQVB5AsoAgAiA0EBayIAIAFxBEAgAiABayAAIAFqQQAgA2txaiEFCyAFIAhNDQYgBUH+////B0sNBkHACygCACIEBEBBuAsoAgAiAyAFaiIAIANNDQcgACAESw0HCyAFEAEiACABRw0BDAgLIAUgBmsgB3EiBUH+////B0sNBSAFEAEiASAAKAIAIAAoAgRqRg0EIAEhAAsCQCAAQX9GDQAgCEEwaiAFTQ0AQegLKAIAIgEgCSAFa2pBACABa3EiAUH+////B0sEQCAAIQEMCAsgARABQX9HBEAgASAFaiEFIAAhAQwIC0EAIAVrEAEaDAULIAAiAUF/Rw0GDAQLAAtBACEEDAcLQQAhAQwFCyABQX9HDQILQcQLQcQLKAIAQQRyNgIACyACQf7///8HSw0BIAIQASEBQQAQASEAIAFBf0YNASAAQX9GDQEgACABTQ0BIAAgAWsiBSAIQShqTQ0BC0G4C0G4CygCACAFaiIANgIAQbwLKAIAIABJBEBBvAsgADYCAAsCQAJAAkBBoAgoAgAiBwRAQcgLIQADQCABIAAoAgAiAyAAKAIEIgJqRg0CIAAoAggiAA0ACwwCC0GYCCgCACIAQQAgACABTRtFBEBBmAggATYCAAtBACEAQcwLIAU2AgBByAsgATYCAEGoCEF/NgIAQawIQeALKAIANgIAQdQLQQA2AgADQCAAQQN0IgNBuAhqIANBsAhqIgI2AgAgA0G8CGogAjYCACAAQQFqIgBBIEcNAAtBlAggBUEoayIDQXggAWtBB3FBACABQQhqQQdxGyIAayICNgIAQaAIIAAgAWoiADYCACAAIAJBAXI2AgQgASADakEoNgIEQaQIQfALKAIANgIADAILIAAtAAxBCHENACADIAdLDQAgASAHTQ0AIAAgAiAFajYCBEGgCCAHQXggB2tBB3FBACAHQQhqQQdxGyIAaiICNgIAQZQIQZQIKAIAIAVqIgEgAGsiADYCACACIABBAXI2AgQgASAHakEoNgIEQaQIQfALKAIANgIADAELQZgIKAIAIAFLBEBBmAggATYCAAsgASAFaiECQcgLIQACQAJAAkACQAJAAkADQCACIAAoAgBHBEAgACgCCCIADQEMAgsLIAAtAAxBCHFFDQELQcgLIQADQCAHIAAoAgAiAk8EQCACIAAoAgRqIgQgB0sNAwsgACgCCCEADAALAAsgACABNgIAIAAgACgCBCAFajYCBCABQXggAWtBB3FBACABQQhqQQdxG2oiCSAIQQNyNgIEIAJBeCACa0EHcUEAIAJBCGpBB3EbaiIFIAggCWoiBmshAiAFIAdGBEBBoAggBjYCAEGUCEGUCCgCACACaiIANgIAIAYgAEEBcjYCBAwDCyAFQZwIKAIARgRAQZwIIAY2AgBBkAhBkAgoAgAgAmoiADYCACAGIABBAXI2AgQgACAGaiAANgIADAMLIAUoAgQiAEEDcUEBRgRAIABBeHEhBwJAIABB/wFNBEAgBSgCCCIDIABBA3YiAEEDdEGwCGpGGiADIAUoAgwiAUYEQEGICEGICCgCAEF+IAB3cTYCAAwCCyADIAE2AgwgASADNgIIDAELIAUoAhghCAJAIAUgBSgCDCIBRwRAIAUoAggiACABNgIMIAEgADYCCAwBCwJAIAVBFGoiACgCACIDDQAgBUEQaiIAKAIAIgMNAEEAIQEMAQsDQCAAIQQgAyIBQRRqIgAoAgAiAw0AIAFBEGohACABKAIQIgMNAAsgBEEANgIACyAIRQ0AAkAgBSAFKAIcIgNBAnRBuApqIgAoAgBGBEAgACABNgIAIAENAUGMCEGMCCgCAEF+IAN3cTYCAAwCCyAIQRBBFCAIKAIQIAVGG2ogATYCACABRQ0BCyABIAg2AhggBSgCECIABEAgASAANgIQIAAgATYCGAsgBSgCFCIARQ0AIAEgADYCFCAAIAE2AhgLIAUgB2ohBSACIAdqIQILIAUgBSgCBEF+cTYCBCAGIAJBAXI2AgQgAiAGaiACNgIAIAJB/wFNBEAgAkEDdiIAQQN0QbAIaiECAn9BiAgoAgAiAUEBIAB0IgBxRQRAQYgIIAAgAXI2AgAgAgwBCyACKAIICyEAIAIgBjYCCCAAIAY2AgwgBiACNgIMIAYgADYCCAwDC0EfIQAgAkH///8HTQRAIAJBCHYiACAAQYD+P2pBEHZBCHEiA3QiACAAQYDgH2pBEHZBBHEiAXQiACAAQYCAD2pBEHZBAnEiAHRBD3YgASADciAAcmsiAEEBdCACIABBFWp2QQFxckEcaiEACyAGIAA2AhwgBkIANwIQIABBAnRBuApqIQQCQEGMCCgCACIDQQEgAHQiAXFFBEBBjAggASADcjYCACAEIAY2AgAgBiAENgIYDAELIAJBAEEZIABBAXZrIABBH0YbdCEAIAQoAgAhAQNAIAEiAygCBEF4cSACRg0DIABBHXYhASAAQQF0IQAgAyABQQRxaiIEKAIQIgENAAsgBCAGNgIQIAYgAzYCGAsgBiAGNgIMIAYgBjYCCAwCC0GUCCAFQShrIgNBeCABa0EHcUEAIAFBCGpBB3EbIgBrIgI2AgBBoAggACABaiIANgIAIAAgAkEBcjYCBCABIANqQSg2AgRBpAhB8AsoAgA2AgAgByAEQScgBGtBB3FBACAEQSdrQQdxG2pBL2siACAAIAdBEGpJGyICQRs2AgQgAkHQCykCADcCECACQcgLKQIANwIIQdALIAJBCGo2AgBBzAsgBTYCAEHICyABNgIAQdQLQQA2AgAgAkEYaiEAA0AgAEEHNgIEIABBCGohASAAQQRqIQAgASAESQ0ACyACIAdGDQMgAiACKAIEQX5xNgIEIAcgAiAHayIEQQFyNgIEIAIgBDYCACAEQf8BTQRAIARBA3YiAEEDdEGwCGohAgJ/QYgIKAIAIgFBASAAdCIAcUUEQEGICCAAIAFyNgIAIAIMAQsgAigCCAshACACIAc2AgggACAHNgIMIAcgAjYCDCAHIAA2AggMBAtBHyEAIAdCADcCECAEQf///wdNBEAgBEEIdiIAIABBgP4/akEQdkEIcSICdCIAIABBgOAfakEQdkEEcSIBdCIAIABBgIAPakEQdkECcSIAdEEPdiABIAJyIAByayIAQQF0IAQgAEEVanZBAXFyQRxqIQALIAcgADYCHCAAQQJ0QbgKaiEDAkBBjAgoAgAiAkEBIAB0IgFxRQRAQYwIIAEgAnI2AgAgAyAHNgIAIAcgAzYCGAwBCyAEQQBBGSAAQQF2ayAAQR9GG3QhACADKAIAIQEDQCABIgIoAgRBeHEgBEYNBCAAQR12IQEgAEEBdCEAIAIgAUEEcWoiAygCECIBDQALIAMgBzYCECAHIAI2AhgLIAcgBzYCDCAHIAc2AggMAwsgAygCCCIAIAY2AgwgAyAGNgIIIAZBADYCGCAGIAM2AgwgBiAANgIICyAJQQhqIQAMBQsgAigCCCIAIAc2AgwgAiAHNgIIIAdBADYCGCAHIAI2AgwgByAANgIIC0GUCCgCACIAIAhNDQBBlAggACAIayIBNgIAQaAIQaAIKAIAIgIgCGoiADYCACAAIAFBAXI2AgQgAiAIQQNyNgIEIAJBCGohAAwDC0GECEEwNgIAQQAhAAwCCwJAIAVFDQACQCAEKAIcIgJBAnRBuApqIgAoAgAgBEYEQCAAIAE2AgAgAQ0BQYwIIAlBfiACd3EiCTYCAAwCCyAFQRBBFCAFKAIQIARGG2ogATYCACABRQ0BCyABIAU2AhggBCgCECIABEAgASAANgIQIAAgATYCGAsgBCgCFCIARQ0AIAEgADYCFCAAIAE2AhgLAkAgA0EPTQRAIAQgAyAIaiIAQQNyNgIEIAAgBGoiACAAKAIEQQFyNgIEDAELIAQgCEEDcjYCBCAGIANBAXI2AgQgAyAGaiADNgIAIANB/wFNBEAgA0EDdiIAQQN0QbAIaiECAn9BiAgoAgAiAUEBIAB0IgBxRQRAQYgIIAAgAXI2AgAgAgwBCyACKAIICyEAIAIgBjYCCCAAIAY2AgwgBiACNgIMIAYgADYCCAwBC0EfIQAgA0H///8HTQRAIANBCHYiACAAQYD+P2pBEHZBCHEiAnQiACAAQYDgH2pBEHZBBHEiAXQiACAAQYCAD2pBEHZBAnEiAHRBD3YgASACciAAcmsiAEEBdCADIABBFWp2QQFxckEcaiEACyAGIAA2AhwgBkIANwIQIABBAnRBuApqIQICQAJAIAlBASAAdCIBcUUEQEGMCCABIAlyNgIAIAIgBjYCACAGIAI2AhgMAQsgA0EAQRkgAEEBdmsgAEEfRht0IQAgAigCACEIA0AgCCIBKAIEQXhxIANGDQIgAEEddiECIABBAXQhACABIAJBBHFqIgIoAhAiCA0ACyACIAY2AhAgBiABNgIYCyAGIAY2AgwgBiAGNgIIDAELIAEoAggiACAGNgIMIAEgBjYCCCAGQQA2AhggBiABNgIMIAYgADYCCAsgBEEIaiEADAELAkAgC0UNAAJAIAEoAhwiAkECdEG4CmoiACgCACABRgRAIAAgBDYCACAEDQFBjAggBkF+IAJ3cTYCAAwCCyALQRBBFCALKAIQIAFGG2ogBDYCACAERQ0BCyAEIAs2AhggASgCECIABEAgBCAANgIQIAAgBDYCGAsgASgCFCIARQ0AIAQgADYCFCAAIAQ2AhgLAkAgA0EPTQRAIAEgAyAIaiIAQQNyNgIEIAAgAWoiACAAKAIEQQFyNgIEDAELIAEgCEEDcjYCBCAJIANBAXI2AgQgAyAJaiADNgIAIAoEQCAKQQN2IgBBA3RBsAhqIQRBnAgoAgAhAgJ/QQEgAHQiACAFcUUEQEGICCAAIAVyNgIAIAQMAQsgBCgCCAshACAEIAI2AgggACACNgIMIAIgBDYCDCACIAA2AggLQZwIIAk2AgBBkAggAzYCAAsgAUEIaiEACyAMQRBqJAAgAAsQACMAIABrQXBxIgAkACAACwYAIAAkAAsEACMAC4AJAgh/BH4jAEGQAWsiBiQAIAYgBS0AA0EYdEGAgIAYcSAFLwAAIAUtAAJBEHRycjYCACAGIAUoAANBAnZBg/7/H3E2AgQgBiAFKAAGQQR2Qf+B/x9xNgIIIAYgBSgACUEGdkH//8AfcTYCDCAFLwANIQggBS0ADyEJIAZCADcCFCAGQgA3AhwgBkEANgIkIAYgCCAJQRB0QYCAPHFyNgIQIAYgBSgAEDYCKCAGIAUoABQ2AiwgBiAFKAAYNgIwIAUoABwhBSAGQQA6AEwgBkEANgI4IAYgBTYCNCAGIAEgAhAEIAQEQCAGIAMgBBAECyAGKAI4IgEEQCAGQTxqIgIgAWpBAToAACABQQFqQQ9NBEAgASAGakE9aiEEAkBBDyABayIDRQ0AIAMgBGoiAUEBa0EAOgAAIARBADoAACADQQNJDQAgAUECa0EAOgAAIARBADoAASABQQNrQQA6AAAgBEEAOgACIANBB0kNACABQQRrQQA6AAAgBEEAOgADIANBCUkNACAEQQAgBGtBA3EiAWoiBEEANgIAIAQgAyABa0F8cSIBaiIDQQRrQQA2AgAgAUEJSQ0AIARBADYCCCAEQQA2AgQgA0EIa0EANgIAIANBDGtBADYCACABQRlJDQAgBEEANgIYIARBADYCFCAEQQA2AhAgBEEANgIMIANBEGtBADYCACADQRRrQQA2AgAgA0EYa0EANgIAIANBHGtBADYCACABIARBBHFBGHIiAWsiA0EgSQ0AIAEgBGohAQNAIAFCADcDGCABQgA3AxAgAUIANwMIIAFCADcDACABQSBqIQEgA0EgayIDQR9LDQALCwsgBkEBOgBMIAYgAkEQEAILIAY1AjQhECAGNQIwIREgBjUCLCEOIAAgBjUCKCAGKAIkIAYoAiAgBigCHCAGKAIYIgNBGnZqIgJBGnZqIgFBGnZqIgtBgICAYHIgAUH///8fcSINIAJB////H3EiCCAGKAIUIAtBGnZBBWxqIgFB////H3EiCUEFaiIFQRp2IANB////H3EgAUEadmoiA2oiAUEadmoiAkEadmoiBEEadmoiDEEfdSIHIANxIAEgDEEfdkEBayIDQf///x9xIgpxciIBQRp0IAUgCnEgByAJcXJyrXwiDzwAACAAIA9CGIg8AAMgACAPQhCIPAACIAAgD0IIiDwAASAAIA4gByAIcSACIApxciICQRR0IAFBBnZyrXwgD0IgiHwiDjwABCAAIA5CGIg8AAcgACAOQhCIPAAGIAAgDkIIiDwABSAAIBEgByANcSAEIApxciIBQQ50IAJBDHZyrXwgDkIgiHwiDjwACCAAIA5CGIg8AAsgACAOQhCIPAAKIAAgDkIIiDwACSAAIBAgAyAMcSAHIAtxckEIdCABQRJ2cq18IA5CIIh8Ig48AAwgACAOQhiIPAAPIAAgDkIQiDwADiAAIA5CCIg8AA0gBkIANwIwIAZCADcCKCAGQgA3AiAgBkIANwIYIAZCADcCECAGQgA3AgggBkIANwIAIAZBkAFqJAALpwwBB38CQCAARQ0AIABBCGsiAyAAQQRrKAIAIgFBeHEiAGohBQJAIAFBAXENACABQQNxRQ0BIAMgAygCACIBayIDQZgIKAIASQ0BIAAgAWohACADQZwIKAIARwRAIAFB/wFNBEAgAygCCCICIAFBA3YiBEEDdEGwCGpGGiACIAMoAgwiAUYEQEGICEGICCgCAEF+IAR3cTYCAAwDCyACIAE2AgwgASACNgIIDAILIAMoAhghBgJAIAMgAygCDCIBRwRAIAMoAggiAiABNgIMIAEgAjYCCAwBCwJAIANBFGoiAigCACIEDQAgA0EQaiICKAIAIgQNAEEAIQEMAQsDQCACIQcgBCIBQRRqIgIoAgAiBA0AIAFBEGohAiABKAIQIgQNAAsgB0EANgIACyAGRQ0BAkAgAyADKAIcIgJBAnRBuApqIgQoAgBGBEAgBCABNgIAIAENAUGMCEGMCCgCAEF+IAJ3cTYCAAwDCyAGQRBBFCAGKAIQIANGG2ogATYCACABRQ0CCyABIAY2AhggAygCECICBEAgASACNgIQIAIgATYCGAsgAygCFCICRQ0BIAEgAjYCFCACIAE2AhgMAQsgBSgCBCIBQQNxQQNHDQBBkAggADYCACAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAA8LIAMgBU8NACAFKAIEIgFBAXFFDQACQCABQQJxRQRAIAVBoAgoAgBGBEBBoAggAzYCAEGUCEGUCCgCACAAaiIANgIAIAMgAEEBcjYCBCADQZwIKAIARw0DQZAIQQA2AgBBnAhBADYCAA8LIAVBnAgoAgBGBEBBnAggAzYCAEGQCEGQCCgCACAAaiIANgIAIAMgAEEBcjYCBCAAIANqIAA2AgAPCyABQXhxIABqIQACQCABQf8BTQRAIAUoAggiAiABQQN2IgRBA3RBsAhqRhogAiAFKAIMIgFGBEBBiAhBiAgoAgBBfiAEd3E2AgAMAgsgAiABNgIMIAEgAjYCCAwBCyAFKAIYIQYCQCAFIAUoAgwiAUcEQCAFKAIIIgJBmAgoAgBJGiACIAE2AgwgASACNgIIDAELAkAgBUEUaiICKAIAIgQNACAFQRBqIgIoAgAiBA0AQQAhAQwBCwNAIAIhByAEIgFBFGoiAigCACIEDQAgAUEQaiECIAEoAhAiBA0ACyAHQQA2AgALIAZFDQACQCAFIAUoAhwiAkECdEG4CmoiBCgCAEYEQCAEIAE2AgAgAQ0BQYwIQYwIKAIAQX4gAndxNgIADAILIAZBEEEUIAYoAhAgBUYbaiABNgIAIAFFDQELIAEgBjYCGCAFKAIQIgIEQCABIAI2AhAgAiABNgIYCyAFKAIUIgJFDQAgASACNgIUIAIgATYCGAsgAyAAQQFyNgIEIAAgA2ogADYCACADQZwIKAIARw0BQZAIIAA2AgAPCyAFIAFBfnE2AgQgAyAAQQFyNgIEIAAgA2ogADYCAAsgAEH/AU0EQCAAQQN2IgFBA3RBsAhqIQACf0GICCgCACICQQEgAXQiAXFFBEBBiAggASACcjYCACAADAELIAAoAggLIQIgACADNgIIIAIgAzYCDCADIAA2AgwgAyACNgIIDwtBHyECIANCADcCECAAQf///wdNBEAgAEEIdiIBIAFBgP4/akEQdkEIcSIBdCICIAJBgOAfakEQdkEEcSICdCIEIARBgIAPakEQdkECcSIEdEEPdiABIAJyIARyayIBQQF0IAAgAUEVanZBAXFyQRxqIQILIAMgAjYCHCACQQJ0QbgKaiEBAkACQAJAQYwIKAIAIgRBASACdCIHcUUEQEGMCCAEIAdyNgIAIAEgAzYCACADIAE2AhgMAQsgAEEAQRkgAkEBdmsgAkEfRht0IQIgASgCACEBA0AgASIEKAIEQXhxIABGDQIgAkEddiEBIAJBAXQhAiAEIAFBBHFqIgdBEGooAgAiAQ0ACyAHIAM2AhAgAyAENgIYCyADIAM2AgwgAyADNgIIDAELIAQoAggiACADNgIMIAQgAzYCCCADQQA2AhggAyAENgIMIAMgADYCCAtBqAhBqAgoAgBBAWsiAEF/IAAbNgIACwsLCQEAQYEICwIGUA==",!Ye.startsWith(Ne)){var Qe=Ye;Ye=e.locateFile?e.locateFile(Qe,h):h+Qe}function St(){var W=Ye;try{if(W==Ye&&x)return new Uint8Array(x);var se=Cn(W);if(se)return se;if(p)return p(W);throw"both async and sync fetching of the wasm failed"}catch(be){pe(be)}}function ki(){if(!x&&(f||a)){if(typeof fetch=="function"&&!Ye.startsWith("file://"))return fetch(Ye,{credentials:"same-origin"}).then(function(W){if(!W.ok)throw"failed to load wasm binary file at '"+Ye+"'";return W.arrayBuffer()}).catch(function(){return St()});if(A)return new Promise(function(W,se){A(Ye,function(be){W(new Uint8Array(be))},se)})}return Promise.resolve().then(function(){return St()})}function Yr(W){for(;0<W.length;){var se=W.shift();if(typeof se=="function")se(e);else{var be=se.m;typeof be=="number"?se.l===void 0?ne.get(be)():ne.get(be)(se.l):be(se.l===void 0?null:se.l)}}}var hr=!1,dr=typeof atob=="function"?atob:function(W){var se="",be=0;W=W.replace(/[^A-Za-z0-9\+\/=]/g,"");do{var ve="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(W.charAt(be++)),ze="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(W.charAt(be++)),mt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(W.charAt(be++)),pn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(W.charAt(be++));ve=ve<<2|ze>>4,ze=(ze&15)<<4|mt>>2;var Jt=(mt&3)<<6|pn;se+=String.fromCharCode(ve),mt!==64&&(se+=String.fromCharCode(ze)),pn!==64&&(se+=String.fromCharCode(Jt))}while(be<W.length);return se};function Cn(W){if(W.startsWith(Ne)){if(W=W.slice(Ne.length),typeof u=="boolean"&&u){var se=Buffer.from(W,"base64");se=new Uint8Array(se.buffer,se.byteOffset,se.byteLength)}else try{var be=dr(W),ve=new Uint8Array(be.length);for(W=0;W<be.length;++W)ve[W]=be.charCodeAt(W);se=ve}catch{throw Error("Converting base64 string to bytes failed.")}return se}}var Ar={a:function(W){var se=F.length;if(W>>>=0,2147483648<W)return!1;for(var be=1;4>=be;be*=2){var ve=se*(1+.2/be);ve=Math.min(ve,W+100663296),ve=Math.max(W,ve),0<ve%65536&&(ve+=65536-ve%65536);e:{try{X.grow(Math.min(2147483648,ve)-C.byteLength+65535>>>16),D();var ze=1;break e}catch{}ze=void 0}if(ze)return!0}return!1}};(function(){function W(ze){e.asm=ze.exports,X=e.asm.b,D(),ne=e.asm.j,ie.unshift(e.asm.c),k--,e.monitorRunDependencies&&e.monitorRunDependencies(k),k==0&&($!==null&&(clearInterval($),$=null),K&&(ze=K,K=null,ze()))}function se(ze){W(ze.instance)}function be(ze){return ki().then(function(mt){return WebAssembly.instantiate(mt,ve)}).then(ze,function(mt){v("failed to asynchronously prepare wasm: "+mt),pe(mt)})}var ve={a:Ar};if(k++,e.monitorRunDependencies&&e.monitorRunDependencies(k),e.instantiateWasm)try{return e.instantiateWasm(ve,W)}catch(ze){return v("Module.instantiateWasm callback failed with error: "+ze),!1}return function(){return x||typeof WebAssembly.instantiateStreaming!="function"||Ye.startsWith(Ne)||Ye.startsWith("file://")||typeof fetch!="function"?be(se):fetch(Ye,{credentials:"same-origin"}).then(function(ze){return WebAssembly.instantiateStreaming(ze,ve).then(se,function(mt){return v("wasm streaming compile failed: "+mt),v("falling back to ArrayBuffer instantiation"),be(se)})})}().catch(i),{}})(),e.___wasm_call_ctors=function(){return(e.___wasm_call_ctors=e.asm.c).apply(null,arguments)},e._poly1305_auth=function(){return(e._poly1305_auth=e.asm.d).apply(null,arguments)};var jr=e.stackSave=function(){return(jr=e.stackSave=e.asm.e).apply(null,arguments)},Ti=e.stackRestore=function(){return(Ti=e.stackRestore=e.asm.f).apply(null,arguments)},Xr=e.stackAlloc=function(){return(Xr=e.stackAlloc=e.asm.g).apply(null,arguments)};e._malloc=function(){return(e._malloc=e.asm.h).apply(null,arguments)},e._free=function(){return(e._free=e.asm.i).apply(null,arguments)},e.cwrap=function(W,se,be,ve){be=be||[];var ze=be.every(function(mt){return mt==="number"});return se!=="string"&&ze&&!ve?ce(W):function(){return M(W,se,be,arguments)}};var _r;K=function W(){_r||gr(),_r||(K=W)};function gr(){function W(){if(!_r&&(_r=!0,e.calledRun=!0,!H)){if(Yr(ie),r(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;){var se=e.postRun.shift();ee.unshift(se)}Yr(ee)}}if(!(0<k)){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)w();Yr(re),0<k||(e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),W()},1)):W())}}if(e.run=gr,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);0<e.preInit.length;)e.preInit.pop()();return gr(),t.ready}}();typeof ws=="object"&&typeof Yo=="object"?Yo.exports=$o:typeof define=="function"&&define.amd?define([],function(){return $o}):typeof ws=="object"&&(ws.createPoly1305=$o)});var fr=_e((xb,yu)=>{"use strict";var{createCipheriv:Tr,createDecipheriv:Ss,createHmac:jo,randomFillSync:ar,timingSafeEqual:Xo}=require("crypto"),{readUInt32BE:fi,writeUInt32BE:en}=An(),$n=Buffer[Symbol.species],Eu=2**32-1,pu=Buffer.alloc(0),kr=Buffer.alloc(4),ms=new Map,cr=35e3,Vo,hf,df,Af,_f,gf,Ef;try{Vo=require("./sshcrypto-RUFUXFID.node"),{AESGCMCipher:hf,ChaChaPolyCipher:df,GenericCipher:Af,AESGCMDecipher:_f,ChaChaPolyDecipher:gf,GenericDecipher:Ef}=Vo}catch{}var Lt=1<<0,s_=(()=>{function n(t,e,r,i,s,o,f){return{sslName:t,blockLen:e,keyLen:r,ivLen:i!==0||f&Lt?i:e,authLen:s,discardLen:o,stream:!!(f&Lt)}}return{"chacha20-poly1305@openssh.com":n("chacha20",8,64,0,16,0,Lt),"aes128-gcm":n("aes-128-gcm",16,16,12,16,0,Lt),"aes256-gcm":n("aes-256-gcm",16,32,12,16,0,Lt),"aes128-gcm@openssh.com":n("aes-128-gcm",16,16,12,16,0,Lt),"aes256-gcm@openssh.com":n("aes-256-gcm",16,32,12,16,0,Lt),"aes128-cbc":n("aes-128-cbc",16,16,0,0,0,0),"aes192-cbc":n("aes-192-cbc",16,24,0,0,0,0),"aes256-cbc":n("aes-256-cbc",16,32,0,0,0,0),"rijndael-cbc@lysator.liu.se":n("aes-256-cbc",16,32,0,0,0,0),"3des-cbc":n("des-ede3-cbc",8,24,0,0,0,0),"blowfish-cbc":n("bf-cbc",8,16,0,0,0,0),"idea-cbc":n("idea-cbc",8,16,0,0,0,0),"cast128-cbc":n("cast-cbc",8,16,0,0,0,0),"aes128-ctr":n("aes-128-ctr",16,16,16,0,0,Lt),"aes192-ctr":n("aes-192-ctr",16,24,16,0,0,Lt),"aes256-ctr":n("aes-256-ctr",16,32,16,0,0,Lt),"3des-ctr":n("des-ede3",8,24,8,0,0,Lt),"blowfish-ctr":n("bf-ecb",8,16,8,0,0,Lt),"cast128-ctr":n("cast5-ecb",8,16,8,0,0,Lt),arcfour:n("rc4",8,16,0,0,1536,Lt),arcfour128:n("rc4",8,16,0,0,1536,Lt),arcfour256:n("rc4",8,32,0,0,1536,Lt),arcfour512:n("rc4",8,64,0,0,1536,Lt)}})(),o_=(()=>{function n(t,e,r,i){return{sslName:t,len:e,actualLen:r,isETM:i}}return{"hmac-md5":n("md5",16,16,!1),"hmac-md5-96":n("md5",16,12,!1),"hmac-ripemd160":n("ripemd160",20,20,!1),"hmac-sha1":n("sha1",20,20,!1),"hmac-sha1-etm@openssh.com":n("sha1",20,20,!0),"hmac-sha1-96":n("sha1",20,12,!1),"hmac-sha2-256":n("sha256",32,32,!1),"hmac-sha2-256-etm@openssh.com":n("sha256",32,32,!0),"hmac-sha2-256-96":n("sha256",32,12,!1),"hmac-sha2-512":n("sha512",64,64,!1),"hmac-sha2-512-etm@openssh.com":n("sha512",64,64,!0),"hmac-sha2-512-96":n("sha512",64,12,!1)}})(),zo=class{constructor(t,e){this.outSeqno=t,this._onWrite=e,this._dead=!1}free(){this._dead=!0}allocPacket(t){let e=5+t,r=8-(e&8-1);r<4&&(r+=8),e+=r;let i=Buffer.allocUnsafe(e);return en(i,e-4,0),i[4]=r,ar(i,5+t,r),i}encrypt(t){this._dead||(this._onWrite(t),this.outSeqno=this.outSeqno+1>>>0)}},bu=Buffer.alloc(32),Yt=Buffer.alloc(16),oi,ai,pf,Jo=class{constructor(t){let e=t.outbound;this.outSeqno=e.seqno,this._onWrite=e.onWrite,this._encKeyMain=e.cipherKey.slice(0,32),this._encKeyPktLen=e.cipherKey.slice(32),this._dead=!1}free(){this._dead=!0}allocPacket(t){let e=5+t,r=8-(e-4&8-1);r<4&&(r+=8),e+=r;let i=Buffer.allocUnsafe(e);return en(i,e-4,0),i[4]=r,ar(i,5+t,r),i}encrypt(t){if(this._dead)return;Yt[0]=0,en(Yt,this.outSeqno,12);let e=Tr("chacha20",this._encKeyMain,Yt).update(bu),r=Tr("chacha20",this._encKeyPktLen,Yt).update(t.slice(0,4));this._onWrite(r),Yt[0]=1;let i=Tr("chacha20",this._encKeyMain,Yt).update(t.slice(4));this._onWrite(i),pf(ai,r,r.length,i,i.length,e);let s=Buffer.allocUnsafe(16);s.set(new Uint8Array(oi.HEAPU8.buffer,ai,16),0),this._onWrite(s),this.outSeqno=this.outSeqno+1>>>0}},Zo=class{constructor(t){let e=t.outbound;this.outSeqno=e.seqno,this._onWrite=e.onWrite,this._instance=new df(e.cipherKey),this._dead=!1}free(){this._dead=!0,this._instance.free()}allocPacket(t){let e=5+t,r=8-(e-4&8-1);r<4&&(r+=8),e+=r;let i=Buffer.allocUnsafe(e+16);return en(i,e-4,0),i[4]=r,ar(i,5+t,r),i}encrypt(t){this._dead||(this._instance.encrypt(t,this.outSeqno),this._onWrite(t),this.outSeqno=this.outSeqno+1>>>0)}},ef=class{constructor(t){let e=t.outbound;this.outSeqno=e.seqno,this._onWrite=e.onWrite,this._encSSLName=e.cipherInfo.sslName,this._encKey=e.cipherKey,this._encIV=e.cipherIV,this._dead=!1}free(){this._dead=!0}allocPacket(t){let e=5+t,r=16-(e-4&16-1);r<4&&(r+=16),e+=r;let i=Buffer.allocUnsafe(e);return en(i,e-4,0),i[4]=r,ar(i,5+t,r),i}encrypt(t){if(this._dead)return;let e=Tr(this._encSSLName,this._encKey,this._encIV);e.setAutoPadding(!1);let r=t.slice(0,4);e.setAAD(r),this._onWrite(r);let i=e.update(t.slice(4));this._onWrite(i);let s=e.final();s.length&&this._onWrite(s);let o=e.getAuthTag();this._onWrite(o),Iu(this._encIV),this.outSeqno=this.outSeqno+1>>>0}},tf=class{constructor(t){let e=t.outbound;this.outSeqno=e.seqno,this._onWrite=e.onWrite,this._instance=new hf(e.cipherInfo.sslName,e.cipherKey,e.cipherIV),this._dead=!1}free(){this._dead=!0,this._instance.free()}allocPacket(t){let e=5+t,r=16-(e-4&16-1);r<4&&(r+=16),e+=r;let i=Buffer.allocUnsafe(e+16);return en(i,e-4,0),i[4]=r,ar(i,5+t,r),i}encrypt(t){this._dead||(this._instance.encrypt(t),this._onWrite(t),this.outSeqno=this.outSeqno+1>>>0)}},nf=class{constructor(t){let e=t.outbound;this.outSeqno=e.seqno,this._onWrite=e.onWrite,this._encBlockLen=e.cipherInfo.blockLen,this._cipherInstance=Tr(e.cipherInfo.sslName,e.cipherKey,e.cipherIV),this._macSSLName=e.macInfo.sslName,this._macKey=e.macKey,this._macActualLen=e.macInfo.actualLen,this._macETM=e.macInfo.isETM,this._aadLen=this._macETM?4:0,this._dead=!1;let r=e.cipherInfo.discardLen;if(r){let i=ms.get(r);i===void 0&&(i=Buffer.alloc(r),ms.set(r,i)),this._cipherInstance.update(i)}}free(){this._dead=!0}allocPacket(t){let e=this._encBlockLen,r=4+1+t,i=e-(r-this._aadLen&e-1);i<4&&(i+=e),r+=i;let s=Buffer.allocUnsafe(r);return en(s,r-4,0),s[4]=i,ar(s,5+t,i),s}encrypt(t){if(this._dead)return;let e;if(this._macETM){let i=new Uint8Array(t.buffer,t.byteOffset,4),s=this._cipherInstance.update(new Uint8Array(t.buffer,t.byteOffset+4,t.length-4));this._onWrite(i),this._onWrite(s),e=jo(this._macSSLName,this._macKey),en(kr,this.outSeqno,0),e.update(kr),e.update(i),e.update(s)}else{let i=this._cipherInstance.update(t);this._onWrite(i),e=jo(this._macSSLName,this._macKey),en(kr,this.outSeqno,0),e.update(kr),e.update(t)}let r=e.digest();r.length>this._macActualLen&&(r=r.slice(0,this._macActualLen)),this._onWrite(r),this.outSeqno=this.outSeqno+1>>>0}},rf=class{constructor(t){let e=t.outbound;this.outSeqno=e.seqno,this._onWrite=e.onWrite,this._encBlockLen=e.cipherInfo.blockLen,this._macLen=e.macInfo.len,this._macActualLen=e.macInfo.actualLen,this._aadLen=e.macInfo.isETM?4:0,this._instance=new Af(e.cipherInfo.sslName,e.cipherKey,e.cipherIV,e.macInfo.sslName,e.macKey,e.macInfo.isETM),this._dead=!1}free(){this._dead=!0,this._instance.free()}allocPacket(t){let e=this._encBlockLen,r=4+1+t,i=e-(r-this._aadLen&e-1);i<4&&(i+=e),r+=i;let s=Buffer.allocUnsafe(r+this._macLen);return en(s,r-4,0),s[4]=i,ar(s,5+t,i),s}encrypt(t){this._dead||(this._instance.encrypt(t,this.outSeqno),this._macActualLen<this._macLen&&(t=new $n(t.buffer,t.byteOffset,t.length-(this._macLen-this._macActualLen))),this._onWrite(t),this.outSeqno=this.outSeqno+1>>>0)}},sf=class{constructor(t,e){this.inSeqno=t,this._onPayload=e,this._len=0,this._lenBytes=0,this._packet=null,this._packetPos=0}free(){}decrypt(t,e,r){for(;e<r;){if(this._lenBytes<4){let s=Math.min(4-this._lenBytes,r-e);for(this._lenBytes+=s;s--;)this._len=(this._len<<8)+t[e++];if(this._lenBytes<4)return;if(this._len>cr||this._len<8||(4+this._len&7)!==0)throw new Error("Bad packet length");if(e>=r)return}if(this._packetPos<this._len){let s=Math.min(this._len-this._packetPos,r-e),o;if(e!==0||s!==r?o=new Uint8Array(t.buffer,t.byteOffset+e,s):o=t,s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._packetPos)),e+=s,this._packetPos+=s,this._packetPos<this._len)return}let i=this._packet?new $n(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1):pu;this.inSeqno=this.inSeqno+1>>>0,this._len=0,this._lenBytes=0,this._packet=null,this._packetPos=0;{let s=this._onPayload(i);if(s!==void 0)return s===!1?e:s}}}},of=class{constructor(t){let e=t.inbound;this.inSeqno=e.seqno,this._onPayload=e.onPayload,this._decKeyMain=e.decipherKey.slice(0,32),this._decKeyPktLen=e.decipherKey.slice(32),this._len=0,this._lenBuf=Buffer.alloc(4),this._lenPos=0,this._packet=null,this._pktLen=0,this._mac=Buffer.allocUnsafe(16),this._calcMac=Buffer.allocUnsafe(16),this._macPos=0}free(){}decrypt(t,e,r){for(;e<r;){if(this._lenPos<4){let f=Math.min(4-this._lenPos,r-e);for(;f--;)this._lenBuf[this._lenPos++]=t[e++];if(this._lenPos<4)return;Yt[0]=0,en(Yt,this.inSeqno,12);let a=Ss("chacha20",this._decKeyPktLen,Yt).update(this._lenBuf);if(this._len=fi(a,0),this._len>cr||this._len<8||(this._len&7)!==0)throw new Error("Bad packet length")}if(this._pktLen<this._len){if(e>=r)return;let f=Math.min(this._len-this._pktLen,r-e),a;if(e!==0||f!==r?a=new Uint8Array(t.buffer,t.byteOffset+e,f):a=t,f===this._len?this._packet=a:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(a,this._pktLen)),e+=f,this._pktLen+=f,this._pktLen<this._len||e>=r)return}{let f=Math.min(16-this._macPos,r-e);if(e!==0||f!==r?this._mac.set(new Uint8Array(t.buffer,t.byteOffset+e,f),this._macPos):this._mac.set(t,this._macPos),e+=f,this._macPos+=f,this._macPos<16)return}Yt[0]=0,en(Yt,this.inSeqno,12);let i=Tr("chacha20",this._decKeyMain,Yt).update(bu);if(pf(ai,this._lenBuf,4,this._packet,this._packet.length,i),this._calcMac.set(new Uint8Array(oi.HEAPU8.buffer,ai,16),0),!Xo(this._calcMac,this._mac))throw new Error("Invalid MAC");Yt[0]=1;let s=Ss("chacha20",this._decKeyMain,Yt).update(this._packet),o=new $n(s.buffer,s.byteOffset+1,s.length-s[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._len=0,this._lenPos=0,this._packet=null,this._pktLen=0,this._macPos=0;{let f=this._onPayload(o);if(f!==void 0)return f===!1?e:f}}}},ff=class{constructor(t){let e=t.inbound;this.inSeqno=e.seqno,this._onPayload=e.onPayload,this._instance=new gf(e.decipherKey),this._len=0,this._lenBuf=Buffer.alloc(4),this._lenPos=0,this._packet=null,this._pktLen=0,this._mac=Buffer.allocUnsafe(16),this._macPos=0}free(){this._instance.free()}decrypt(t,e,r){for(;e<r;){if(this._lenPos<4){let s=Math.min(4-this._lenPos,r-e);for(;s--;)this._lenBuf[this._lenPos++]=t[e++];if(this._lenPos<4)return;if(this._len=this._instance.decryptLen(this._lenBuf,this.inSeqno),this._len>cr||this._len<8||(this._len&7)!==0)throw new Error("Bad packet length");if(e>=r)return}if(this._pktLen<this._len){let s=Math.min(this._len-this._pktLen,r-e),o;if(e!==0||s!==r?o=new Uint8Array(t.buffer,t.byteOffset+e,s):o=t,s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._pktLen)),e+=s,this._pktLen+=s,this._pktLen<this._len||e>=r)return}{let s=Math.min(16-this._macPos,r-e);if(e!==0||s!==r?this._mac.set(new Uint8Array(t.buffer,t.byteOffset+e,s),this._macPos):this._mac.set(t,this._macPos),e+=s,this._macPos+=s,this._macPos<16)return}this._instance.decrypt(this._packet,this._mac,this.inSeqno);let i=new $n(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._len=0,this._lenPos=0,this._packet=null,this._pktLen=0,this._macPos=0;{let s=this._onPayload(i);if(s!==void 0)return s===!1?e:s}}}},af=class{constructor(t){let e=t.inbound;this.inSeqno=e.seqno,this._onPayload=e.onPayload,this._decipherInstance=null,this._decipherSSLName=e.decipherInfo.sslName,this._decipherKey=e.decipherKey,this._decipherIV=e.decipherIV,this._len=0,this._lenBytes=0,this._packet=null,this._packetPos=0,this._pktLen=0,this._tag=Buffer.allocUnsafe(16),this._tagPos=0}free(){}decrypt(t,e,r){for(;e<r;){if(this._lenBytes<4){let s=Math.min(4-this._lenBytes,r-e);for(this._lenBytes+=s;s--;)this._len=(this._len<<8)+t[e++];if(this._lenBytes<4)return;if(this._len+20>cr||this._len<16||(this._len&15)!==0)throw new Error("Bad packet length");this._decipherInstance=Ss(this._decipherSSLName,this._decipherKey,this._decipherIV),this._decipherInstance.setAutoPadding(!1),this._decipherInstance.setAAD(f_(this._len))}if(this._pktLen<this._len){if(e>=r)return;let s=Math.min(this._len-this._pktLen,r-e),o;if(e!==0||s!==r?o=this._decipherInstance.update(new Uint8Array(t.buffer,t.byteOffset+e,s)):o=this._decipherInstance.update(t),o.length&&(s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._packetPos)),this._packetPos+=o.length),e+=s,this._pktLen+=s,this._pktLen<this._len||e>=r)return}{let s=Math.min(16-this._tagPos,r-e);if(e!==0||s!==r?this._tag.set(new Uint8Array(t.buffer,t.byteOffset+e,s),this._tagPos):this._tag.set(t,this._tagPos),e+=s,this._tagPos+=s,this._tagPos<16)return}{this._decipherInstance.setAuthTag(this._tag);let s=this._decipherInstance.final();s.length&&(this._packet?this._packet.set(s,this._packetPos):this._packet=s)}let i=this._packet?new $n(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1):pu;this.inSeqno=this.inSeqno+1>>>0,Iu(this._decipherIV),this._len=0,this._lenBytes=0,this._packet=null,this._packetPos=0,this._pktLen=0,this._tagPos=0;{let s=this._onPayload(i);if(s!==void 0)return s===!1?e:s}}}},cf=class{constructor(t){let e=t.inbound;this.inSeqno=e.seqno,this._onPayload=e.onPayload,this._instance=new _f(e.decipherInfo.sslName,e.decipherKey,e.decipherIV),this._len=0,this._lenBytes=0,this._packet=null,this._pktLen=0,this._tag=Buffer.allocUnsafe(16),this._tagPos=0}free(){}decrypt(t,e,r){for(;e<r;){if(this._lenBytes<4){let s=Math.min(4-this._lenBytes,r-e);for(this._lenBytes+=s;s--;)this._len=(this._len<<8)+t[e++];if(this._lenBytes<4)return;if(this._len+20>cr||this._len<16||(this._len&15)!==0)throw new Error(`Bad packet length: ${this._len}`)}if(this._pktLen<this._len){if(e>=r)return;let s=Math.min(this._len-this._pktLen,r-e),o;if(e!==0||s!==r?o=new Uint8Array(t.buffer,t.byteOffset+e,s):o=t,s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._pktLen)),e+=s,this._pktLen+=s,this._pktLen<this._len||e>=r)return}{let s=Math.min(16-this._tagPos,r-e);if(e!==0||s!==r?this._tag.set(new Uint8Array(t.buffer,t.byteOffset+e,s),this._tagPos):this._tag.set(t,this._tagPos),e+=s,this._tagPos+=s,this._tagPos<16)return}this._instance.decrypt(this._packet,this._len,this._tag);let i=new $n(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._len=0,this._lenBytes=0,this._packet=null,this._pktLen=0,this._tagPos=0;{let s=this._onPayload(i);if(s!==void 0)return s===!1?e:s}}}},uf=class{constructor(t){let e=t.inbound;this.inSeqno=e.seqno,this._onPayload=e.onPayload,this._decipherInstance=Ss(e.decipherInfo.sslName,e.decipherKey,e.decipherIV),this._decipherInstance.setAutoPadding(!1),this._block=Buffer.allocUnsafe(e.macInfo.isETM?4:e.decipherInfo.blockLen),this._blockSize=e.decipherInfo.blockLen,this._blockPos=0,this._len=0,this._packet=null,this._packetPos=0,this._pktLen=0,this._mac=Buffer.allocUnsafe(e.macInfo.actualLen),this._macPos=0,this._macSSLName=e.macInfo.sslName,this._macKey=e.macKey,this._macActualLen=e.macInfo.actualLen,this._macETM=e.macInfo.isETM,this._macInstance=null;let r=e.decipherInfo.discardLen;if(r){let i=ms.get(r);i===void 0&&(i=Buffer.alloc(r),ms.set(r,i)),this._decipherInstance.update(i)}}free(){}decrypt(t,e,r){for(;e<r;){if(this._blockPos<this._block.length){let o=Math.min(this._block.length-this._blockPos,r-e);if(e!==0||o!==r||o<t.length?this._block.set(new Uint8Array(t.buffer,t.byteOffset+e,o),this._blockPos):this._block.set(t,this._blockPos),e+=o,this._blockPos+=o,this._blockPos<this._block.length)return;let f,a;if(this._macETM?this._len=a=fi(this._block,0):(f=this._decipherInstance.update(this._block),this._len=fi(f,0),a=4+this._len-this._blockSize),this._len>cr||this._len<5||(a&this._blockSize-1)!==0)throw new Error("Bad packet length");if(this._macInstance=jo(this._macSSLName,this._macKey),en(kr,this.inSeqno,0),this._macInstance.update(kr),this._macETM?this._macInstance.update(this._block):(this._macInstance.update(new Uint8Array(f.buffer,f.byteOffset,4)),this._pktLen=f.length-4,this._packetPos=this._pktLen,this._packet=Buffer.allocUnsafe(this._len),this._packet.set(new Uint8Array(f.buffer,f.byteOffset+4,this._packetPos),0)),e>=r)return}if(this._pktLen<this._len){let o=Math.min(this._len-this._pktLen,r-e),f;e!==0||o!==r?f=new Uint8Array(t.buffer,t.byteOffset+e,o):f=t,this._macETM&&this._macInstance.update(f);let a=this._decipherInstance.update(f);if(a.length&&(o===this._len?this._packet=a:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(a,this._packetPos)),this._packetPos+=a.length),e+=o,this._pktLen+=o,this._pktLen<this._len||e>=r)return}{let o=Math.min(this._macActualLen-this._macPos,r-e);if(e!==0||o!==r?this._mac.set(new Uint8Array(t.buffer,t.byteOffset+e,o),this._macPos):this._mac.set(t,this._macPos),e+=o,this._macPos+=o,this._macPos<this._macActualLen)return}this._macETM||this._macInstance.update(this._packet);let i=this._macInstance.digest();if(this._macActualLen<i.length&&(i=new Uint8Array(i.buffer,i.byteOffset,this._macActualLen)),!a_(i,this._mac))throw new Error("Invalid MAC");let s=new $n(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._blockPos=0,this._len=0,this._packet=null,this._packetPos=0,this._pktLen=0,this._macPos=0,this._macInstance=null;{let o=this._onPayload(s);if(o!==void 0)return o===!1?e:o}}}},lf=class{constructor(t){let e=t.inbound;this.inSeqno=e.seqno,this._onPayload=e.onPayload,this._instance=new Ef(e.decipherInfo.sslName,e.decipherKey,e.decipherIV,e.macInfo.sslName,e.macKey,e.macInfo.isETM,e.macInfo.actualLen),this._block=Buffer.allocUnsafe(e.macInfo.isETM||e.decipherInfo.stream?4:e.decipherInfo.blockLen),this._blockPos=0,this._len=0,this._packet=null,this._pktLen=0,this._mac=Buffer.allocUnsafe(e.macInfo.actualLen),this._macPos=0,this._macActualLen=e.macInfo.actualLen,this._macETM=e.macInfo.isETM}free(){this._instance.free()}decrypt(t,e,r){for(;e<r;){if(this._blockPos<this._block.length){let s=Math.min(this._block.length-this._blockPos,r-e);if(e!==0||s!==r||s<t.length?this._block.set(new Uint8Array(t.buffer,t.byteOffset+e,s),this._blockPos):this._block.set(t,this._blockPos),e+=s,this._blockPos+=s,this._blockPos<this._block.length)return;let o;if(this._macETM?this._len=o=fi(this._block,0):(this._instance.decryptBlock(this._block),this._len=fi(this._block,0),o=4+this._len-this._block.length),this._len>cr||this._len<5||(o&this._block.length-1)!==0)throw new Error("Bad packet length");if(this._macETM||(this._pktLen=this._block.length-4,this._pktLen&&(this._packet=Buffer.allocUnsafe(this._len),this._packet.set(new Uint8Array(this._block.buffer,this._block.byteOffset+4,this._pktLen),0))),e>=r)return}if(this._pktLen<this._len){let s=Math.min(this._len-this._pktLen,r-e),o;if(e!==0||s!==r?o=new Uint8Array(t.buffer,t.byteOffset+e,s):o=t,s===this._len?this._packet=o:(this._packet||(this._packet=Buffer.allocUnsafe(this._len)),this._packet.set(o,this._pktLen)),e+=s,this._pktLen+=s,this._pktLen<this._len||e>=r)return}{let s=Math.min(this._macActualLen-this._macPos,r-e);if(e!==0||s!==r?this._mac.set(new Uint8Array(t.buffer,t.byteOffset+e,s),this._macPos):this._mac.set(t,this._macPos),e+=s,this._macPos+=s,this._macPos<this._macActualLen)return}this._instance.decrypt(this._packet,this.inSeqno,this._block,this._mac);let i=new $n(this._packet.buffer,this._packet.byteOffset+1,this._packet.length-this._packet[0]-1);this.inSeqno=this.inSeqno+1>>>0,this._blockPos=0,this._len=0,this._packet=null,this._pktLen=0,this._macPos=0,this._macInstance=null;{let s=this._onPayload(i);if(s!==void 0)return s===!1?e:s}}}};function Iu(n){++n[11]>>>8&&++n[10]>>>8&&++n[9]>>>8&&++n[8]>>>8&&++n[7]>>>8&&++n[6]>>>8&&++n[5]>>>8&&++n[4]>>>8}var f_=(()=>{let n=Buffer.alloc(4);return t=>(n[0]=t>>>24,n[1]=t>>>16,n[2]=t>>>8,n[3]=t,n)})();function a_(n,t){return n.length!==t.length?(Xo(n,n),!1):Xo(n,t)}function c_(n){if(typeof n!="object"||n===null)throw new Error("Invalid config");if(typeof n.outbound!="object"||n.outbound===null)throw new Error("Invalid outbound");let t=n.outbound;if(typeof t.onWrite!="function")throw new Error("Invalid outbound.onWrite");if(typeof t.cipherInfo!="object"||t.cipherInfo===null)throw new Error("Invalid outbound.cipherInfo");if(!Buffer.isBuffer(t.cipherKey)||t.cipherKey.length!==t.cipherInfo.keyLen)throw new Error("Invalid outbound.cipherKey");if(t.cipherInfo.ivLen&&(!Buffer.isBuffer(t.cipherIV)||t.cipherIV.length!==t.cipherInfo.ivLen))throw new Error("Invalid outbound.cipherIV");if(typeof t.seqno!="number"||t.seqno<0||t.seqno>Eu)throw new Error("Invalid outbound.seqno");let e=!!t.forceNative;switch(t.cipherInfo.sslName){case"aes-128-gcm":case"aes-256-gcm":return hf&&!e?new tf(n):new ef(n);case"chacha20":return df&&!e?new Zo(n):new Jo(n);default:{if(typeof t.macInfo!="object"||t.macInfo===null)throw new Error("Invalid outbound.macInfo");if(!Buffer.isBuffer(t.macKey)||t.macKey.length!==t.macInfo.len)throw new Error("Invalid outbound.macKey");return Af&&!e?new rf(n):new nf(n)}}}function u_(n){if(typeof n!="object"||n===null)throw new Error("Invalid config");if(typeof n.inbound!="object"||n.inbound===null)throw new Error("Invalid inbound");let t=n.inbound;if(typeof t.onPayload!="function")throw new Error("Invalid inbound.onPayload");if(typeof t.decipherInfo!="object"||t.decipherInfo===null)throw new Error("Invalid inbound.decipherInfo");if(!Buffer.isBuffer(t.decipherKey)||t.decipherKey.length!==t.decipherInfo.keyLen)throw new Error("Invalid inbound.decipherKey");if(t.decipherInfo.ivLen&&(!Buffer.isBuffer(t.decipherIV)||t.decipherIV.length!==t.decipherInfo.ivLen))throw new Error("Invalid inbound.decipherIV");if(typeof t.seqno!="number"||t.seqno<0||t.seqno>Eu)throw new Error("Invalid inbound.seqno");let e=!!t.forceNative;switch(t.decipherInfo.sslName){case"aes-128-gcm":case"aes-256-gcm":return _f&&!e?new cf(n):new af(n);case"chacha20":return gf&&!e?new ff(n):new of(n);default:{if(typeof t.macInfo!="object"||t.macInfo===null)throw new Error("Invalid inbound.macInfo");if(!Buffer.isBuffer(t.macKey)||t.macKey.length!==t.macInfo.len)throw new Error("Invalid inbound.macKey");return Ef&&!e?new lf(n):new uf(n)}}}yu.exports={CIPHER_INFO:s_,MAC_INFO:o_,bindingAvailable:!!Vo,init:(()=>new Promise(async(n,t)=>{try{oi=await gu()(),ai=oi._malloc(16),pf=oi.cwrap("poly1305_auth",null,["number","array","number","array","number","array"])}catch(e){return t(e)}n()}))(),NullCipher:zo,createCipher:c_,NullDecipher:sf,createDecipher:u_}});var jn=_e((wb,ku)=>{"use strict";var{createDecipheriv:If,createECDH:l_,createHash:ui,createHmac:h_,createSign:d_,createVerify:A_,getCiphers:__,sign:xu,verify:wu}=require("crypto"),g_=__(),{Ber:Ce}=_s(),E_=nu().pbkdf,{CIPHER_INFO:li}=fr(),{eddsaSupported:yf,SUPPORTED_CIPHER:p_}=Ln(),{bufferSlice:ur,makeBufferParser:b_,readString:me,readUInt32BE:ci,writeUInt32BE:kt}=An(),Pn=Symbol("Hash Algorithm"),_n=Symbol("Private key PEM"),wn=Symbol("Public key PEM"),Yn=Symbol("Public key SSH"),Or=Symbol("Decrypted Key"),bf=Object.create(null);{let n=Object.keys(li);for(let t=0;t<n.length;++t){let e=li[n[t]].sslName;!e||bf[e]||(bf[e]=li[n[t]])}}var Cs=b_();function gn(n,t){t=t.base64Slice(0,t.length);let e=t.replace(/.{64}/g,`$&
`);return t.length&63&&(e+=`
`),`-----BEGIN ${n} KEY-----
${e}-----END ${n} KEY-----`}function hi(n,t){let e=Buffer.allocUnsafe(n.length+t.length);return e.set(n,0),e.set(t,n.length),e}function xf(n,t){let e=n.length,r=n._pos||0;for(let i=0;i<t;++i){let s=e-r;if(r>=e||s<4)return!1;let o=ci(n,r);if(s<4+o)return!1;r+=4+o}return n._pos=r,!0}function di(n,t){let e=new Ce.Writer;return e.startSequence(),e.startSequence(),e.writeOID("1.2.840.113549.1.1.1"),e.writeNull(),e.endSequence(),e.startSequence(Ce.BitString),e.writeByte(0),e.startSequence(),e.writeBuffer(n,Ce.Integer),e.writeBuffer(t,Ce.Integer),e.endSequence(),e.endSequence(),e.endSequence(),gn("PUBLIC",e.buffer)}function Ai(n,t){let e=Buffer.allocUnsafe(15+t.length+4+n.length);kt(e,7,0),e.utf8Write("ssh-rsa",4,7);let r=4+7;return kt(e,t.length,r),e.set(t,r+=4),kt(e,n.length,r+=t.length),e.set(n,r+4),e}var Su=(()=>{function n(r,i,s,o,f,a,u,h){let l=new Ce.Writer;return l.startSequence(),l.writeInt(0,Ce.Integer),l.writeBuffer(r,Ce.Integer),l.writeBuffer(i,Ce.Integer),l.writeBuffer(s,Ce.Integer),l.writeBuffer(o,Ce.Integer),l.writeBuffer(f,Ce.Integer),l.writeBuffer(a,Ce.Integer),l.writeBuffer(u,Ce.Integer),l.writeBuffer(h,Ce.Integer),l.endSequence(),l.buffer}function t(r){return BigInt(`0x${r.hexSlice(0,r.length)}`)}function e(r){let i=r.toString(16);if((i.length&1)!==0)i=`0${i}`;else{let s=i.charCodeAt(0);(s===56||s===57||s>=97&&s<=102)&&(i=`00${i}`)}return Buffer.from(i,"hex")}return function(i,s,o,f,a,u){let h=t(o),l=e(h%(t(a)-1n)),A=e(h%(t(u)-1n));return gn("RSA PRIVATE",n(i,s,o,a,u,l,A,f))}})();function _i(n,t,e,r){let i=new Ce.Writer;return i.startSequence(),i.startSequence(),i.writeOID("1.2.840.10040.4.1"),i.startSequence(),i.writeBuffer(n,Ce.Integer),i.writeBuffer(t,Ce.Integer),i.writeBuffer(e,Ce.Integer),i.endSequence(),i.endSequence(),i.startSequence(Ce.BitString),i.writeByte(0),i.writeBuffer(r,Ce.Integer),i.endSequence(),i.endSequence(),gn("PUBLIC",i.buffer)}function gi(n,t,e,r){let i=Buffer.allocUnsafe(15+n.length+4+t.length+4+e.length+4+r.length);kt(i,7,0),i.utf8Write("ssh-dss",4,7);let s=4+7;return kt(i,n.length,s),i.set(n,s+=4),kt(i,t.length,s+=n.length),i.set(t,s+=4),kt(i,e.length,s+=t.length),i.set(e,s+=4),kt(i,r.length,s+=e.length),i.set(r,s+4),i}function mu(n,t,e,r,i){let s=new Ce.Writer;return s.startSequence(),s.writeInt(0,Ce.Integer),s.writeBuffer(n,Ce.Integer),s.writeBuffer(t,Ce.Integer),s.writeBuffer(e,Ce.Integer),s.writeBuffer(r,Ce.Integer),s.writeBuffer(i,Ce.Integer),s.endSequence(),gn("DSA PRIVATE",s.buffer)}function Cu(n){let t=new Ce.Writer;return t.startSequence(),t.startSequence(),t.writeOID("1.3.101.112"),t.endSequence(),t.startSequence(Ce.BitString),t.writeByte(0),t._ensure(n.length),t._buf.set(n,t._offset),t._offset+=n.length,t.endSequence(),t.endSequence(),gn("PUBLIC",t.buffer)}function Ru(n){let t=Buffer.allocUnsafe(19+n.length);return kt(t,11,0),t.utf8Write("ssh-ed25519",4,11),kt(t,n.length,15),t.set(n,19),t}function I_(n){let t=new Ce.Writer;return t.startSequence(),t.writeInt(0,Ce.Integer),t.startSequence(),t.writeOID("1.3.101.112"),t.endSequence(),t.startSequence(Ce.OctetString),t.writeBuffer(n,Ce.OctetString),t.endSequence(),t.endSequence(),gn("PRIVATE",t.buffer)}function wf(n,t){let e=new Ce.Writer;return e.startSequence(),e.startSequence(),e.writeOID("1.2.840.10045.2.1"),e.writeOID(n),e.endSequence(),e.startSequence(Ce.BitString),e.writeByte(0),e._ensure(t.length),e._buf.set(t,e._offset),e._offset+=t.length,e.endSequence(),e.endSequence(),gn("PUBLIC",e.buffer)}function Sf(n,t){let e;switch(n){case"1.2.840.10045.3.1.7":e="nistp256";break;case"1.3.132.0.34":e="nistp384";break;case"1.3.132.0.35":e="nistp521";break;default:return}let r=Buffer.allocUnsafe(4+19+4+8+4+t.length);return kt(r,19,0),r.utf8Write(`ecdsa-sha2-${e}`,4,19),kt(r,8,23),r.utf8Write(e,27,8),kt(r,t.length,35),r.set(t,39),r}function y_(n,t,e){let r=new Ce.Writer;return r.startSequence(),r.writeInt(1,Ce.Integer),r.writeBuffer(e,Ce.OctetString),r.startSequence(160),r.writeOID(n),r.endSequence(),r.startSequence(161),r.startSequence(Ce.BitString),r.writeByte(0),r._ensure(t.length),r._buf.set(t,r._offset),r._offset+=t.length,r.endSequence(),r.endSequence(),r.endSequence(),gn("EC PRIVATE",r.buffer)}function x_(n,t){let e=l_(n);return e.setPrivateKey(t),e.getPublicKey()}var Ei={sign:(()=>typeof xu=="function"?function(t,e){let r=this[_n];if(r===null)return new Error("No private key available");(!e||typeof e!="string")&&(e=this[Pn]);try{return xu(e,t,r)}catch(i){return i}}:function(t,e){let r=this[_n];if(r===null)return new Error("No private key available");(!e||typeof e!="string")&&(e=this[Pn]);let i=d_(e);i.update(t);try{return i.sign(r)}catch(s){return s}})(),verify:(()=>typeof wu=="function"?function(t,e,r){let i=this[wn];if(i===null)return new Error("No public key available");(!r||typeof r!="string")&&(r=this[Pn]);try{return wu(r,t,i,e)}catch(s){return s}}:function(t,e,r){let i=this[wn];if(i===null)return new Error("No public key available");(!r||typeof r!="string")&&(r=this[Pn]);let s=A_(r);s.update(t);try{return s.verify(i,e)}catch(o){return o}})(),isPrivateKey:function(){return this[_n]!==null},getPrivatePEM:function(){return this[_n]},getPublicPEM:function(){return this[wn]},getPublicSSH:function(){return this[Yn]},equals:function(t){let e=Nu(t);return e instanceof Error?!1:this.type===e.type&&this[_n]===e[_n]&&this[wn]===e[wn]&&this[Yn]===e[Yn]}};function Rs(n,t,e,r,i,s,o){this.type=n,this.comment=t,this[_n]=e,this[wn]=r,this[Yn]=i,this[Pn]=s,this[Or]=o}Rs.prototype=Ei;{let t=function(e,r,i){let s=[];if(e.length<8)return new Error("Malformed OpenSSH private key");let o=ci(e,0),f=ci(e,4);if(o!==f)return i?new Error("OpenSSH key integrity check failed -- bad passphrase?"):new Error("OpenSSH key integrity check failed");e._pos=8;let a,u;for(a=0;a<r;++a){let l,A,p,y,I=me(e,e._pos,!0);if(I===void 0)return new Error("Malformed OpenSSH private key");switch(I){case"ssh-rsa":{let x=me(e,e._pos);if(x===void 0)return new Error("Malformed OpenSSH private key");let O=me(e,e._pos);if(O===void 0)return new Error("Malformed OpenSSH private key");let X=me(e,e._pos);if(X===void 0)return new Error("Malformed OpenSSH private key");let H=me(e,e._pos);if(H===void 0)return new Error("Malformed OpenSSH private key");let te=me(e,e._pos);if(te===void 0)return new Error("Malformed OpenSSH private key");let ce=me(e,e._pos);if(ce===void 0)return new Error("Malformed OpenSSH private key");p=di(x,O),y=Ai(x,O),A=Su(x,O,X,H,te,ce),l="sha1";break}case"ssh-dss":{let x=me(e,e._pos);if(x===void 0)return new Error("Malformed OpenSSH private key");let O=me(e,e._pos);if(O===void 0)return new Error("Malformed OpenSSH private key");let X=me(e,e._pos);if(X===void 0)return new Error("Malformed OpenSSH private key");let H=me(e,e._pos);if(H===void 0)return new Error("Malformed OpenSSH private key");let te=me(e,e._pos);if(te===void 0)return new Error("Malformed OpenSSH private key");p=_i(x,O,X,H),y=gi(x,O,X,H),A=mu(x,O,X,H,te),l="sha1";break}case"ssh-ed25519":{if(!yf)return new Error(`Unsupported OpenSSH private key type: ${I}`);let x=me(e,e._pos);if(x===void 0||x.length!==32)return new Error("Malformed OpenSSH private key");let O=me(e,e._pos);if(O===void 0||O.length!==64)return new Error("Malformed OpenSSH private key");p=Cu(x),y=Ru(x),A=I_(ur(O,0,32)),l=null;break}case"ecdsa-sha2-nistp256":l="sha256",u="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":l===void 0&&(l="sha384",u="1.3.132.0.34");case"ecdsa-sha2-nistp521":{if(l===void 0&&(l="sha512",u="1.3.132.0.35"),!xf(e,1))return new Error("Malformed OpenSSH private key");let x=me(e,e._pos);if(x===void 0)return new Error("Malformed OpenSSH private key");let O=me(e,e._pos);if(O===void 0)return new Error("Malformed OpenSSH private key");p=wf(u,x),y=Sf(u,x),A=y_(u,x,O);break}default:return new Error(`Unsupported OpenSSH private key type: ${I}`)}let v=me(e,e._pos,!0);if(v===void 0)return new Error("Malformed OpenSSH private key");s.push(new Rs(I,v,A,p,y,l,i))}let h=0;for(a=e._pos;a<e.length;++a)if(e[a]!==++h%255)return new Error("Malformed OpenSSH private key");return s},n=/^-----BEGIN OPENSSH PRIVATE KEY-----(?:\r\n|\n)([\s\S]+)(?:\r\n|\n)-----END OPENSSH PRIVATE KEY-----$/;Rs.parse=(e,r)=>{let i=n.exec(e);if(i===null)return null;let s,o=Buffer.from(i[1],"base64");if(o.length<31)return new Error("Malformed OpenSSH private key");let f=o.utf8Slice(0,15);if(f!=="openssh-key-v1\0")return new Error(`Unsupported OpenSSH key magic: ${f}`);let a=me(o,15,!0);if(a===void 0)return new Error("Malformed OpenSSH private key");if(a!=="none"&&p_.indexOf(a)===-1)return new Error(`Unsupported cipher for OpenSSH key: ${a}`);let u=me(o,o._pos,!0);if(u===void 0)return new Error("Malformed OpenSSH private key");if(u!=="none"){if(a==="none")return new Error("Malformed OpenSSH private key");if(u!=="bcrypt")return new Error(`Unsupported kdf name for OpenSSH key: ${u}`);if(!r)return new Error("Encrypted private OpenSSH key detected, but no passphrase given")}else if(a!=="none")return new Error("Malformed OpenSSH private key");let h,l,A;a!=="none"&&(h=li[a]);let p=me(o,o._pos);if(p===void 0)return new Error("Malformed OpenSSH private key");if(p.length)switch(u){case"none":return new Error("Malformed OpenSSH private key");case"bcrypt":let I=me(p,0);if(I===void 0||p._pos+4>p.length)return new Error("Malformed OpenSSH private key");let v=ci(p,p._pos),x=Buffer.allocUnsafe(h.keyLen+h.ivLen);if(E_(r,r.length,I,I.length,x,x.length,v)!==0)return new Error("Failed to generate information to decrypt key");l=ur(x,0,h.keyLen),A=ur(x,h.keyLen,x.length);break}else if(u!=="none")return new Error("Malformed OpenSSH private key");if(o._pos+3>=o.length)return new Error("Malformed OpenSSH private key");let y=ci(o,o._pos);if(o._pos+=4,y>0){for(let v=0;v<y;++v){let x=me(o,o._pos);if(x===void 0)return new Error("Malformed OpenSSH private key");if(me(x,0,!0)===void 0)return new Error("Malformed OpenSSH private key")}let I=me(o,o._pos);if(I===void 0)return new Error("Malformed OpenSSH private key");if(l!==void 0){if(I.length<h.blockLen||I.length%h.blockLen!==0)return new Error("Malformed OpenSSH private key");try{let v={authTagLength:h.authLen},x=If(h.sslName,l,A,v);if(h.authLen>0){if(o.length-o._pos<h.authLen)return new Error("Malformed OpenSSH private key");x.setAuthTag(ur(o,o._pos,o._pos+=h.authLen))}I=hi(x.update(I),x.final())}catch(v){return v}}if(o._pos!==o.length)return new Error("Malformed OpenSSH private key");s=t(I,y,l!==void 0)}else s=[];return s instanceof Error?s:s[0]}}function Bs(n,t,e,r,i,s,o){this.type=n,this.comment=t,this[_n]=e,this[wn]=r,this[Yn]=i,this[Pn]=s,this[Or]=o}Bs.prototype=Ei;{let n=/^-----BEGIN (RSA|DSA|EC) PRIVATE KEY-----(?:\r\n|\n)((?:[^:]+:\s*[\S].*(?:\r\n|\n))*)([\s\S]+)(?:\r\n|\n)-----END (RSA|DSA|EC) PRIVATE KEY-----$/;Bs.parse=(t,e)=>{let r=n.exec(t);if(r===null)return null;let i=Buffer.from(r[3],"base64"),s=r[2],o=!1;if(s!==void 0){s=s.split(/\r\n|\n/g);for(let y=0;y<s.length;++y){let I=s[y],v=I.indexOf(":");if(I.slice(0,v)==="DEK-Info"){let x=I.slice(v+2);if(v=x.indexOf(","),v===-1)continue;let O=x.slice(0,v).toLowerCase();if(g_.indexOf(O)===-1)return new Error(`Cipher (${O}) not supported for encrypted OpenSSH private key`);let X=bf[O];if(!X)return new Error(`Cipher (${O}) not supported for encrypted OpenSSH private key`);let H=Buffer.from(x.slice(v+1),"hex");if(H.length!==X.ivLen)return new Error("Malformed encrypted OpenSSH private key");if(!e)return new Error("Encrypted OpenSSH private key detected, but no passphrase given");let te=ur(H,0,8),ce=ui("md5").update(e).update(te).digest();for(;ce.length<X.keyLen;)ce=hi(ce,ui("md5").update(ce).update(e).update(te).digest());ce.length>X.keyLen&&(ce=ur(ce,0,X.keyLen));try{let M=If(O,ce,H);M.setAutoPadding(!1),i=hi(M.update(i),M.final()),o=!0}catch(M){return M}}}}let f,a,u,h,l,A,p="Malformed OpenSSH private key";switch(o&&(p+=". Bad passphrase?"),r[1]){case"RSA":f="ssh-rsa",a=gn("RSA PRIVATE",i);try{A=new Ce.Reader(i),A.readSequence(),A.readInt();let O=A.readString(Ce.Integer,!0);if(O===null)return new Error(p);let X=A.readString(Ce.Integer,!0);if(X===null)return new Error(p);u=di(O,X),h=Ai(O,X)}catch{return new Error(p)}l="sha1";break;case"DSA":f="ssh-dss",a=gn("DSA PRIVATE",i);try{A=new Ce.Reader(i),A.readSequence(),A.readInt();let O=A.readString(Ce.Integer,!0);if(O===null)return new Error(p);let X=A.readString(Ce.Integer,!0);if(X===null)return new Error(p);let H=A.readString(Ce.Integer,!0);if(H===null)return new Error(p);let te=A.readString(Ce.Integer,!0);if(te===null)return new Error(p);u=_i(O,X,H,te),h=gi(O,X,H,te)}catch{return new Error(p)}l="sha1";break;case"EC":let y,I,v;try{A=new Ce.Reader(i),A.readSequence(),A.readInt(),I=A.readString(Ce.OctetString,!0),A.readByte();let O=A.readLength();if(O!==null){if(A._offset=O,v=A.readOID(),v===null)return new Error(p);switch(v){case"1.2.840.10045.3.1.7":y="prime256v1",f="ecdsa-sha2-nistp256",l="sha256";break;case"1.3.132.0.34":y="secp384r1",f="ecdsa-sha2-nistp384",l="sha384";break;case"1.3.132.0.35":y="secp521r1",f="ecdsa-sha2-nistp521",l="sha512";break;default:return new Error(`Unsupported private key EC OID: ${v}`)}}else return new Error(p)}catch{return new Error(p)}a=gn("EC PRIVATE",i);let x=x_(y,I);u=wf(v,x),h=Sf(v,x);break}return new Bs(f,"",a,u,h,l,o)}}function vs(n,t,e,r,i,s,o){this.type=n,this.comment=t,this[_n]=e,this[wn]=r,this[Yn]=i,this[Pn]=s,this[Or]=o}vs.prototype=Ei;{let n=Buffer.alloc(0),t=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e=Buffer.from([0,0,0,0]),r=Buffer.from([0,0,0,1]),i=/^PuTTY-User-Key-File-2: (ssh-(?:rsa|dss))\r?\nEncryption: (aes256-cbc|none)\r?\nComment: ([^\r\n]*)\r?\nPublic-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-MAC: ([^\r\n]+)/;vs.parse=(s,o)=>{let f=i.exec(s);if(f===null)return null;let a=f[2],u=a!=="none";if(u&&!o)return new Error("Encrypted PPK private key detected, but no passphrase given");let h=Buffer.from(f[5],"base64");if(u){let T=li[a],F=hi(ui("sha1").update(e).update(o).digest(),ui("sha1").update(r).update(o).digest());F.length>T.keyLen&&(F=ur(F,0,T.keyLen));try{let D=If(T.sslName,F,t);D.setAutoPadding(!1),h=hi(D.update(h),D.final())}catch(D){return D}}let l=f[1],A=f[3],p=Buffer.from(f[4],"base64"),y=f[6],I=l.length,v=a.length,x=Buffer.byteLength(A),O=p.length,X=h.length,H=Buffer.allocUnsafe(4+I+4+v+4+x+4+O+4+X),te=0;if(kt(H,I,te),H.utf8Write(l,te+=4,I),kt(H,v,te+=I),H.utf8Write(a,te+=4,v),kt(H,x,te+=v),H.utf8Write(A,te+=4,x),kt(H,O,te+=x),H.set(p,te+=4),kt(H,X,te+=O),H.set(h,te+4),o||(o=n),h_("sha1",ui("sha1").update("putty-private-key-file-mac-key").update(o).digest()).update(H).digest("hex")!==y)return u?new Error("PPK private key integrity check failed -- bad passphrase?"):new Error("PPK private key integrity check failed");let M,q,C;switch(p._pos=0,xf(p,1),l){case"ssh-rsa":{let T=me(p,p._pos);if(T===void 0)return new Error("Malformed PPK public key");let F=me(p,p._pos);if(F===void 0)return new Error("Malformed PPK public key");let D=me(h,0);if(D===void 0)return new Error("Malformed PPK private key");let ne=me(h,h._pos);if(ne===void 0)return new Error("Malformed PPK private key");let re=me(h,h._pos);if(re===void 0)return new Error("Malformed PPK private key");let ie=me(h,h._pos);if(ie===void 0)return new Error("Malformed PPK private key");M=di(F,T),q=Ai(F,T),C=Su(F,T,D,ie,ne,re);break}case"ssh-dss":{let T=me(p,p._pos);if(T===void 0)return new Error("Malformed PPK public key");let F=me(p,p._pos);if(F===void 0)return new Error("Malformed PPK public key");let D=me(p,p._pos);if(D===void 0)return new Error("Malformed PPK public key");let ne=me(p,p._pos);if(ne===void 0)return new Error("Malformed PPK public key");let re=me(h,0);if(re===void 0)return new Error("Malformed PPK private key");M=_i(T,F,D,ne),q=gi(T,F,D,ne),C=mu(T,F,D,ne,re);break}}return new vs(l,A,C,M,q,"sha1",u)}}function ks(n,t,e,r,i){this.type=n,this.comment=t,this[_n]=null,this[wn]=e,this[Yn]=r,this[Pn]=i,this[Or]=!1}ks.prototype=Ei;{let n;yf?n=/^(((?:ssh-(?:rsa|dss|ed25519))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z/+=]+)(?:$|\s+([\S].*)?)$/:n=/^(((?:ssh-(?:rsa|dss))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z/+=]+)(?:$|\s+([\S].*)?)$/,ks.parse=t=>{let e=n.exec(t);if(e===null)return null;let r=e[1],i=e[2],s=Buffer.from(e[3],"base64"),o=e[4]||"",f=me(s,s._pos,!0);return f===void 0||f.indexOf(i)!==0?new Error("Malformed OpenSSH public key"):mf(s,i,o,r)}}function Ns(n,t,e,r,i){this.type=n,this.comment=t,this[_n]=null,this[wn]=e,this[Yn]=r,this[Pn]=i,this[Or]=!1}Ns.prototype=Ei;{let n=/^---- BEGIN SSH2 PUBLIC KEY ----(?:\r?\n)((?:.{0,72}\r?\n)+)---- END SSH2 PUBLIC KEY ----$/,t=/^[A-Z0-9a-z/+=\r\n]+$/,e=/^([\x21-\x39\x3B-\x7E]{1,64}): ((?:[^\\]*\\\r?\n)*[^\r\n]+)\r?\n/gm,r=/\\\r?\n/g;Ns.parse=i=>{let s=n.exec(i);if(s===null)return null;let o=s[1],f=0,a="";for(;s=e.exec(o);){let p=s[1],y=s[2].replace(r,"");if(y.length>1024)return e.lastIndex=0,new Error("Malformed RFC4716 public key");f=e.lastIndex,p.toLowerCase()==="comment"&&(a=y,a.length>1&&a.charCodeAt(0)===34&&a.charCodeAt(a.length-1)===34&&(a=a.slice(1,-1)))}let u=o.slice(f);if(!t.test(u))return new Error("Malformed RFC4716 public key");u=Buffer.from(u,"base64");let h=me(u,0,!0);if(h===void 0)return new Error("Malformed RFC4716 public key");let l=null,A=null;switch(h){case"ssh-rsa":{let p=me(u,u._pos);if(p===void 0)return new Error("Malformed RFC4716 public key");let y=me(u,u._pos);if(y===void 0)return new Error("Malformed RFC4716 public key");l=di(y,p),A=Ai(y,p);break}case"ssh-dss":{let p=me(u,u._pos);if(p===void 0)return new Error("Malformed RFC4716 public key");let y=me(u,u._pos);if(y===void 0)return new Error("Malformed RFC4716 public key");let I=me(u,u._pos);if(I===void 0)return new Error("Malformed RFC4716 public key");let v=me(u,u._pos);if(v===void 0)return new Error("Malformed RFC4716 public key");l=_i(p,y,I,v),A=gi(p,y,I,v);break}default:return new Error("Malformed RFC4716 public key")}return new Ns(h,a,l,A,"sha1")}}function mf(n,t,e,r){if(!Bu(t))return new Error(`Unsupported OpenSSH public key type: ${t}`);let i,s,o=null,f=null;switch(t){case"ssh-rsa":{let a=me(n,n._pos||0);if(a===void 0)return new Error("Malformed OpenSSH public key");let u=me(n,n._pos);if(u===void 0)return new Error("Malformed OpenSSH public key");o=di(u,a),f=Ai(u,a),i="sha1";break}case"ssh-dss":{let a=me(n,n._pos||0);if(a===void 0)return new Error("Malformed OpenSSH public key");let u=me(n,n._pos);if(u===void 0)return new Error("Malformed OpenSSH public key");let h=me(n,n._pos);if(h===void 0)return new Error("Malformed OpenSSH public key");let l=me(n,n._pos);if(l===void 0)return new Error("Malformed OpenSSH public key");o=_i(a,u,h,l),f=gi(a,u,h,l),i="sha1";break}case"ssh-ed25519":{let a=me(n,n._pos||0);if(a===void 0||a.length!==32)return new Error("Malformed OpenSSH public key");o=Cu(a),f=Ru(a),i=null;break}case"ecdsa-sha2-nistp256":i="sha256",s="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":i===void 0&&(i="sha384",s="1.3.132.0.34");case"ecdsa-sha2-nistp521":{if(i===void 0&&(i="sha512",s="1.3.132.0.35"),!xf(n,1))return new Error("Malformed OpenSSH public key");let a=me(n,n._pos||0);if(a===void 0)return new Error("Malformed OpenSSH public key");o=wf(s,a),f=Sf(s,a);break}default:return new Error(`Unsupported OpenSSH public key type: ${t}`)}return new ks(r,e,o,f,i)}function Bu(n){switch(n){case"ssh-rsa":case"ssh-dss":case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":return!0;case"ssh-ed25519":if(yf)return!0;default:return!1}}function vu(n){return n?typeof n[Or]=="boolean":!1}function Nu(n,t){if(vu(n))return n;let e;if(Buffer.isBuffer(n))e=n,n=n.utf8Slice(0,n.length).trim();else if(typeof n=="string")n=n.trim();else return new Error("Key data must be a Buffer or string");if(t!=null){if(typeof t=="string")t=Buffer.from(t);else if(!Buffer.isBuffer(t))return new Error("Passphrase must be a string or Buffer when supplied")}let r;if((r=Rs.parse(n,t))!==null||(r=Bs.parse(n,t))!==null||(r=vs.parse(n,t))!==null||(r=ks.parse(n))!==null||(r=Ns.parse(n))!==null)return r;if(e){Cs.init(e,0);let i=Cs.readString(!0);i!==void 0&&(n=Cs.readRaw(),n!==void 0&&(r=mf(n,i,"",i),r instanceof Error&&(r=null))),Cs.clear()}return r||new Error("Unsupported key format")}ku.exports={isParsedKey:vu,isSupportedKeyType:Bu,parseDERKey:(n,t)=>mf(n,t,"",t),parseKey:Nu}});var kf=_e((Rb,qu)=>{"use strict";var{Socket:Pu}=require("net"),{Duplex:Uu}=require("stream"),{resolve:w_}=require("path"),{readFile:Tu}=require("fs"),{execFile:S_,spawn:m_}=require("child_process"),{isParsedKey:Ou,parseKey:pi}=jn(),{makeBufferParser:C_,readUInt32BE:Nf,writeUInt32BE:jt,writeUInt32LE:Lu}=An();function bi(n){let t=!1;return(...e)=>{t||(t=!0,n(...e))}}function R_(n,t){let e=Buffer.allocUnsafe(n.length+t.length);return n.copy(e,0),t.copy(e,n.length),e}function Rf(){}var B_=Buffer.alloc(0),Et=C_(),Ii=class{getIdentities(t){t(new Error("Missing getIdentities() implementation"))}sign(t,e,r,i){typeof r=="function"&&(i=r),i(new Error("Missing sign() implementation"))}},Pr=class extends Ii{constructor(t){super(),this.socketPath=t}getStream(t){t=bi(t);let e=new Pu;e.on("connect",()=>{t(null,e)}),e.on("close",r).on("end",r).on("error",r),e.connect(this.socketPath);function r(){try{e.destroy()}catch{}t(new Error("Failed to connect to agent"))}}getIdentities(t){t=bi(t),this.getStream((e,r)=>{function i(o){if(r)try{r.destroy()}catch{}o||(o=new Error("Failed to retrieve identities from agent")),t(o)}if(e)return i(e);let s=new Bf(!0);s.on("error",i),s.pipe(r).pipe(s),r.on("close",i).on("end",i).on("error",i),s.getIdentities((o,f)=>{if(o)return i(o);try{r.destroy()}catch{}t(null,f)})})}sign(t,e,r,i){typeof r=="function"?(i=r,r=void 0):(typeof r!="object"||r===null)&&(r=void 0),i=bi(i),this.getStream((s,o)=>{function f(u){if(o)try{o.destroy()}catch{}u||(u=new Error("Failed to sign data with agent")),i(u)}if(s)return f(s);let a=new Bf(!0);a.on("error",f),a.pipe(o).pipe(a),o.on("close",f).on("end",f).on("error",f),a.sign(t,e,r,(u,h)=>{if(u)return f(u);try{o.destroy()}catch{}i(null,h)})})}},Du=(()=>{let o=w_(__dirname,"..","util/pagent.exe"),f={[10]:new Error("Invalid pagent.exe arguments"),[11]:new Error("Pageant is not running"),[12]:new Error("pagent.exe could not create an mmap"),[13]:new Error("pagent.exe could not set mode for stdin"),[14]:new Error("pagent.exe could not set mode for stdout"),[15]:new Error("pagent.exe did not get expected input payload")};function a(h){h.buffer=null,h.proc&&(h.proc.kill(),h.proc=void 0)}class u extends Uu{constructor(){super(),this.proc=void 0,this.buffer=null}_read(l){}_write(l,A,p){if(this.buffer===null)this.buffer=l;else{let x=Buffer.allocUnsafe(this.buffer.length+l.length);this.buffer.copy(x,0),l.copy(x,this.buffer.length),this.buffer=x}if(this.buffer.length<4)return p();let y=Nf(this.buffer,0);if(this.buffer.length-4<y)return p();if(l=this.buffer.slice(0,4+y),this.buffer.length>4+y)return p(new Error("Unexpected multiple agent requests"));this.buffer=null;let I,v=this.proc=m_(o,[l.length]);v.stdout.on("data",x=>{this.push(x)}),v.on("error",x=>{I=x,p(I)}),v.on("close",x=>{if(this.proc=void 0,!I){if(I=f[x])return p(I);p()}}),v.stdin.end(l)}_final(l){a(this),l()}_destroy(l,A){a(this),A()}}return class extends Pr{getStream(l){l(null,new u)}}})(),Qu=(()=>{let n=/^!<socket >(\d+) s ([A-Z0-9]{8}-[A-Z0-9]{8}-[A-Z0-9]{8}-[A-Z0-9]{8})/;return class extends Pr{getStream(e){e=bi(e);let r=this.socketPath,i=!1;Tu(r,function s(o,f){if(o){if(i)return e(new Error("Invalid cygwin unix socket path"));S_("cygpath",["-w",r],(ce,M,q)=>{if(ce||M.length===0)return e(new Error("Invalid cygwin unix socket path"));i=!0,r=M.toString().replace(/[\r\n]/g,""),Tu(r,s)});return}let a=n.exec(f.toString("ascii"));if(!a)return e(new Error("Malformed cygwin unix socket file"));let u,h=0,l=!1,A=[],p,y=Buffer.alloc(12),I=parseInt(a[1],10),v=a[2].replace(/-/g,""),x=Buffer.allocUnsafe(16);for(let ce=0,M=0;M<32;++ce,M+=2)x[ce]=parseInt(v.substring(M,M+2),16);for(let ce=0;ce<16;ce+=4)Lu(x,Nf(x,ce),ce);te();function O(){h=0,u="secret",p.write(x)}function X(ce){if(h+=ce.length,u==="secret"){h===16&&(h=0,u="creds",p.write(y));return}if(u==="creds"&&(l||A.push(ce),h===12)){if(p.removeListener("connect",O),p.removeListener("data",X),p.removeListener("error",H),p.removeListener("end",H),p.removeListener("close",H),l)return e(null,p);l=!0,y=Buffer.concat(A),Lu(y,process.pid,0),p.on("error",()=>{}),p.destroy(),te()}}function H(){e(new Error("Problem negotiating cygwin unix socket security"))}function te(){p=new Pu,p.on("connect",O),p.on("data",X),p.on("error",H),p.on("end",H),p.on("close",H),p.connect(I)}})}}})(),v_=/^[/\\][/\\]\.[/\\]pipe[/\\].+/;function Hu(n){return process.platform==="win32"&&!v_.test(n)?n==="pageant"?new Du:new Qu(n):new Pr(n)}var Bf=(()=>{function u(q){let C;for(;q[O].length;){let T=q[O][0][l];if(T===void 0)break;q[O].shift(),C=q.push(T)}return C}let h=Symbol("Inbound Request Type"),l=Symbol("Inbound Request Response"),A=Symbol("Inbound Request Context");class p{constructor(C,T){this[h]=C,this[l]=void 0,this[A]=T}hasResponded(){return this[l]!==void 0}getType(){return this[h]}getContext(){return this[A]}}function y(q,C,T){return C[l]=T,u(q)}function I(q){if(q[H]=null,q[X]===0){let C=q[O];if(C&&C.length){q[O]=[];for(let T of C)T.cb(new Error("No reply from server"))}}try{q.end()}catch{}setImmediate(()=>{q[M]||q.emit("end"),q[ce]||q.emit("close")})}function v(){this[ce]=!0}function x(){this[M]=!0}let O=Symbol("Requests"),X=Symbol("Agent Protocol Role"),H=Symbol("Agent Protocol Buffer"),te=Symbol("Agent Protocol Current Message Length"),ce=Symbol("Agent Protocol Closed"),M=Symbol("Agent Protocol Ended");return class extends Uu{constructor(C){super({autoDestroy:!0,emitClose:!1}),this[X]=C?0:1,this[O]=[],this[H]=null,this[te]=-1,this.once("end",x),this.once("close",v)}_read(C){}_write(C,T,F){this[H]===null?this[H]=C:this[H]=R_(this[H],C);let D=this[H],ne=D.length,re=0;for(;re<ne&&!(ne<5||(this[te]===-1&&(this[te]=Nf(D,re)),ne<4+this[te]));){let ie=D[re+=4];if(++re,this[X]===0){if(this[O].length===0)return F(new Error("Received unexpected message from server"));let ee=this[O].shift();switch(ie){case 5:ee.cb(new Error("Agent responded with failure"));break;case 12:{if(ee.type!==11)return F(new Error("Agent responded with wrong message type"));Et.init(D,re);let w=Et.readUInt32BE();if(w===void 0)return Et.clear(),F(new Error("Malformed agent response"));let k=[];for(let $=0;$<w;++$){let K=Et.readString();if(K===void 0)return Et.clear(),F(new Error("Malformed agent response"));let pe=Et.readString(!0);if(pe===void 0)return Et.clear(),F(new Error("Malformed agent response"));K=pi(K),!(K instanceof Error)&&(K.comment=K.comment||pe,k.push(K))}re=Et.pos(),Et.clear(),ee.cb(null,k);break}case 14:{if(ee.type!==13)return F(new Error("Agent responded with wrong message type"));Et.init(D,re);let w=Et.readString();if(re=Et.pos(),Et.clear(),w===void 0)return F(new Error("Malformed agent response"));if(Et.init(w,0),Et.readString(!0),w=Et.readString(),Et.clear(),w===void 0)return F(new Error("Malformed OpenSSH signature format"));ee.cb(null,w);break}default:return F(new Error("Agent responded with unsupported message type"))}}else switch(ie){case 11:{let ee=new p(ie);this[O].push(ee),this.emit("identities",ee);break}case 13:{Et.init(D,re);let ee=Et.readString(),w=Et.readString(),k=Et.readUInt32BE();if(re=Et.pos(),Et.clear(),k===void 0){let Ne=new p(ie);return this[O].push(Ne),this.failureReply(Ne)}if(ee=pi(ee),ee instanceof Error){let Ne=new p(ie);return this[O].push(Ne),this.failureReply(Ne)}let $={hash:void 0},K;ee.type==="ssh-rsa"&&(k&2?(K="rsa-sha2-256",$.hash="sha256"):k&4&&(K="rsa-sha2-512",$.hash="sha512")),K===void 0&&(K=ee.type);let pe=new p(ie,K);this[O].push(pe),this.emit("sign",pe,ee,w,$);break}default:{let ee=new p(ie);this[O].push(ee),this.failureReply(ee)}}if(this[te]=-1,re===ne){this[H]=null;break}else this[H]=D=D.slice(re),ne=D.length,re=0}F()}_destroy(C,T){I(this),T()}_final(C){I(this),C()}sign(C,T,F,D){if(this[X]!==0)throw new Error("Client-only method called with server role");typeof F=="function"?(D=F,F=void 0):(typeof F!="object"||F===null)&&(F=void 0);let ne=0;if(C=pi(C),C instanceof Error)throw new Error("Invalid public key argument");if(C.type==="ssh-rsa"&&F)switch(F.hash){case"sha256":ne=2;break;case"sha512":ne=4;break}C=C.getPublicSSH();let re=13,ie=C.length,ee=T.length,w=0,k=Buffer.allocUnsafe(4+1+4+ie+4+ee+4);return jt(k,k.length-4,w),k[w+=4]=re,jt(k,ie,++w),C.copy(k,w+=4),jt(k,ee,w+=ie),T.copy(k,w+=4),jt(k,ne,w+=ee),typeof D!="function"&&(D=Rf),this[O].push({type:re,cb:D}),this.push(k)}getIdentities(C){if(this[X]!==0)throw new Error("Client-only method called with server role");let T=11,F=0,D=Buffer.allocUnsafe(4+1);return jt(D,D.length-4,F),D[F+=4]=T,typeof C!="function"&&(C=Rf),this[O].push({type:T,cb:C}),this.push(D)}failureReply(C){if(this[X]!==1)throw new Error("Server-only method called with client role");if(!(C instanceof p))throw new Error("Wrong request argument");if(C.hasResponded())return!0;let T=0,F=Buffer.allocUnsafe(4+1);return jt(F,F.length-4,T),F[T+=4]=5,y(this,C,F)}getIdentitiesReply(C,T){if(this[X]!==1)throw new Error("Server-only method called with client role");if(!(C instanceof p))throw new Error("Wrong request argument");if(C.hasResponded())return!0;if(C.getType()!==11)throw new Error("Invalid response to request");if(!Array.isArray(T))throw new Error("Keys argument must be an array");let F=4,D=[];for(let ie=0;ie<T.length;++ie){let ee=T[ie];if(typeof ee!="object"||ee===null)throw new Error(`Invalid key entry: ${ee}`);let w,k;if(Ou(ee))w=ee;else if(Ou(ee.pubKey))w=ee.pubKey;else if(typeof ee.pubKey!="object"||ee.pubKey===null||({pubKey:w,comment:k}=ee.pubKey,w=pi(w),w instanceof Error))continue;k=w.comment||k,w=w.getPublicSSH(),F+=4+w.length,k&&typeof k=="string"?k=Buffer.from(k):Buffer.isBuffer(k)||(k=B_),F+=4+k.length,D.push({pubKey:w,comment:k})}let ne=0,re=Buffer.allocUnsafe(4+1+F);jt(re,re.length-4,ne),re[ne+=4]=12,jt(re,D.length,++ne),ne+=4;for(let ie=0;ie<D.length;++ie){let{pubKey:ee,comment:w}=D[ie];jt(re,ee.length,ne),ee.copy(re,ne+=4),jt(re,w.length,ne+=ee.length),ne+=4,w.length&&(w.copy(re,ne),ne+=w.length)}return y(this,C,re)}signReply(C,T){if(this[X]!==1)throw new Error("Server-only method called with client role");if(!(C instanceof p))throw new Error("Wrong request argument");if(C.hasResponded())return!0;if(C.getType()!==13)throw new Error("Invalid response to request");if(!Buffer.isBuffer(T))throw new Error("Signature argument must be a Buffer");if(T.length===0)throw new Error("Signature argument must be non-empty");let F=0,D=C.getContext(),ne=Buffer.byteLength(D),re=Buffer.allocUnsafe(4+1+4+4+ne+4+T.length);return jt(re,re.length-4,F),re[F+=4]=14,jt(re,4+ne+4+T.length,++F),jt(re,ne,F+=4),re.utf8Write(D,F+=4,ne),jt(re,T.length,F+=ne),T.copy(re,F+=4),y(this,C,re)}}})(),Cf=Symbol("Agent"),En=Symbol("Agent Keys"),Un=Symbol("Agent Keys Index"),Lr=Symbol("Agent Init Callbacks"),vf=class{constructor(t){if(typeof t=="string")t=Hu(t);else if(!Fu(t))throw new Error("Invalid agent argument");this[Cf]=t,this[En]=null,this[Un]=-1,this[Lr]=null}init(t){if(typeof t!="function"&&(t=Rf),this[En]===null)if(this[Lr]===null){this[Lr]=[t];let e=(...r)=>{process.nextTick(()=>{let i=this[Lr];this[Lr]=null;for(let s of i)s(...r)})};this[Cf].getIdentities(bi((r,i)=>{if(r)return e(r);if(!Array.isArray(i))return e(new Error("Agent implementation failed to provide keys"));let s=[];for(let o of i)o=pi(o),!(o instanceof Error)&&s.push(o);this[En]=s,this[Un]=-1,e()}))}else this[Lr].push(t);else process.nextTick(t)}nextKey(){return this[En]===null||++this[Un]>=this[En].length?!1:this[En][this[Un]]}currentKey(){return this[En]===null||this[Un]>=this[En].length?null:this[En][this[Un]]}pos(){return this[En]===null||this[Un]>=this[En].length?-1:this[Un]}reset(){this[Un]=-1}sign(...t){this[Cf].sign(...t)}};function Fu(n){return n instanceof Ii}qu.exports={AgentContext:vf,AgentProtocol:Bf,BaseAgent:Ii,createAgent:Hu,CygwinAgent:Qu,isAgent:Fu,OpenSSHAgent:Pr,PageantAgent:Du}});var Df=_e((Bb,Mu)=>{"use strict";var{kMaxLength:N_}=require("buffer"),{createInflate:k_,constants:{DEFLATE:T_,INFLATE:O_,Z_DEFAULT_CHUNK:L_,Z_DEFAULT_COMPRESSION:P_,Z_DEFAULT_MEMLEVEL:U_,Z_DEFAULT_STRATEGY:D_,Z_DEFAULT_WINDOWBITS:Q_,Z_PARTIAL_FLUSH:H_}}=require("zlib"),F_=k_()._handle.constructor;function q_(){throw new Error("Should not get here")}function M_(n,t,e){let r=this._owner,i=new Error(n);i.errno=t,i.code=e,r._err=i}function Uf(n){!n._handle||(n._handle.close(),n._handle=null)}var Ts=class{constructor(t){let e=Q_,r=P_,i=U_,s=D_,o=void 0;this._err=void 0,this._writeState=new Uint32Array(2),this._chunkSize=L_,this._maxOutputLength=N_,this._outBuffer=Buffer.allocUnsafe(this._chunkSize),this._outOffset=0,this._handle=new F_(t),this._handle._owner=this,this._handle.onerror=M_,this._handle.init(e,r,i,s,this._writeState,q_,o)}writeSync(t,e){let r=this._handle;if(!r)throw new Error("Invalid Zlib instance");let i=t.length,s=this._chunkSize-this._outOffset,o=0,f,a,u,h=0,l=this._writeState,A=this._outBuffer,p=this._outOffset,y=this._chunkSize;for(;;){if(r.writeSync(H_,t,o,i,A,p,s),this._err)throw this._err;f=l[0],a=l[1];let v=i-a,x=s-f;if(x>0){let O=p===0&&x===A.length?A:A.slice(p,p+x);if(p+=x,u?u.push===void 0?u=[u,O]:u.push(O):u=O,h+=O.byteLength,h>this._maxOutputLength)throw Uf(this),new Error(`Output length exceeded maximum of ${this._maxOutputLength}`)}else if(x!==0)throw new Error("have should not go down");if((f===0||p>=y)&&(s=y,p=0,A=Buffer.allocUnsafe(y)),f===0)o+=v,i=a;else break}if(this._outBuffer=A,this._outOffset=p,h===0&&(u=Buffer.alloc(0)),e)return u.totalLen=h,u;if(u.push===void 0)return u;let I=Buffer.allocUnsafe(h);for(let v=0,x=0;v<u.length;++v){let O=u[v];I.set(O,x),x+=O.length}return I}},Tf=class{constructor(t){this.allocStart=0,this.allocStartKEX=0,this._protocol=t,this._zlib=new Ts(T_)}cleanup(){this._zlib&&Uf(this._zlib)}alloc(t,e){return Buffer.allocUnsafe(t)}finalize(t,e){if(this._protocol._kexinit===void 0||e){let r=this._zlib.writeSync(t,!0),i=this._protocol._cipher.allocPacket(r.totalLen);if(r.push===void 0)i.set(r,5);else for(let s=0,o=5;s<r.length;++s){let f=r[s];i.set(f,o),o+=f.length}return i}return t}},Of=class{constructor(t){this.allocStart=5,this.allocStartKEX=5,this._protocol=t}cleanup(){}alloc(t,e){return this._protocol._kexinit===void 0||e?this._protocol._cipher.allocPacket(t):Buffer.allocUnsafe(t)}finalize(t,e){return t}},Lf=class{constructor(){this._zlib=new Ts(O_)}cleanup(){this._zlib&&Uf(this._zlib)}read(t){return this._zlib.writeSync(t,!1)}},Pf=class{cleanup(){}read(t){return t}};Mu.exports={PacketReader:Pf,PacketWriter:Of,ZlibPacketReader:Lf,ZlibPacketWriter:Tf}});var Yu=_e((vb,$u)=>{"use strict";var{bufferSlice:Qf,bufferParser:R,doFatalError:At,sigSSHToASN1:Ku,writeUInt32BE:Wu}=An(),{CHANNEL_OPEN_FAILURE:K_,COMPAT:W_,MESSAGE:_t,TERMINAL_MODE:Gu}=Ln(),{parseKey:G_}=jn(),$_=Array.from(Object.entries(Gu)).reduce((n,[t,e])=>({...n,[t]:e}),{});$u.exports={[_t.DISCONNECT]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE(),r=R.readString(!0),i=R.readString();if(R.clear(),i===void 0)return At(n,"Inbound: Malformed DISCONNECT packet");n._debug&&n._debug(`Inbound: Received DISCONNECT (${e}, "${r}")`);let s=n._handlers.DISCONNECT;s&&s(n,e,r)},[_t.IGNORE]:(n,t)=>{n._debug&&n._debug("Inbound: Received IGNORE")},[_t.UNIMPLEMENTED]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE();if(R.clear(),e===void 0)return At(n,"Inbound: Malformed UNIMPLEMENTED packet");n._debug&&n._debug(`Inbound: Received UNIMPLEMENTED (seqno ${e})`)},[_t.DEBUG]:(n,t)=>{R.init(t,1);let e=R.readBool(),r=R.readString(!0),i=R.readString();if(R.clear(),i===void 0)return At(n,"Inbound: Malformed DEBUG packet");n._debug&&n._debug("Inbound: Received DEBUG");let s=n._handlers.DEBUG;s&&s(n,e,r)},[_t.SERVICE_REQUEST]:(n,t)=>{R.init(t,1);let e=R.readString(!0);if(R.clear(),e===void 0)return At(n,"Inbound: Malformed SERVICE_REQUEST packet");n._debug&&n._debug(`Inbound: Received SERVICE_REQUEST (${e})`);let r=n._handlers.SERVICE_REQUEST;r&&r(n,e)},[_t.SERVICE_ACCEPT]:(n,t)=>{R.init(t,1);let e=R.readString(!0);if(R.clear(),e===void 0)return At(n,"Inbound: Malformed SERVICE_ACCEPT packet");n._debug&&n._debug(`Inbound: Received SERVICE_ACCEPT (${e})`);let r=n._handlers.SERVICE_ACCEPT;r&&r(n,e)},[_t.USERAUTH_REQUEST]:(n,t)=>{R.init(t,1);let e=R.readString(!0),r=R.readString(!0),i=R.readString(!0),s,o;switch(i){case"none":s=null;break;case"password":{let a=R.readBool();if(a!==void 0&&(s=R.readString(!0),s!==void 0&&a)){let u=R.readString(!0);u!==void 0?s={oldPassword:s,newPassword:u}:s=void 0}break}case"publickey":{let a=R.readBool();if(a!==void 0){let u=R.readString(!0),h=R.readString();if(a){let l=R.pos(),A=R.readString();if(A!==void 0&&(A.length>4+u.length+4&&A.utf8Slice(4,4+u.length)===u&&(A=Qf(A,4+u.length+4)),A=Ku(A,u),A)){let p=n._kex.sessionID,y=Buffer.allocUnsafe(4+p.length+l);Wu(y,p.length,0),y.set(p,4),y.set(new Uint8Array(t.buffer,t.byteOffset,l),4+p.length),s={keyAlgo:u,key:h,signature:A,blob:y}}}else s={keyAlgo:u,key:h},o="publickey -- check"}break}case"hostbased":{let a=R.readString(!0),u=R.readString(),h=R.readString(!0),l=R.readString(!0),A=R.pos(),p=R.readString();if(p!==void 0&&(p.length>4+a.length+4&&p.utf8Slice(4,4+a.length)===a&&(p=Qf(p,4+a.length+4)),p=Ku(p,a),p!==void 0)){let y=n._kex.sessionID,I=Buffer.allocUnsafe(4+y.length+A);Wu(I,y.length,0),I.set(y,4),I.set(new Uint8Array(t.buffer,t.byteOffset,A),4+y.length),s={keyAlgo:a,key:u,signature:p,blob:I,localHostname:h,localUsername:l}}break}case"keyboard-interactive":R.skipString(),s=R.readList();break;default:i!==void 0&&(s=R.readRaw())}if(R.clear(),s===void 0)return At(n,"Inbound: Malformed USERAUTH_REQUEST packet");o===void 0&&(o=i),n._authsQueue.push(i),n._debug&&n._debug(`Inbound: Received USERAUTH_REQUEST (${o})`);let f=n._handlers.USERAUTH_REQUEST;f&&f(n,e,r,i,s)},[_t.USERAUTH_FAILURE]:(n,t)=>{R.init(t,1);let e=R.readList(),r=R.readBool();if(R.clear(),r===void 0)return At(n,"Inbound: Malformed USERAUTH_FAILURE packet");n._debug&&n._debug(`Inbound: Received USERAUTH_FAILURE (${e})`),n._authsQueue.shift();let i=n._handlers.USERAUTH_FAILURE;i&&i(n,e,r)},[_t.USERAUTH_SUCCESS]:(n,t)=>{n._debug&&n._debug("Inbound: Received USERAUTH_SUCCESS"),n._authsQueue.shift();let e=n._handlers.USERAUTH_SUCCESS;e&&e(n)},[_t.USERAUTH_BANNER]:(n,t)=>{R.init(t,1);let e=R.readString(!0),r=R.readString();if(R.clear(),r===void 0)return At(n,"Inbound: Malformed USERAUTH_BANNER packet");n._debug&&n._debug("Inbound: Received USERAUTH_BANNER");let i=n._handlers.USERAUTH_BANNER;i&&i(n,e)},60:(n,t)=>{if(!n._authsQueue.length){n._debug&&n._debug("Inbound: Received payload type 60 without auth");return}switch(n._authsQueue[0]){case"password":{R.init(t,1);let e=R.readString(!0),r=R.readString();if(R.clear(),r===void 0)return At(n,"Inbound: Malformed USERAUTH_PASSWD_CHANGEREQ packet");n._debug&&n._debug("Inbound: Received USERAUTH_PASSWD_CHANGEREQ");let i=n._handlers.USERAUTH_PASSWD_CHANGEREQ;i&&i(n,e);break}case"publickey":{R.init(t,1);let e=R.readString(!0),r=R.readString();if(R.clear(),r===void 0)return At(n,"Inbound: Malformed USERAUTH_PK_OK packet");n._debug&&n._debug("Inbound: Received USERAUTH_PK_OK"),n._authsQueue.shift();let i=n._handlers.USERAUTH_PK_OK;i&&i(n,e,r);break}case"keyboard-interactive":{R.init(t,1);let e=R.readString(!0),r=R.readString(!0);R.readString();let i=R.readUInt32BE(),s;if(i!==void 0){s=new Array(i);let f;for(f=0;f<i;++f){let a=R.readString(!0),u=R.readBool();if(u===void 0)break;s[f]={prompt:a,echo:u}}f!==i&&(s=void 0)}if(R.clear(),s===void 0)return At(n,"Inbound: Malformed USERAUTH_INFO_REQUEST packet");n._debug&&n._debug("Inbound: Received USERAUTH_INFO_REQUEST");let o=n._handlers.USERAUTH_INFO_REQUEST;o&&o(n,e,r,s);break}default:n._debug&&n._debug("Inbound: Received unexpected payload type 60")}},61:(n,t)=>{if(!n._authsQueue.length){n._debug&&n._debug("Inbound: Received payload type 61 without auth");return}if(n._authsQueue[0]!=="keyboard-interactive")return At(n,"Inbound: Received unexpected payload type 61");R.init(t,1);let e=R.readUInt32BE(),r;if(e!==void 0){r=new Array(e);let s;for(s=0;s<e;++s){let o=R.readString(!0);if(o===void 0)break;r[s]=o}s!==e&&(r=void 0)}if(R.clear(),r===void 0)return At(n,"Inbound: Malformed USERAUTH_INFO_RESPONSE packet");n._debug&&n._debug("Inbound: Received USERAUTH_INFO_RESPONSE");let i=n._handlers.USERAUTH_INFO_RESPONSE;i&&i(n,r)},[_t.GLOBAL_REQUEST]:(n,t)=>{R.init(t,1);let e=R.readString(!0),r=R.readBool(),i;if(r!==void 0)switch(e){case"tcpip-forward":case"cancel-tcpip-forward":{let o=R.readString(!0),f=R.readUInt32BE();f!==void 0&&(i={bindAddr:o,bindPort:f});break}case"streamlocal-forward@openssh.com":case"cancel-streamlocal-forward@openssh.com":{let o=R.readString(!0);o!==void 0&&(i={socketPath:o});break}case"no-more-sessions@openssh.com":i=null;break;case"hostkeys-00@openssh.com":{for(i=[];R.avail()>0;){let o=R.readString();if(o===void 0){i=void 0;break}let f=G_(o);f instanceof Error||i.push(f)}break}default:i=R.readRaw()}if(R.clear(),i===void 0)return At(n,"Inbound: Malformed GLOBAL_REQUEST packet");n._debug&&n._debug(`Inbound: GLOBAL_REQUEST (${e})`);let s=n._handlers.GLOBAL_REQUEST;s?s(n,e,r,i):n.requestFailure()},[_t.REQUEST_SUCCESS]:(n,t)=>{let e=t.length>1?Qf(t,1):null;n._debug&&n._debug("Inbound: REQUEST_SUCCESS");let r=n._handlers.REQUEST_SUCCESS;r&&r(n,e)},[_t.REQUEST_FAILURE]:(n,t)=>{n._debug&&n._debug("Inbound: Received REQUEST_FAILURE");let e=n._handlers.REQUEST_FAILURE;e&&e(n)},[_t.CHANNEL_OPEN]:(n,t)=>{R.init(t,1);let e=R.readString(!0),r=R.readUInt32BE(),i=R.readUInt32BE(),s=R.readUInt32BE(),o;switch(e){case"forwarded-tcpip":case"direct-tcpip":{let a=R.readString(!0),u=R.readUInt32BE(),h=R.readString(!0),l=R.readUInt32BE();l!==void 0&&(o={type:e,sender:r,window:i,packetSize:s,data:{destIP:a,destPort:u,srcIP:h,srcPort:l}});break}case"forwarded-streamlocal@openssh.com":case"direct-streamlocal@openssh.com":{let a=R.readString(!0);a!==void 0&&(o={type:e,sender:r,window:i,packetSize:s,data:{socketPath:a}});break}case"x11":{let a=R.readString(!0),u=R.readUInt32BE();u!==void 0&&(o={type:e,sender:r,window:i,packetSize:s,data:{srcIP:a,srcPort:u}});break}default:o={type:e,sender:r,window:i,packetSize:s,data:{}}}if(R.clear(),o===void 0)return At(n,"Inbound: Malformed CHANNEL_OPEN packet");n._debug&&n._debug(`Inbound: CHANNEL_OPEN (s:${r}, ${e})`);let f=n._handlers.CHANNEL_OPEN;f?f(n,o):n.channelOpenFail(o.sender,K_.ADMINISTRATIVELY_PROHIBITED,"","")},[_t.CHANNEL_OPEN_CONFIRMATION]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE(),r=R.readUInt32BE(),i=R.readUInt32BE(),s=R.readUInt32BE(),o=R.avail()?R.readRaw():void 0;if(R.clear(),s===void 0)return At(n,"Inbound: Malformed CHANNEL_OPEN_CONFIRMATION packet");n._debug&&n._debug(`Inbound: CHANNEL_OPEN_CONFIRMATION (r:${e}, s:${r})`);let f=n._handlers.CHANNEL_OPEN_CONFIRMATION;f&&f(n,{recipient:e,sender:r,window:i,packetSize:s,data:o})},[_t.CHANNEL_OPEN_FAILURE]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE(),r=R.readUInt32BE(),i=R.readString(!0),s=R.readString();if(R.clear(),s===void 0)return At(n,"Inbound: Malformed CHANNEL_OPEN_FAILURE packet");n._debug&&n._debug(`Inbound: CHANNEL_OPEN_FAILURE (r:${e})`);let o=n._handlers.CHANNEL_OPEN_FAILURE;o&&o(n,e,r,i)},[_t.CHANNEL_WINDOW_ADJUST]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE(),r=R.readUInt32BE();if(R.clear(),r===void 0)return At(n,"Inbound: Malformed CHANNEL_WINDOW_ADJUST packet");n._debug&&n._debug(`Inbound: CHANNEL_WINDOW_ADJUST (r:${e}, ${r})`);let i=n._handlers.CHANNEL_WINDOW_ADJUST;i&&i(n,e,r)},[_t.CHANNEL_DATA]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE(),r=R.readString();if(R.clear(),r===void 0)return At(n,"Inbound: Malformed CHANNEL_DATA packet");n._debug&&n._debug(`Inbound: CHANNEL_DATA (r:${e}, ${r.length})`);let i=n._handlers.CHANNEL_DATA;i&&i(n,e,r)},[_t.CHANNEL_EXTENDED_DATA]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE(),r=R.readUInt32BE(),i=R.readString();if(R.clear(),i===void 0)return At(n,"Inbound: Malformed CHANNEL_EXTENDED_DATA packet");n._debug&&n._debug(`Inbound: CHANNEL_EXTENDED_DATA (r:${e}, ${i.length})`);let s=n._handlers.CHANNEL_EXTENDED_DATA;s&&s(n,e,i,r)},[_t.CHANNEL_EOF]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE();if(R.clear(),e===void 0)return At(n,"Inbound: Malformed CHANNEL_EOF packet");n._debug&&n._debug(`Inbound: CHANNEL_EOF (r:${e})`);let r=n._handlers.CHANNEL_EOF;r&&r(n,e)},[_t.CHANNEL_CLOSE]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE();if(R.clear(),e===void 0)return At(n,"Inbound: Malformed CHANNEL_CLOSE packet");n._debug&&n._debug(`Inbound: CHANNEL_CLOSE (r:${e})`);let r=n._handlers.CHANNEL_CLOSE;r&&r(n,e)},[_t.CHANNEL_REQUEST]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE(),r=R.readString(!0),i=R.readBool(),s;if(i!==void 0)switch(r){case"exit-status":s=R.readUInt32BE(),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${s})`);break;case"exit-signal":{let f,a;if(n._compatFlags&W_.OLD_EXIT){let h=R.readUInt32BE();switch(h){case 1:f="HUP";break;case 2:f="INT";break;case 3:f="QUIT";break;case 6:f="ABRT";break;case 9:f="KILL";break;case 14:f="ALRM";break;case 15:f="TERM";break;default:h!==void 0&&(f=`UNKNOWN (${h})`)}a=!1}else f=R.readString(!0),a=R.readBool(),a===void 0&&(f=void 0);let u=R.readString(!0);R.skipString()!==void 0&&(s={signal:f,coreDumped:a,errorMessage:u}),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${f})`);break}case"pty-req":{let f=R.readString(!0),a=R.readUInt32BE(),u=R.readUInt32BE(),h=R.readUInt32BE(),l=R.readUInt32BE(),A=R.readString();if(A!==void 0){R.init(A,1);let p={};for(;R.avail();){let y=R.readByte();if(y===Gu.TTY_OP_END)break;let I=$_[y],v=R.readUInt32BE();if(y===void 0||I===void 0||v===void 0){p=void 0;break}p[I]=v}p!==void 0&&(s={term:f,cols:a,rows:u,width:h,height:l,modes:p})}n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r})`);break}case"window-change":{let f=R.readUInt32BE(),a=R.readUInt32BE(),u=R.readUInt32BE(),h=R.readUInt32BE();h!==void 0&&(s={cols:f,rows:a,width:u,height:h}),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r})`);break}case"x11-req":{let f=R.readBool(),a=R.readString(!0),u=R.readString(),h=R.readUInt32BE();h!==void 0&&(s={single:f,protocol:a,cookie:u,screen:h}),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r})`);break}case"env":{let f=R.readString(!0),a=R.readString(!0);a!==void 0&&(s={name:f,value:a}),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${f}=${a})`);break}case"shell":s=null,n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r})`);break;case"exec":s=R.readString(!0),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${s})`);break;case"subsystem":s=R.readString(!0),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${s})`);break;case"signal":s=R.readString(!0),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${s})`);break;case"xon-xoff":s=R.readBool(),n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r}: ${s})`);break;case"auth-agent-req@openssh.com":s=null,n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r})`);break;default:s=R.avail()?R.readRaw():null,n._debug&&n._debug(`Inbound: CHANNEL_REQUEST (r:${e}, ${r})`)}if(R.clear(),s===void 0)return At(n,"Inbound: Malformed CHANNEL_REQUEST packet");let o=n._handlers.CHANNEL_REQUEST;o&&o(n,e,r,i,s)},[_t.CHANNEL_SUCCESS]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE();if(R.clear(),e===void 0)return At(n,"Inbound: Malformed CHANNEL_SUCCESS packet");n._debug&&n._debug(`Inbound: CHANNEL_SUCCESS (r:${e})`);let r=n._handlers.CHANNEL_SUCCESS;r&&r(n,e)},[_t.CHANNEL_FAILURE]:(n,t)=>{R.init(t,1);let e=R.readUInt32BE();if(R.clear(),e===void 0)return At(n,"Inbound: Malformed CHANNEL_FAILURE packet");n._debug&&n._debug(`Inbound: CHANNEL_FAILURE (r:${e})`);let r=n._handlers.CHANNEL_FAILURE;r&&r(n,e)}}});var Ff=_e((Nb,ju)=>{"use strict";var Hf=new Array(256);[Os().HANDLERS,Yu()].forEach(n=>{for(let[t,e]of Object.entries(n))t=+t,isFinite(t)&&t>=0&&t<Hf.length&&(Hf[t]=e)});ju.exports=Hf});var Os=_e((Tb,ol)=>{"use strict";var{createDiffieHellman:Y_,createDiffieHellmanGroup:j_,createECDH:X_,createHash:Kf,createPublicKey:V_,diffieHellman:z_,generateKeyPairSync:J_,randomFillSync:Z_}=require("crypto"),{Ber:Xu}=_s(),{COMPAT:Wf,curve25519Supported:eg,DEFAULT_KEX:tg,DEFAULT_SERVER_HOST_KEY:ng,DEFAULT_CIPHER:Vu,DEFAULT_MAC:zu,DEFAULT_COMPRESSION:Ju,DISCONNECT_REASON:Xe,MESSAGE:lt}=Ln(),{CIPHER_INFO:Dr,createCipher:rg,createDecipher:ig,MAC_INFO:Zu}=fr(),{parseDERKey:sg}=jn(),{bufferFill:og,bufferParser:$e,convertSignature:fg,doFatalError:Ve,FastBuffer:ag,sigSSHToASN1:cg,writeUInt32BE:Tt}=An(),{PacketReader:el,PacketWriter:tl,ZlibPacketReader:Ls,ZlibPacketWriter:Ps}=Df(),qf,ug=2048,lg=8192,hg=Buffer.alloc(0);function rl(n){let t;if(n._compatFlags&Wf.BAD_DHGEX){let e=n._offer.lists.kex,r=e.array,i=!1;for(let s=0;s<r.length;++s)r[s].includes("group-exchange")&&(i||(i=!0,r=r.slice()),r.splice(s--,1));if(i){let s=17+n._offer.totalSize+1+4,o=Buffer.from(r.join(","));s-=e.buffer.length-o.length;let f=n._offer.lists.all,a=new Uint8Array(f.buffer,f.byteOffset+4+e.buffer.length,f.length-(4+e.buffer.length));t=Buffer.allocUnsafe(s),Tt(t,o.length,17),t.set(o,17+4),t.set(a,17+4+o.length)}}t===void 0&&(t=Buffer.allocUnsafe(1+16+n._offer.totalSize+1+4),n._offer.copyAllTo(t,17)),n._debug&&n._debug("Outbound: Sending KEXINIT"),t[0]=lt.KEXINIT,Z_(t,1,16),og(t,0,t.length-5),n._kexinit=t,n._packetRW.write.allocStart=0;{let e=n._packetRW.write.allocStartKEX,r=n._packetRW.write.alloc(t.length,!0);r.set(t,e),n._cipher.encrypt(n._packetRW.write.finalize(r,!0))}}function il(n,t){let e={kex:void 0,serverHostKey:void 0,cs:{cipher:void 0,mac:void 0,compress:void 0,lang:void 0},sc:{cipher:void 0,mac:void 0,compress:void 0,lang:void 0}};if($e.init(t,17),(e.kex=$e.readList())===void 0||(e.serverHostKey=$e.readList())===void 0||(e.cs.cipher=$e.readList())===void 0||(e.sc.cipher=$e.readList())===void 0||(e.cs.mac=$e.readList())===void 0||(e.sc.mac=$e.readList())===void 0||(e.cs.compress=$e.readList())===void 0||(e.sc.compress=$e.readList())===void 0||(e.cs.lang=$e.readList())===void 0||(e.sc.lang=$e.readList())===void 0)return $e.clear(),Ve(n,"Received malformed KEXINIT","handshake",Xe.KEY_EXCHANGE_FAILED);let r=$e.pos(),i=r<t.length&&t[r]===1;$e.clear();let s=n._offer,o=e,f=s.lists.kex.array;if(n._compatFlags&Wf.BAD_DHGEX){let X=!1;for(let H=0;H<f.length;++H)f[H].indexOf("group-exchange")!==-1&&(X||(X=!0,f=f.slice()),f.splice(H--,1))}let a,u,h,l=n._debug;for(l&&l("Inbound: Handshake in progress"),l&&l(`Handshake: (local) KEX method: ${f}`),l&&l(`Handshake: (remote) KEX method: ${o.kex}`),n._server?(u=f,a=o.kex):(u=o.kex,a=f),h=0;h<a.length&&u.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching key exchange algorithm"),Ve(n,"Handshake failed: no matching key exchange algorithm","handshake",Xe.KEY_EXCHANGE_FAILED);e.kex=a[h],l&&l(`Handshake: KEX algorithm: ${a[h]}`),i&&(!o.kex.length||a[h]!==o.kex[0])&&(n._skipNextInboundPacket=!0);let A=s.lists.serverHostKey.array;for(l&&l(`Handshake: (local) Host key format: ${A}`),l&&l(`Handshake: (remote) Host key format: ${o.serverHostKey}`),n._server?(u=A,a=o.serverHostKey):(u=o.serverHostKey,a=A),h=0;h<a.length&&u.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching host key format"),Ve(n,"Handshake failed: no matching host key format","handshake",Xe.KEY_EXCHANGE_FAILED);e.serverHostKey=a[h],l&&l(`Handshake: Host key format: ${a[h]}`);let p=s.lists.cs.cipher.array;for(l&&l(`Handshake: (local) C->S cipher: ${p}`),l&&l(`Handshake: (remote) C->S cipher: ${o.cs.cipher}`),n._server?(u=p,a=o.cs.cipher):(u=o.cs.cipher,a=p),h=0;h<a.length&&u.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching C->S cipher"),Ve(n,"Handshake failed: no matching C->S cipher","handshake",Xe.KEY_EXCHANGE_FAILED);e.cs.cipher=a[h],l&&l(`Handshake: C->S Cipher: ${a[h]}`);let y=s.lists.sc.cipher.array;for(l&&l(`Handshake: (local) S->C cipher: ${y}`),l&&l(`Handshake: (remote) S->C cipher: ${o.sc.cipher}`),n._server?(u=y,a=o.sc.cipher):(u=o.sc.cipher,a=y),h=0;h<a.length&&u.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching S->C cipher"),Ve(n,"Handshake failed: no matching S->C cipher","handshake",Xe.KEY_EXCHANGE_FAILED);e.sc.cipher=a[h],l&&l(`Handshake: S->C cipher: ${a[h]}`);let I=s.lists.cs.mac.array;if(l&&l(`Handshake: (local) C->S MAC: ${I}`),l&&l(`Handshake: (remote) C->S MAC: ${o.cs.mac}`),Dr[e.cs.cipher].authLen>0)e.cs.mac="",l&&l("Handshake: C->S MAC: <implicit>");else{for(n._server?(u=I,a=o.cs.mac):(u=o.cs.mac,a=I),h=0;h<a.length&&u.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching C->S MAC"),Ve(n,"Handshake failed: no matching C->S MAC","handshake",Xe.KEY_EXCHANGE_FAILED);e.cs.mac=a[h],l&&l(`Handshake: C->S MAC: ${a[h]}`)}let v=s.lists.sc.mac.array;if(l&&l(`Handshake: (local) S->C MAC: ${v}`),l&&l(`Handshake: (remote) S->C MAC: ${o.sc.mac}`),Dr[e.sc.cipher].authLen>0)e.sc.mac="",l&&l("Handshake: S->C MAC: <implicit>");else{for(n._server?(u=v,a=o.sc.mac):(u=o.sc.mac,a=v),h=0;h<a.length&&u.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching S->C MAC"),Ve(n,"Handshake failed: no matching S->C MAC","handshake",Xe.KEY_EXCHANGE_FAILED);e.sc.mac=a[h],l&&l(`Handshake: S->C MAC: ${a[h]}`)}let x=s.lists.cs.compress.array;for(l&&l(`Handshake: (local) C->S compression: ${x}`),l&&l(`Handshake: (remote) C->S compression: ${o.cs.compress}`),n._server?(u=x,a=o.cs.compress):(u=o.cs.compress,a=x),h=0;h<a.length&&u.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching C->S compression"),Ve(n,"Handshake failed: no matching C->S compression","handshake",Xe.KEY_EXCHANGE_FAILED);e.cs.compress=a[h],l&&l(`Handshake: C->S compression: ${a[h]}`);let O=s.lists.sc.compress.array;for(l&&l(`Handshake: (local) S->C compression: ${O}`),l&&l(`Handshake: (remote) S->C compression: ${o.sc.compress}`),n._server?(u=O,a=o.sc.compress):(u=o.sc.compress,a=O),h=0;h<a.length&&u.indexOf(a[h])===-1;++h);if(h===a.length)return l&&l("Handshake: No matching S->C compression"),Ve(n,"Handshake failed: no matching S->C compression","handshake",Xe.KEY_EXCHANGE_FAILED);e.sc.compress=a[h],l&&l(`Handshake: S->C compression: ${a[h]}`),e.cs.lang="",e.sc.lang="",n._kex&&(n._kexinit||rl(n),n._decipher._onPayload=sl.bind(n,{firstPacket:!1})),n._kex=dg(e,n,t),n._kex.start()}var dg=(()=>{function n(o){let f=0,a=o.length;for(;o[f]===0;)++f,--a;let u;return o[f]&128?(u=Buffer.allocUnsafe(1+a),u[0]=0,o.copy(u,1,f),o=u):a!==o.length&&(u=Buffer.allocUnsafe(a),o.copy(u,0,f),o=u),o}class t{constructor(f,a,u){this._protocol=a,this.sessionID=a._kex?a._kex.sessionID:void 0,this.negotiated=f,this._step=1,this._public=null,this._dh=null,this._sentNEWKEYS=!1,this._receivedNEWKEYS=!1,this._finished=!1,this._hostVerified=!1,this._kexinit=a._kexinit,this._remoteKexinit=u,this._identRaw=a._identRaw,this._remoteIdentRaw=a._remoteIdentRaw,this._hostKey=void 0,this._dhData=void 0,this._sig=void 0}finish(){if(this._finished)return!1;this._finished=!0;let f=this._protocol._server,a=this.negotiated,u=this.convertPublicKey(this._dhData),h=this.computeSecret(this._dhData);if(h instanceof Error)return h.message=`Error while computing DH secret (${this.type}): ${h.message}`,h.level="handshake",Ve(this._protocol,h,Xe.KEY_EXCHANGE_FAILED);let l=Kf(this.hashName);Sn(l,f?this._remoteIdentRaw:this._identRaw),Sn(l,f?this._identRaw:this._remoteIdentRaw),Sn(l,f?this._remoteKexinit:this._kexinit),Sn(l,f?this._kexinit:this._remoteKexinit);let A=f?this._hostKey.getPublicSSH():this._hostKey;if(Sn(l,A),this.type==="groupex"){let v=this.getDHParams(),x=Buffer.allocUnsafe(4);Tt(x,this._minBits,0),l.update(x),Tt(x,this._prefBits,0),l.update(x),Tt(x,this._maxBits,0),l.update(x),Sn(l,v.prime),Sn(l,v.generator)}Sn(l,f?u:this.getPublicKey());let p=f?this.getPublicKey():u;Sn(l,p),Sn(l,h);let y=l.digest();if(f){let v;switch(this.negotiated.serverHostKey){case"rsa-sha2-256":v="sha256";break;case"rsa-sha2-512":v="sha512";break}this._protocol._debug&&this._protocol._debug("Generating signature ...");let x=this._hostKey.sign(y,v);if(x instanceof Error)return Ve(this._protocol,`Handshake failed: signature generation failed for ${this._hostKey.type} host key: ${x.message}`,"handshake",Xe.KEY_EXCHANGE_FAILED);if(x=fg(x,this._hostKey.type),x===!1)return Ve(this._protocol,`Handshake failed: signature conversion failed for ${this._hostKey.type} host key`,"handshake",Xe.KEY_EXCHANGE_FAILED);let O=this.negotiated.serverHostKey,X=Buffer.byteLength(O),H=4+X+4+x.length,te=this._protocol._packetRW.write.allocStartKEX,ce=this._protocol._packetRW.write.alloc(1+4+A.length+4+p.length+4+H,!0);if(ce[te]=lt.KEXDH_REPLY,Tt(ce,A.length,++te),ce.set(A,te+=4),Tt(ce,p.length,te+=A.length),ce.set(p,te+=4),Tt(ce,H,te+=p.length),Tt(ce,X,te+=4),ce.utf8Write(O,te+=4,X),Tt(ce,x.length,te+=X),ce.set(x,te+=4),this._protocol._debug){let M;switch(this.type){case"group":M="KEXDH_REPLY";break;case"groupex":M="KEXDH_GEX_REPLY";break;default:M="KEXECDH_REPLY"}this._protocol._debug(`Outbound: Sending ${M}`)}this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(ce,!0))}else{$e.init(this._sig,0);let v=$e.readString(!0);if(!v)return Ve(this._protocol,"Malformed packet while reading signature","handshake",Xe.KEY_EXCHANGE_FAILED);if(v!==a.serverHostKey)return Ve(this._protocol,`Wrong signature type: ${v}, expected: ${a.serverHostKey}`,"handshake",Xe.KEY_EXCHANGE_FAILED);let x=$e.readString();if($e.clear(),x===void 0)return Ve(this._protocol,"Malformed packet while reading signature","handshake",Xe.KEY_EXCHANGE_FAILED);if(!(x=cg(x,v)))return Ve(this._protocol,"Malformed signature","handshake",Xe.KEY_EXCHANGE_FAILED);let O;{$e.init(this._hostKey,0);let te=$e.readString(!0),ce=this._hostKey.slice($e.pos());if($e.clear(),O=sg(ce,te),O instanceof Error)return O.level="handshake",Ve(this._protocol,O,Xe.KEY_EXCHANGE_FAILED)}let X;switch(this.negotiated.serverHostKey){case"rsa-sha2-256":X="sha256";break;case"rsa-sha2-512":X="sha512";break}this._protocol._debug&&this._protocol._debug("Verifying signature ...");let H=O.verify(y,x,X);if(H!==!0)return H instanceof Error?this._protocol._debug&&this._protocol._debug(`Signature verification failed: ${H.stack}`):this._protocol._debug&&this._protocol._debug("Signature verification failed"),Ve(this._protocol,"Handshake failed: signature verification failed","handshake",Xe.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Verified signature")}Mf(this);let I=()=>{this.sessionID||(this.sessionID=y);{let D=Buffer.allocUnsafe(4+h.length);Tt(D,h.length,0),D.set(h,4),h=D}let v=Dr[a.cs.cipher],x=Dr[a.sc.cipher],O=Ur(v.ivLen,this.hashName,h,y,this.sessionID,"A"),X=Ur(x.ivLen,this.hashName,h,y,this.sessionID,"B"),H=Ur(v.keyLen,this.hashName,h,y,this.sessionID,"C"),te=Ur(x.keyLen,this.hashName,h,y,this.sessionID,"D"),ce,M;v.authLen||(ce=Zu[a.cs.mac],M=Ur(ce.len,this.hashName,h,y,this.sessionID,"E"));let q,C;x.authLen||(q=Zu[a.sc.mac],C=Ur(q.len,this.hashName,h,y,this.sessionID,"F"));let T={inbound:{onPayload:this._protocol._onPayload,seqno:this._protocol._decipher.inSeqno,decipherInfo:f?v:x,decipherIV:f?O:X,decipherKey:f?H:te,macInfo:f?ce:q,macKey:f?M:C},outbound:{onWrite:this._protocol._onWrite,seqno:this._protocol._cipher.outSeqno,cipherInfo:f?x:v,cipherIV:f?X:O,cipherKey:f?te:H,macInfo:f?q:ce,macKey:f?C:M}};this._protocol._cipher&&this._protocol._cipher.free(),this._protocol._decipher&&this._protocol._decipher.free(),this._protocol._cipher=rg(T),this._protocol._decipher=ig(T);let F={read:void 0,write:void 0};switch(a.cs.compress){case"zlib":f?F.read=new Ls:F.write=new Ps(this._protocol);break;case"zlib@openssh.com":if(this._protocol._authenticated){f?F.read=new Ls:F.write=new Ps(this._protocol);break}default:f?F.read=new el:F.write=new tl(this._protocol)}switch(a.sc.compress){case"zlib":f?F.write=new Ps(this._protocol):F.read=new Ls;break;case"zlib@openssh.com":if(this._protocol._authenticated){f?F.write=new Ps(this._protocol):F.read=new Ls;break}default:f?F.write=new tl(this._protocol):F.read=new el}return this._protocol._packetRW.read.cleanup(),this._protocol._packetRW.write.cleanup(),this._protocol._packetRW=F,this._public=null,this._dh=null,this._kexinit=this._protocol._kexinit=void 0,this._remoteKexinit=void 0,this._identRaw=void 0,this._remoteIdentRaw=void 0,this._hostKey=void 0,this._dhData=void 0,this._sig=void 0,this._protocol._onHandshakeComplete(a),!1};if(!f)return I();this.finish=I}start(){if(!this._protocol._server){if(this._protocol._debug){let h;switch(this.type){case"group":h="KEXDH_INIT";break;default:h="KEXECDH_INIT"}this._protocol._debug(`Outbound: Sending ${h}`)}let f=this.getPublicKey(),a=this._protocol._packetRW.write.allocStartKEX,u=this._protocol._packetRW.write.alloc(1+4+f.length,!0);u[a]=lt.KEXDH_INIT,Tt(u,f.length,++a),u.set(f,a+=4),this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(u,!0))}}getPublicKey(){this.generateKeys();let f=this._public;if(f)return this.convertPublicKey(f)}convertPublicKey(f){let a,u=0,h=f.length;for(;f[u]===0;)++u,--h;return f[u]&128?(a=Buffer.allocUnsafe(1+h),a[0]=0,f.copy(a,1,u),a):(h!==f.length&&(a=Buffer.allocUnsafe(h),f.copy(a,0,u),f=a),f)}computeSecret(f){this.generateKeys();try{return n(this._dh.computeSecret(f))}catch(a){return a}}parse(f){let a=f[0];switch(this._step){case 1:if(this._protocol._server){if(a!==lt.KEXDH_INIT)return Ve(this._protocol,`Received packet ${a} instead of ${lt.KEXDH_INIT}`,"handshake",Xe.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Received DH Init"),$e.init(f,1);let u=$e.readString();if($e.clear(),u===void 0)return Ve(this._protocol,"Received malformed KEX*_INIT","handshake",Xe.KEY_EXCHANGE_FAILED);this._dhData=u;let h=this._protocol._hostKeys[this.negotiated.serverHostKey];Array.isArray(h)&&(h=h[0]),this._hostKey=h,this.finish()}else{if(a!==lt.KEXDH_REPLY)return Ve(this._protocol,`Received packet ${a} instead of ${lt.KEXDH_REPLY}`,"handshake",Xe.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Received DH Reply"),$e.init(f,1);let u,h,l;if((u=$e.readString())===void 0||(h=$e.readString())===void 0||(l=$e.readString())===void 0)return $e.clear(),Ve(this._protocol,"Received malformed KEX*_REPLY","handshake",Xe.KEY_EXCHANGE_FAILED);$e.clear(),$e.init(u,0);let A=$e.readString(!0);if($e.clear(),A===void 0)return Ve(this._protocol,"Received malformed host public key","handshake",Xe.KEY_EXCHANGE_FAILED);if(A!==this.negotiated.serverHostKey)switch(this.negotiated.serverHostKey){case"rsa-sha2-256":case"rsa-sha2-512":if(A==="ssh-rsa")break;default:return Ve(this._protocol,"Host key does not match negotiated type","handshake",Xe.KEY_EXCHANGE_FAILED)}this._hostKey=u,this._dhData=h,this._sig=l;let p=!1,y;if(this._protocol._hostVerifier===void 0?(y=!0,this._protocol._debug&&this._protocol._debug("Host accepted by default (no verification)")):y=this._protocol._hostVerifier(u,I=>{if(!p){if(p=!0,I===!1)return this._protocol._debug&&this._protocol._debug("Host denied (verification failed)"),Ve(this._protocol,"Host denied (verification failed)","handshake",Xe.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Host accepted (verified)"),this._hostVerified=!0,this._receivedNEWKEYS?this.finish():Mf(this)}}),y===void 0){++this._step;return}if(p=!0,y===!1)return this._protocol._debug&&this._protocol._debug("Host denied (verification failed)"),Ve(this._protocol,"Host denied (verification failed)","handshake",Xe.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Host accepted (verified)"),this._hostVerified=!0,Mf(this)}++this._step;break;case 2:return a!==lt.NEWKEYS?Ve(this._protocol,`Received packet ${a} instead of ${lt.NEWKEYS}`,"handshake",Xe.KEY_EXCHANGE_FAILED):(this._protocol._debug&&this._protocol._debug("Inbound: NEWKEYS"),this._receivedNEWKEYS=!0,++this._step,this._protocol._server||this._hostVerified?this.finish():!1);default:return Ve(this._protocol,`Received unexpected packet ${a} after NEWKEYS`,"handshake",Xe.KEY_EXCHANGE_FAILED)}}}class e extends t{constructor(f,...a){super(...a),this.type="25519",this.hashName=f,this._keys=null}generateKeys(){this._keys||(this._keys=J_("x25519"))}getPublicKey(){return this.generateKeys(),this._keys.publicKey.export({type:"spki",format:"der"}).slice(-32)}convertPublicKey(f){let a,u=0,h=f.length;for(;f[u]===0;)++u,--h;return f.length===32||h!==f.length&&(a=Buffer.allocUnsafe(h),f.copy(a,0,u),f=a),f}computeSecret(f){this.generateKeys();try{let a=new Xu.Writer;return a.startSequence(),a.startSequence(),a.writeOID("1.3.101.110"),a.endSequence(),a.startSequence(Xu.BitString),a.writeByte(0),a._ensure(f.length),f.copy(a._buf,a._offset,0,f.length),a._offset+=f.length,a.endSequence(),a.endSequence(),n(z_({privateKey:this._keys.privateKey,publicKey:V_({key:a.buffer,type:"spki",format:"der"})}))}catch(a){return a}}}class r extends t{constructor(f,a,...u){super(...u),this.type="ecdh",this.curveName=f,this.hashName=a}generateKeys(){this._dh||(this._dh=X_(this.curveName),this._public=this._dh.generateKeys())}}class i extends t{constructor(f,...a){super(...a),this.type="groupex",this.hashName=f,this._prime=null,this._generator=null,this._minBits=ug,this._prefBits=Ag(this.negotiated),this._protocol._compatFlags&Wf.BUG_DHGEX_LARGE&&(this._prefBits=Math.min(this._prefBits,4096)),this._maxBits=lg}start(){if(this._protocol._server)return;this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_GEX_REQUEST");let f=this._protocol._packetRW.write.allocStartKEX,a=this._protocol._packetRW.write.alloc(1+4+4+4,!0);a[f]=lt.KEXDH_GEX_REQUEST,Tt(a,this._minBits,++f),Tt(a,this._prefBits,f+=4),Tt(a,this._maxBits,f+=4),this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(a,!0))}generateKeys(){!this._dh&&this._prime&&this._generator&&(this._dh=Y_(this._prime,this._generator),this._public=this._dh.generateKeys())}setDHParams(f,a){if(!Buffer.isBuffer(f))throw new Error("Invalid prime value");if(!Buffer.isBuffer(a))throw new Error("Invalid generator value");this._prime=f,this._generator=a}getDHParams(){if(this._dh)return{prime:n(this._dh.getPrime()),generator:n(this._dh.getGenerator())}}parse(f){let a=f[0];switch(this._step){case 1:if(this._protocol._server)return a!==lt.KEXDH_GEX_REQUEST?Ve(this._protocol,`Received packet ${a} instead of `+lt.KEXDH_GEX_REQUEST,"handshake",Xe.KEY_EXCHANGE_FAILED):Ve(this._protocol,"Group exchange not implemented for server","handshake",Xe.KEY_EXCHANGE_FAILED);if(a!==lt.KEXDH_GEX_GROUP)return Ve(this._protocol,`Received packet ${a} instead of ${lt.KEXDH_GEX_GROUP}`,"handshake",Xe.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Received DH GEX Group"),$e.init(f,1);let u,h;if((u=$e.readString())===void 0||(h=$e.readString())===void 0)return $e.clear(),Ve(this._protocol,"Received malformed KEXDH_GEX_GROUP","handshake",Xe.KEY_EXCHANGE_FAILED);$e.clear(),this.setDHParams(u,h),this.generateKeys();let l=this.getPublicKey();this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_GEX_INIT");let A=this._protocol._packetRW.write.allocStartKEX,p=this._protocol._packetRW.write.alloc(1+4+l.length,!0);p[A]=lt.KEXDH_GEX_INIT,Tt(p,l.length,++A),p.set(l,A+=4),this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(p,!0)),++this._step;break;case 2:if(this._protocol._server)return a!==lt.KEXDH_GEX_INIT?Ve(this._protocol,`Received packet ${a} instead of ${lt.KEXDH_GEX_INIT}`,"handshake",Xe.KEY_EXCHANGE_FAILED):(this._protocol._debug&&this._protocol._debug("Received DH GEX Init"),Ve(this._protocol,"Group exchange not implemented for server","handshake",Xe.KEY_EXCHANGE_FAILED));if(a!==lt.KEXDH_GEX_REPLY)return Ve(this._protocol,`Received packet ${a} instead of ${lt.KEXDH_GEX_REPLY}`,"handshake",Xe.KEY_EXCHANGE_FAILED);this._protocol._debug&&this._protocol._debug("Received DH GEX Reply"),this._step=1,f[0]=lt.KEXDH_REPLY,this.parse=t.prototype.parse,this.parse(f)}}}class s extends t{constructor(f,a,...u){super(...u),this.type="group",this.groupName=f,this.hashName=a}start(){if(!this._protocol._server){this._protocol._debug&&this._protocol._debug("Outbound: Sending KEXDH_INIT");let f=this.getPublicKey(),a=this._protocol._packetRW.write.allocStartKEX,u=this._protocol._packetRW.write.alloc(1+4+f.length,!0);u[a]=lt.KEXDH_INIT,Tt(u,f.length,++a),u.set(f,a+=4),this._protocol._cipher.encrypt(this._protocol._packetRW.write.finalize(u,!0))}}generateKeys(){this._dh||(this._dh=j_(this.groupName),this._public=this._dh.generateKeys())}getDHParams(){if(this._dh)return{prime:n(this._dh.getPrime()),generator:n(this._dh.getGenerator())}}}return(o,...f)=>{if(typeof o!="object"||o===null)throw new Error("Invalid negotiated argument");let a=o.kex;if(typeof a=="string"){switch(f=[o,...f],a){case"curve25519-sha256":case"curve25519-sha256@libssh.org":if(!eg)break;return new e("sha256",...f);case"ecdh-sha2-nistp256":return new r("prime256v1","sha256",...f);case"ecdh-sha2-nistp384":return new r("secp384r1","sha384",...f);case"ecdh-sha2-nistp521":return new r("secp521r1","sha512",...f);case"diffie-hellman-group1-sha1":return new s("modp2","sha1",...f);case"diffie-hellman-group14-sha1":return new s("modp14","sha1",...f);case"diffie-hellman-group14-sha256":return new s("modp14","sha256",...f);case"diffie-hellman-group15-sha512":return new s("modp15","sha512",...f);case"diffie-hellman-group16-sha512":return new s("modp16","sha512",...f);case"diffie-hellman-group17-sha512":return new s("modp17","sha512",...f);case"diffie-hellman-group18-sha512":return new s("modp18","sha512",...f);case"diffie-hellman-group-exchange-sha1":return new i("sha1",...f);case"diffie-hellman-group-exchange-sha256":return new i("sha256",...f)}throw new Error(`Unsupported key exchange algorithm: ${a}`)}throw new Error(`Invalid key exchange type: ${a}`)}})(),nl=(()=>{let n=["kex","serverHostKey",["cs","cipher"],["sc","cipher"],["cs","mac"],["sc","mac"],["cs","compress"],["sc","compress"],["cs","lang"],["sc","lang"]];return class{constructor(e){if(typeof e!="object"||e===null)throw new TypeError("Argument must be an object");let r={kex:void 0,serverHostKey:void 0,cs:{cipher:void 0,mac:void 0,compress:void 0,lang:void 0},sc:{cipher:void 0,mac:void 0,compress:void 0,lang:void 0},all:void 0},i=0;for(let f of n){let a,u,h,l;if(typeof f=="string")a=r,u=e[f],h=l=f;else{let p=f[0];a=r[p],l=f[1],u=e[p][l],h=`${p}.${l}`}let A={array:void 0,buffer:void 0};if(Buffer.isBuffer(u))A.array=(""+u).split(","),A.buffer=u,i+=4+u.length;else{if(typeof u=="string"&&(u=u.split(",")),Array.isArray(u))A.array=u,A.buffer=Buffer.from(u.join(","));else throw new TypeError(`Invalid \`${h}\` type: ${typeof u}`);i+=4+A.buffer.length}a[l]=A}let s=Buffer.allocUnsafe(i);r.all=s;let o=0;for(let f of n){let a;typeof f=="string"?a=r[f].buffer:a=r[f[0]][f[1]].buffer,o=Tt(s,a.length,o),s.set(a,o),o+=a.length}this.totalSize=i,this.lists=r}copyAllTo(e,r){let i=this.lists.all;if(typeof r!="number")throw new TypeError(`Invalid offset value: ${typeof r}`);if(e.length-r<i.length)throw new Error("Insufficient space to copy list");return e.set(i,r),i.length}}})(),Sn=(()=>{let n=Buffer.allocUnsafe(4);return(t,e)=>{Tt(n,e.length,0),t.update(n),t.update(e)}})();function Ur(n,t,e,r,i,s){let o;if(n){let f=Kf(t).update(e).update(r).update(s).update(i).digest();for(;f.length<n;){let a=Kf(t).update(e).update(r).update(f).digest(),u=Buffer.allocUnsafe(f.length+a.length);u.set(f,0),u.set(a,f.length),f=u}f.length===n?o=f:o=new ag(f.buffer,f.byteOffset,n)}else o=hg;return o}function sl(n,t){if(t.length===0){this._debug&&this._debug("Inbound: Skipping empty packet payload");return}if(this._skipNextInboundPacket){this._skipNextInboundPacket=!1;return}t=this._packetRW.read.read(t);let e=t[0];switch(e){case lt.DISCONNECT:case lt.IGNORE:case lt.UNIMPLEMENTED:case lt.DEBUG:return qf||(qf=Ff()),qf[e](this,t);case lt.KEXINIT:return n.firstPacket?(n.firstPacket=!1,il(this,t)):Ve(this,"Received extra KEXINIT during handshake","handshake",Xe.KEY_EXCHANGE_FAILED);default:if(e<20||e>49)return Ve(this,`Received unexpected packet type ${e}`,"handshake",Xe.KEY_EXCHANGE_FAILED)}return this._kex.parse(t)}function Ag(n){let t=Dr[n.cs.cipher],e=Dr[n.sc.cipher],r=Math.max(0,t.sslName==="des-ede3-cbc"?14:t.keyLen,t.blockLen,t.ivLen,e.sslName==="des-ede3-cbc"?14:e.keyLen,e.blockLen,e.ivLen)*8;return r<=112?2048:r<=128?3072:r<=192?7680:8192}function Mf(n){if(!n._sentNEWKEYS){n._protocol._debug&&n._protocol._debug("Outbound: Sending NEWKEYS");let t=n._protocol._packetRW.write.allocStartKEX,e=n._protocol._packetRW.write.alloc(1,!0);e[t]=lt.NEWKEYS,n._protocol._cipher.encrypt(n._protocol._packetRW.write.finalize(e,!0)),n._sentNEWKEYS=!0}}ol.exports={KexInit:nl,kexinit:rl,onKEXPayload:sl,DEFAULT_KEXINIT:new nl({kex:tg,serverHostKey:ng,cs:{cipher:Vu,mac:zu,compress:Ju,lang:[]},sc:{cipher:Vu,mac:zu,compress:Ju,lang:[]}}),HANDLERS:{[lt.KEXINIT]:il}}});var fl=_e((Ob,_g)=>{_g.exports={name:"ssh2",version:"1.11.0",author:"Brian White <mscdex@mscdex.net>",description:"SSH2 client and server modules written in pure JavaScript for node.js",main:"./lib/index.js",engines:{node:">=10.16.0"},dependencies:{asn1:"^0.2.4","bcrypt-pbkdf":"^1.0.2"},devDependencies:{"@mscdex/eslint-config":"^1.1.0",eslint:"^7.0.0"},optionalDependencies:{"cpu-features":"~0.0.4",nan:"^2.16.0"},scripts:{install:"node install.js",rebuild:"node install.js",test:"node test/test.js",lint:"eslint --cache --report-unused-disable-directives --ext=.js .eslintrc.js examples lib test","lint:fix":"npm run lint -- --fix"},keywords:["ssh","ssh2","sftp","secure","shell","exec","remote","client"],licenses:[{type:"MIT",url:"http://github.com/mscdex/ssh2/raw/master/LICENSE"}],repository:{type:"git",url:"http://github.com/mscdex/ssh2.git"}}});var jf=_e((Lb,Il)=>{"use strict";var{inspect:dl}=require("util"),{bindingAvailable:gg,NullCipher:Eg,NullDecipher:pg}=fr(),{COMPAT_CHECKS:bg,DISCONNECT_REASON:Al,MESSAGE:ye,SIGNALS:al,TERMINAL_MODE:$f}=Ln(),{DEFAULT_KEXINIT:Ig,KexInit:cl,kexinit:_l,onKEXPayload:yg}=Os(),{parseKey:ul}=jn(),xg=Ff(),{bufferCopy:Us,bufferFill:wg,bufferSlice:gl,convertSignature:ll,sendPacket:we,writeUInt32BE:m}=An(),{PacketReader:Sg,PacketWriter:mg,ZlibPacketReader:El,ZlibPacketWriter:pl}=Df(),Cg=fl().version,Rg=new Map(Object.values(Al).map(n=>[n,1])),bl=Buffer.from(`SSH-2.0-ssh2js${Cg}`),Bg=Buffer.from(`${bl}\r
`),vg=8192,Ng=1024,hl=Buffer.from([ye.GLOBAL_REQUEST,0,0,0,21,107,101,101,112,97,108,105,118,101,64,111,112,101,110,115,115,104,46,99,111,109,1]),kg=Buffer.from([$f.TTY_OP_END]);function Gf(){}var Yf=class{constructor(t){let e=t.onWrite;if(typeof e!="function")throw new Error("Missing onWrite function");this._onWrite=A=>{e(A)};let r=t.onError;if(typeof r!="function")throw new Error("Missing onError function");this._onError=A=>{r(A)};let i=t.debug;this._debug=typeof i=="function"?A=>{i(A)}:void 0;let s=t.onHeader;this._onHeader=typeof s=="function"?(...A)=>{s(...A)}:Gf;let o=t.onPacket;this._onPacket=typeof o=="function"?()=>{o()}:Gf;let f=t.onHandshakeComplete;typeof f!="function"&&(f=Gf),this._onHandshakeComplete=(...A)=>{this._debug&&this._debug("Handshake completed");let p=this._queue;if(p){this._queue=void 0,this._debug&&this._debug(`Draining outbound queue (${p.length}) ...`);for(let y=0;y<p.length;++y){let I=p[y],v=this._packetRW.write.finalize(I);if(v===I){let x=this._cipher.allocPacket(I.length);x.set(I,5),v=x}we(this,v)}this._debug&&this._debug("... finished draining outbound queue")}f(...A)},this._queue=void 0;let a=t.messageHandlers;typeof a=="object"&&a!==null?this._handlers=a:this._handlers={},this._onPayload=Pg.bind(this),this._server=!!t.server,this._banner=void 0;let u;if(this._server){if(typeof t.hostKeys!="object"||t.hostKeys===null)throw new Error("Missing server host key(s)");this._hostKeys=t.hostKeys,typeof t.greeting=="string"&&t.greeting.length&&(u=t.greeting.slice(-2)===`\r
`?t.greeting:`${t.greeting}\r
`),typeof t.banner=="string"&&t.banner.length&&(this._banner=t.banner.slice(-2)===`\r
`?t.banner:`${t.banner}\r
`)}else this._hostKeys=void 0;let h=t.offer;typeof h!="object"||h===null?h=Ig:h.constructor!==cl&&(h=new cl(h)),this._kex=void 0,this._kexinit=void 0,this._offer=h,this._cipher=new Eg(0,this._onWrite),this._decipher=void 0,this._skipNextInboundPacket=!1,this._packetRW={read:new Sg,write:new mg(this)},this._hostVerifier=!this._server&&typeof t.hostVerifier=="function"?t.hostVerifier:void 0,this._parse=Og,this._buffer=void 0,this._authsQueue=[],this._authenticated=!1,this._remoteIdentRaw=void 0;let l;if(typeof t.ident=="string")this._identRaw=Buffer.from(`SSH-2.0-${t.ident}`),l=Buffer.allocUnsafe(this._identRaw.length+2),l.set(this._identRaw,0),l[l.length-2]=13,l[l.length-1]=10;else if(Buffer.isBuffer(t.ident)){let A=Buffer.allocUnsafe(8+t.ident.length);A.latin1Write("SSH-2.0-",0,8),A.set(t.ident,8),this._identRaw=A,l=Buffer.allocUnsafe(A.length+2),l.set(A,0),l[l.length-2]=13,l[l.length-1]=10}else this._identRaw=bl,l=Bg;this._compatFlags=0,this._debug&&(gg?this._debug("Custom crypto binding available"):this._debug("Custom crypto binding not available")),this._debug&&this._debug(`Local ident: ${dl(this._identRaw.toString())}`),this.start=()=>{this.start=void 0,u&&this._onWrite(u),this._onWrite(l)}}_destruct(t){this._packetRW.read.cleanup(),this._packetRW.write.cleanup(),this._cipher&&this._cipher.free(),this._decipher&&this._decipher.free(),(typeof t!="string"||t.length===0)&&(t="fatal error"),this.parse=()=>{throw new Error(`Instance unusable after ${t}`)},this._onWrite=()=>{throw new Error(`Instance unusable after ${t}`)},this._destruct=void 0}cleanup(){this._destruct&&this._destruct()}parse(t,e,r){for(;e<r;)e=this._parse(t,e,r)}disconnect(t){let r=this._packetRW.write.allocStartKEX,i=this._packetRW.write.alloc(13,!0),s=r+13;Rg.has(t)||(t=Al.PROTOCOL_ERROR),i[r]=ye.DISCONNECT,m(i,t,++r),i.fill(0,r+=4,s),this._debug&&this._debug(`Outbound: Sending DISCONNECT (${t})`),we(this,this._packetRW.write.finalize(i,!0),!0)}ping(){let t=this._packetRW.write.allocStart,e=this._packetRW.write.alloc(hl.length);e.set(hl,t),this._debug&&this._debug("Outbound: Sending ping (GLOBAL_REQUEST: keepalive@openssh.com)"),we(this,this._packetRW.write.finalize(e))}rekey(){this._kexinit===void 0?(this._debug&&this._debug("Outbound: Initiated explicit rekey"),this._queue=[],_l(this)):this._debug&&this._debug("Outbound: Ignoring rekey during handshake")}requestSuccess(t){let e=this._packetRW.write.allocStart,r;Buffer.isBuffer(t)?(r=this._packetRW.write.alloc(1+t.length),r[e]=ye.REQUEST_SUCCESS,r.set(t,++e)):(r=this._packetRW.write.alloc(1),r[e]=ye.REQUEST_SUCCESS),this._debug&&this._debug("Outbound: Sending REQUEST_SUCCESS"),we(this,this._packetRW.write.finalize(r))}requestFailure(){let t=this._packetRW.write.allocStart,e=this._packetRW.write.alloc(1);e[t]=ye.REQUEST_FAILURE,this._debug&&this._debug("Outbound: Sending REQUEST_FAILURE"),we(this,this._packetRW.write.finalize(e))}channelSuccess(t){let e=this._packetRW.write.allocStart,r=this._packetRW.write.alloc(1+4);r[e]=ye.CHANNEL_SUCCESS,m(r,t,++e),this._debug&&this._debug(`Outbound: Sending CHANNEL_SUCCESS (r:${t})`),we(this,this._packetRW.write.finalize(r))}channelFailure(t){let e=this._packetRW.write.allocStart,r=this._packetRW.write.alloc(1+4);r[e]=ye.CHANNEL_FAILURE,m(r,t,++e),this._debug&&this._debug(`Outbound: Sending CHANNEL_FAILURE (r:${t})`),we(this,this._packetRW.write.finalize(r))}channelEOF(t){let e=this._packetRW.write.allocStart,r=this._packetRW.write.alloc(1+4);r[e]=ye.CHANNEL_EOF,m(r,t,++e),this._debug&&this._debug(`Outbound: Sending CHANNEL_EOF (r:${t})`),we(this,this._packetRW.write.finalize(r))}channelClose(t){let e=this._packetRW.write.allocStart,r=this._packetRW.write.alloc(1+4);r[e]=ye.CHANNEL_CLOSE,m(r,t,++e),this._debug&&this._debug(`Outbound: Sending CHANNEL_CLOSE (r:${t})`),we(this,this._packetRW.write.finalize(r))}channelWindowAdjust(t,e){let r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+4);i[r]=ye.CHANNEL_WINDOW_ADJUST,m(i,t,++r),m(i,e,r+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_WINDOW_ADJUST (r:${t}, ${e})`),we(this,this._packetRW.write.finalize(i))}channelData(t,e){let r=Buffer.isBuffer(e),i=r?e.length:Buffer.byteLength(e),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+4+i);o[s]=ye.CHANNEL_DATA,m(o,t,++s),m(o,i,s+=4),r?o.set(e,s+=4):o.utf8Write(e,s+=4,i),this._debug&&this._debug(`Outbound: Sending CHANNEL_DATA (r:${t}, ${i})`),we(this,this._packetRW.write.finalize(o))}channelExtData(t,e,r){let i=Buffer.isBuffer(e),s=i?e.length:Buffer.byteLength(e),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(1+4+4+4+s);f[o]=ye.CHANNEL_EXTENDED_DATA,m(f,t,++o),m(f,r,o+=4),m(f,s,o+=4),i?f.set(e,o+=4):f.utf8Write(e,o+=4,s),this._debug&&this._debug(`Outbound: Sending CHANNEL_EXTENDED_DATA (r:${t})`),we(this,this._packetRW.write.finalize(f))}channelOpenConfirm(t,e,r,i){let s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+4+4+4);o[s]=ye.CHANNEL_OPEN_CONFIRMATION,m(o,t,++s),m(o,e,s+=4),m(o,r,s+=4),m(o,i,s+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN_CONFIRMATION (r:${t}, l:${e})`),we(this,this._packetRW.write.finalize(o))}channelOpenFail(t,e,r){typeof r!="string"&&(r="");let i=Buffer.byteLength(r),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+4+4+i+4);o[s]=ye.CHANNEL_OPEN_FAILURE,m(o,t,++s),m(o,e,s+=4),m(o,i,s+=4),s+=4,i&&(o.utf8Write(r,s,i),s+=i),m(o,0,s),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN_FAILURE (r:${t})`),we(this,this._packetRW.write.finalize(o))}service(t){if(this._server)throw new Error("Client-only method called in server mode");let e=Buffer.byteLength(t),r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+e);i[r]=ye.SERVICE_REQUEST,m(i,e,++r),i.utf8Write(t,r+=4,e),this._debug&&this._debug(`Outbound: Sending SERVICE_REQUEST (${t})`),we(this,this._packetRW.write.finalize(i))}authPassword(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(t),s=Buffer.byteLength(e),o=r?Buffer.byteLength(r):0,f=this._packetRW.write.allocStart,a=this._packetRW.write.alloc(1+4+i+4+14+4+8+1+4+s+(r?4+o:0));a[f]=ye.USERAUTH_REQUEST,m(a,i,++f),a.utf8Write(t,f+=4,i),m(a,14,f+=i),a.utf8Write("ssh-connection",f+=4,14),m(a,8,f+=14),a.utf8Write("password",f+=4,8),a[f+=8]=r?1:0,m(a,s,++f),Buffer.isBuffer(e)?Us(e,a,0,s,f+=4):a.utf8Write(e,f+=4,s),r?(m(a,o,f+=s),Buffer.isBuffer(r)?Us(r,a,0,o,f+=4):a.utf8Write(r,f+=4,o),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (changed password)")):this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (password)"),this._authsQueue.push("password"),we(this,this._packetRW.write.finalize(a))}authPK(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");if(e=ul(e),e instanceof Error)throw new Error("Invalid key");let i=e.type;e=e.getPublicSSH();let s=Buffer.byteLength(t),o=Buffer.byteLength(i),f=e.length,a=this._kex.sessionID,u=a.length,h=(r?4+u:0)+1+4+s+4+14+4+9+1+4+o+4+f,l,A;if(r?(l=Buffer.allocUnsafe(h),A=0,m(l,u,A),l.set(a,A+=4),A+=u):(l=this._packetRW.write.alloc(h),A=this._packetRW.write.allocStart),l[A]=ye.USERAUTH_REQUEST,m(l,s,++A),l.utf8Write(t,A+=4,s),m(l,14,A+=s),l.utf8Write("ssh-connection",A+=4,14),m(l,9,A+=14),l.utf8Write("publickey",A+=4,9),l[A+=9]=r?1:0,m(l,o,++A),l.utf8Write(i,A+=4,o),m(l,f,A+=o),l.set(e,A+=4),!r){this._authsQueue.push("publickey"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (publickey -- check)"),we(this,this._packetRW.write.finalize(l));return}r(l,p=>{if(p=ll(p,i),p===!1)throw new Error("Error while converting handshake signature");let y=p.length;A=this._packetRW.write.allocStart,l=this._packetRW.write.alloc(1+4+s+4+14+4+9+1+4+o+4+f+4+4+o+4+y),l[A]=ye.USERAUTH_REQUEST,m(l,s,++A),l.utf8Write(t,A+=4,s),m(l,14,A+=s),l.utf8Write("ssh-connection",A+=4,14),m(l,9,A+=14),l.utf8Write("publickey",A+=4,9),l[A+=9]=1,m(l,o,++A),l.utf8Write(i,A+=4,o),m(l,f,A+=o),l.set(e,A+=4),m(l,4+o+4+y,A+=f),m(l,o,A+=4),l.utf8Write(i,A+=4,o),m(l,y,A+=o),l.set(p,A+=4),this._authsQueue.push("publickey"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (publickey)"),we(this,this._packetRW.write.finalize(l))})}authHostbased(t,e,r,i,s){if(this._server)throw new Error("Client-only method called in server mode");if(e=ul(e),e instanceof Error)throw new Error("Invalid key");let o=e.type;e=e.getPublicSSH();let f=Buffer.byteLength(t),a=Buffer.byteLength(o),u=e.length,h=this._kex.sessionID,l=h.length,A=Buffer.byteLength(r),p=Buffer.byteLength(i),y=Buffer.allocUnsafe(4+l+1+4+f+4+14+4+9+4+a+4+u+4+A+4+p),I=0;m(y,l,I),y.set(h,I+=4),y[I+=l]=ye.USERAUTH_REQUEST,m(y,f,++I),y.utf8Write(t,I+=4,f),m(y,14,I+=f),y.utf8Write("ssh-connection",I+=4,14),m(y,9,I+=14),y.utf8Write("hostbased",I+=4,9),m(y,a,I+=9),y.utf8Write(o,I+=4,a),m(y,u,I+=a),y.set(e,I+=4),m(y,A,I+=u),y.utf8Write(r,I+=4,A),m(y,p,I+=A),y.utf8Write(i,I+=4,p),s(y,v=>{if(v=ll(v,o),!v)throw new Error("Error while converting handshake signature");let x=v.length,O=y.length-l-4;I=this._packetRW.write.allocStart;let X=this._packetRW.write.alloc(O+4+4+a+4+x);Us(y,X,4+l,y.length,I),m(X,4+a+4+x,I+=O),m(X,a,I+=4),X.utf8Write(o,I+=4,a),m(X,x,I+=a),X.set(v,I+=4),this._authsQueue.push("hostbased"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (hostbased)"),we(this,this._packetRW.write.finalize(X))})}authKeyboard(t){if(this._server)throw new Error("Client-only method called in server mode");let e=Buffer.byteLength(t),r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+e+4+14+4+20+4+4);i[r]=ye.USERAUTH_REQUEST,m(i,e,++r),i.utf8Write(t,r+=4,e),m(i,14,r+=e),i.utf8Write("ssh-connection",r+=4,14),m(i,20,r+=14),i.utf8Write("keyboard-interactive",r+=4,20),m(i,0,r+=20),m(i,0,r+=4),this._authsQueue.push("keyboard-interactive"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (keyboard-interactive)"),we(this,this._packetRW.write.finalize(i))}authNone(t){if(this._server)throw new Error("Client-only method called in server mode");let e=Buffer.byteLength(t),r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+e+4+14+4+4);i[r]=ye.USERAUTH_REQUEST,m(i,e,++r),i.utf8Write(t,r+=4,e),m(i,14,r+=e),i.utf8Write("ssh-connection",r+=4,14),m(i,4,r+=14),i.utf8Write("none",r+=4,4),this._authsQueue.push("none"),this._debug&&this._debug("Outbound: Sending USERAUTH_REQUEST (none)"),we(this,this._packetRW.write.finalize(i))}authInfoRes(t){if(this._server)throw new Error("Client-only method called in server mode");let e=0,r;if(t){r=new Array(t.length);for(let o=0;o<t.length;++o){let f=Buffer.byteLength(t[o]);r[o]=f,e+=4+f}}let i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(1+4+e);if(s[i]=ye.USERAUTH_INFO_RESPONSE,t){m(s,t.length,++i),i+=4;for(let o=0;o<t.length;++o){let f=r[o];m(s,f,i),i+=4,f&&(s.utf8Write(t[o],i,f),i+=f)}}else m(s,0,++i);this._debug&&this._debug("Outbound: Sending USERAUTH_INFO_RESPONSE"),we(this,this._packetRW.write.finalize(s))}tcpipForward(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(t),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+13+1+4+i+4);o[s]=ye.GLOBAL_REQUEST,m(o,13,++s),o.utf8Write("tcpip-forward",s+=4,13),o[s+=13]=r===void 0||r===!0?1:0,m(o,i,++s),o.utf8Write(t,s+=4,i),m(o,e,s+=i),this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (tcpip-forward)"),we(this,this._packetRW.write.finalize(o))}cancelTcpipForward(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(t),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+20+1+4+i+4);o[s]=ye.GLOBAL_REQUEST,m(o,20,++s),o.utf8Write("cancel-tcpip-forward",s+=4,20),o[s+=20]=r===void 0||r===!0?1:0,m(o,i,++s),o.utf8Write(t,s+=4,i),m(o,e,s+=i),this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (cancel-tcpip-forward)"),we(this,this._packetRW.write.finalize(o))}openssh_streamLocalForward(t,e){if(this._server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(1+4+31+1+4+r);s[i]=ye.GLOBAL_REQUEST,m(s,31,++i),s.utf8Write("streamlocal-forward@openssh.com",i+=4,31),s[i+=31]=e===void 0||e===!0?1:0,m(s,r,++i),s.utf8Write(t,i+=4,r),this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (streamlocal-forward@openssh.com)"),we(this,this._packetRW.write.finalize(s))}openssh_cancelStreamLocalForward(t,e){if(this._server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(1+4+38+1+4+r);s[i]=ye.GLOBAL_REQUEST,m(s,38,++i),s.utf8Write("cancel-streamlocal-forward@openssh.com",i+=4,38),s[i+=38]=e===void 0||e===!0?1:0,m(s,r,++i),s.utf8Write(t,i+=4,r),this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (cancel-streamlocal-forward@openssh.com)"),we(this,this._packetRW.write.finalize(s))}directTcpip(t,e,r,i){if(this._server)throw new Error("Client-only method called in server mode");let s=Buffer.byteLength(i.srcIP),o=Buffer.byteLength(i.dstIP),f=this._packetRW.write.allocStart,a=this._packetRW.write.alloc(1+4+12+4+4+4+4+s+4+4+o+4);a[f]=ye.CHANNEL_OPEN,m(a,12,++f),a.utf8Write("direct-tcpip",f+=4,12),m(a,t,f+=12),m(a,e,f+=4),m(a,r,f+=4),m(a,o,f+=4),a.utf8Write(i.dstIP,f+=4,o),m(a,i.dstPort,f+=o),m(a,s,f+=4),a.utf8Write(i.srcIP,f+=4,s),m(a,i.srcPort,f+=s),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, direct-tcpip)`),we(this,this._packetRW.write.finalize(a))}openssh_directStreamLocal(t,e,r,i){if(this._server)throw new Error("Client-only method called in server mode");let s=Buffer.byteLength(i.socketPath),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(1+4+30+4+4+4+4+s+4+4);f[o]=ye.CHANNEL_OPEN,m(f,30,++o),f.utf8Write("direct-streamlocal@openssh.com",o+=4,30),m(f,t,o+=30),m(f,e,o+=4),m(f,r,o+=4),m(f,s,o+=4),f.utf8Write(i.socketPath,o+=4,s),wg(f,0,o+=s,o+8),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, direct-streamlocal@openssh.com)`),we(this,this._packetRW.write.finalize(f))}openssh_noMoreSessions(t){if(this._server)throw new Error("Client-only method called in server mode");let e=this._packetRW.write.allocStart,r=this._packetRW.write.alloc(1+4+28+1);r[e]=ye.GLOBAL_REQUEST,m(r,28,++e),r.utf8Write("no-more-sessions@openssh.com",e+=4,28),r[e+=28]=t===void 0||t===!0?1:0,this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (no-more-sessions@openssh.com)"),we(this,this._packetRW.write.finalize(r))}session(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(1+4+7+4+4+4);s[i]=ye.CHANNEL_OPEN,m(s,7,++i),s.utf8Write("session",i+=4,7),m(s,t,i+=7),m(s,e,i+=4),m(s,r,i+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, session)`),we(this,this._packetRW.write.finalize(s))}windowChange(t,e,r,i,s){if(this._server)throw new Error("Client-only method called in server mode");let o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(1+4+4+13+1+4+4+4+4);f[o]=ye.CHANNEL_REQUEST,m(f,t,++o),m(f,13,o+=4),f.utf8Write("window-change",o+=4,13),f[o+=13]=0,m(f,r,++o),m(f,e,o+=4),m(f,s,o+=4),m(f,i,o+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, window-change)`),we(this,this._packetRW.write.finalize(f))}pty(t,e,r,i,s,o,f,a){if(this._server)throw new Error("Client-only method called in server mode");(!o||!o.length)&&(o="vt100"),f&&!Buffer.isBuffer(f)&&!Array.isArray(f)&&typeof f=="object"&&f!==null&&(f=Dg(f)),(!f||!f.length)&&(f=kg);let u=o.length,h=f.length,l=this._packetRW.write.allocStart,A=this._packetRW.write.alloc(1+4+4+7+1+4+u+4+4+4+4+4+h);if(A[l]=ye.CHANNEL_REQUEST,m(A,t,++l),m(A,7,l+=4),A.utf8Write("pty-req",l+=4,7),A[l+=7]=a===void 0||a===!0?1:0,m(A,u,++l),A.utf8Write(o,l+=4,u),m(A,r,l+=u),m(A,e,l+=4),m(A,s,l+=4),m(A,i,l+=4),m(A,h,l+=4),l+=4,Array.isArray(f))for(let p=0;p<h;++p)A[l++]=f[p];else Buffer.isBuffer(f)&&A.set(f,l);this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, pty-req)`),we(this,this._packetRW.write.finalize(A))}shell(t,e){if(this._server)throw new Error("Client-only method called in server mode");let r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+4+5+1);i[r]=ye.CHANNEL_REQUEST,m(i,t,++r),m(i,5,r+=4),i.utf8Write("shell",r+=4,5),i[r+=5]=e===void 0||e===!0?1:0,this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, shell)`),we(this,this._packetRW.write.finalize(i))}exec(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.isBuffer(e),s=i?e.length:Buffer.byteLength(e),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(1+4+4+4+1+4+s);f[o]=ye.CHANNEL_REQUEST,m(f,t,++o),m(f,4,o+=4),f.utf8Write("exec",o+=4,4),f[o+=4]=r===void 0||r===!0?1:0,m(f,s,++o),i?f.set(e,o+=4):f.utf8Write(e,o+=4,s),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, exec: ${e})`),we(this,this._packetRW.write.finalize(f))}signal(t,e){if(this._server)throw new Error("Client-only method called in server mode");let r=e;if(e=e.toUpperCase(),e.slice(0,3)==="SIG"&&(e=e.slice(3)),al[e]!==1)throw new Error(`Invalid signal: ${r}`);let i=e.length,s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+4+6+1+4+i);o[s]=ye.CHANNEL_REQUEST,m(o,t,++s),m(o,6,s+=4),o.utf8Write("signal",s+=4,6),o[s+=6]=0,m(o,i,++s),o.utf8Write(e,s+=4,i),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, signal: ${e})`),we(this,this._packetRW.write.finalize(o))}env(t,e,r,i){if(this._server)throw new Error("Client-only method called in server mode");let s=Buffer.byteLength(e),o=Buffer.isBuffer(r),f=o?r.length:Buffer.byteLength(r),a=this._packetRW.write.allocStart,u=this._packetRW.write.alloc(1+4+4+3+1+4+s+4+f);u[a]=ye.CHANNEL_REQUEST,m(u,t,++a),m(u,3,a+=4),u.utf8Write("env",a+=4,3),u[a+=3]=i===void 0||i===!0?1:0,m(u,s,++a),u.utf8Write(e,a+=4,s),m(u,f,a+=s),o?u.set(r,a+=4):u.utf8Write(r,a+=4,f),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, env: ${e}=${r})`),we(this,this._packetRW.write.finalize(u))}x11Forward(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=e.protocol,s=e.cookie,o=Buffer.isBuffer(i),f=o?i.length:Buffer.byteLength(i),a=Buffer.isBuffer(s),u=a?s.length:Buffer.byteLength(s),h=this._packetRW.write.allocStart,l=this._packetRW.write.alloc(1+4+4+7+1+1+4+f+4+u+4);l[h]=ye.CHANNEL_REQUEST,m(l,t,++h),m(l,7,h+=4),l.utf8Write("x11-req",h+=4,7),l[h+=7]=r===void 0||r===!0?1:0,l[++h]=e.single?1:0,m(l,f,++h),o?l.set(i,h+=4):l.utf8Write(i,h+=4,f),m(l,u,h+=f),a?l.set(s,h+=4):l.latin1Write(s,h+=4,u),m(l,e.screen||0,h+=u),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, x11-req)`),we(this,this._packetRW.write.finalize(l))}subsystem(t,e,r){if(this._server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(e),s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+4+9+1+4+i);o[s]=ye.CHANNEL_REQUEST,m(o,t,++s),m(o,9,s+=4),o.utf8Write("subsystem",s+=4,9),o[s+=9]=r===void 0||r===!0?1:0,m(o,i,++s),o.utf8Write(e,s+=4,i),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, subsystem: ${e})`),we(this,this._packetRW.write.finalize(o))}openssh_agentForward(t,e){if(this._server)throw new Error("Client-only method called in server mode");let r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+4+26+1);i[r]=ye.CHANNEL_REQUEST,m(i,t,++r),m(i,26,r+=4),i.utf8Write("auth-agent-req@openssh.com",r+=4,26),i[r+=26]=e===void 0||e===!0?1:0,this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, auth-agent-req@openssh.com)`),we(this,this._packetRW.write.finalize(i))}openssh_hostKeysProve(t){if(this._server)throw new Error("Client-only method called in server mode");let e=0,r=[];for(let o of t){let f=o.getPublicSSH();e+=4+f.length,r.push(f)}let i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(1+4+29+1+e);s[i]=ye.GLOBAL_REQUEST,m(s,29,++i),s.utf8Write("hostkeys-prove-00@openssh.com",i+=4,29),s[i+=29]=1,++i;for(let o of r)m(s,o.length,i),Us(o,s,0,o.length,i+=4),i+=o.length;this._debug&&this._debug("Outbound: Sending GLOBAL_REQUEST (hostkeys-prove-00@openssh.com)"),we(this,this._packetRW.write.finalize(s))}serviceAccept(t){if(!this._server)throw new Error("Server-only method called in client mode");let e=Buffer.byteLength(t),r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+e);if(i[r]=ye.SERVICE_ACCEPT,m(i,e,++r),i.utf8Write(t,r+=4,e),this._debug&&this._debug(`Outbound: Sending SERVICE_ACCEPT (${t})`),we(this,this._packetRW.write.finalize(i)),this._server&&this._banner&&t==="ssh-userauth"){let s=this._banner;this._banner=void 0;let o=Buffer.byteLength(s);r=this._packetRW.write.allocStart;let f=this._packetRW.write.alloc(1+4+o+4);f[r]=ye.USERAUTH_BANNER,m(f,o,++r),f.utf8Write(s,r+=4,o),m(f,0,r+=o),this._debug&&this._debug("Outbound: Sending USERAUTH_BANNER"),we(this,this._packetRW.write.finalize(f))}}forwardedTcpip(t,e,r,i){if(!this._server)throw new Error("Server-only method called in client mode");let s=Buffer.byteLength(i.boundAddr),o=Buffer.byteLength(i.remoteAddr),f=this._packetRW.write.allocStart,a=this._packetRW.write.alloc(1+4+15+4+4+4+4+s+4+4+o+4);a[f]=ye.CHANNEL_OPEN,m(a,15,++f),a.utf8Write("forwarded-tcpip",f+=4,15),m(a,t,f+=15),m(a,e,f+=4),m(a,r,f+=4),m(a,s,f+=4),a.utf8Write(i.boundAddr,f+=4,s),m(a,i.boundPort,f+=s),m(a,o,f+=4),a.utf8Write(i.remoteAddr,f+=4,o),m(a,i.remotePort,f+=o),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, forwarded-tcpip)`),we(this,this._packetRW.write.finalize(a))}x11(t,e,r,i){if(!this._server)throw new Error("Server-only method called in client mode");let s=Buffer.byteLength(i.originAddr),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(1+4+3+4+4+4+4+s+4);f[o]=ye.CHANNEL_OPEN,m(f,3,++o),f.utf8Write("x11",o+=4,3),m(f,t,o+=3),m(f,e,o+=4),m(f,r,o+=4),m(f,s,o+=4),f.utf8Write(i.originAddr,o+=4,s),m(f,i.originPort,o+=s),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, x11)`),we(this,this._packetRW.write.finalize(f))}openssh_authAgent(t,e,r){if(!this._server)throw new Error("Server-only method called in client mode");let i=this._packetRW.write.allocStart,s=this._packetRW.write.alloc(1+4+22+4+4+4);s[i]=ye.CHANNEL_OPEN,m(s,22,++i),s.utf8Write("auth-agent@openssh.com",i+=4,22),m(s,t,i+=22),m(s,e,i+=4),m(s,r,i+=4),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, auth-agent@openssh.com)`),we(this,this._packetRW.write.finalize(s))}openssh_forwardedStreamLocal(t,e,r,i){if(!this._server)throw new Error("Server-only method called in client mode");let s=Buffer.byteLength(i.socketPath),o=this._packetRW.write.allocStart,f=this._packetRW.write.alloc(1+4+33+4+4+4+4+s+4);f[o]=ye.CHANNEL_OPEN,m(f,33,++o),f.utf8Write("forwarded-streamlocal@openssh.com",o+=4,33),m(f,t,o+=33),m(f,e,o+=4),m(f,r,o+=4),m(f,s,o+=4),f.utf8Write(i.socketPath,o+=4,s),m(f,0,o+=s),this._debug&&this._debug(`Outbound: Sending CHANNEL_OPEN (r:${t}, forwarded-streamlocal@openssh.com)`),we(this,this._packetRW.write.finalize(f))}exitStatus(t,e){if(!this._server)throw new Error("Server-only method called in client mode");let r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+4+11+1+4);i[r]=ye.CHANNEL_REQUEST,m(i,t,++r),m(i,11,r+=4),i.utf8Write("exit-status",r+=4,11),i[r+=11]=0,m(i,e,++r),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, exit-status: ${e})`),we(this,this._packetRW.write.finalize(i))}exitSignal(t,e,r,i){if(!this._server)throw new Error("Server-only method called in client mode");let s=e;if(typeof s!="string"||!s)throw new Error(`Invalid signal: ${s}`);let o=e.toUpperCase();if(o.slice(0,3)==="SIG"&&(o=o.slice(3)),al[o]!==1)throw new Error(`Invalid signal: ${s}`);let f=Buffer.byteLength(o),a=i?Buffer.byteLength(i):0,u=this._packetRW.write.allocStart,h=this._packetRW.write.alloc(1+4+4+11+1+4+f+1+4+a+4);h[u]=ye.CHANNEL_REQUEST,m(h,t,++u),m(h,11,u+=4),h.utf8Write("exit-signal",u+=4,11),h[u+=11]=0,m(h,f,++u),h.utf8Write(o,u+=4,f),h[u+=f]=r?1:0,m(h,a,++u),u+=4,a&&(h.utf8Write(i,u,a),u+=a),m(h,0,u),this._debug&&this._debug(`Outbound: Sending CHANNEL_REQUEST (r:${t}, exit-signal: ${e})`),we(this,this._packetRW.write.finalize(h))}authFailure(t,e){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0)throw new Error("No auth in progress");let r;if(typeof t=="boolean"&&(e=t,t=void 0),t){r=[];for(let f=0;f<t.length;++f)t[f].toLowerCase()!=="none"&&r.push(t[f]);r=r.join(",")}else r="";let i=r.length,s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+i+1);o[s]=ye.USERAUTH_FAILURE,m(o,i,++s),o.utf8Write(r,s+=4,i),o[s+=i]=e===!0?1:0,this._authsQueue.shift(),this._debug&&this._debug("Outbound: Sending USERAUTH_FAILURE"),we(this,this._packetRW.write.finalize(o))}authSuccess(){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0)throw new Error("No auth in progress");let t=this._packetRW.write.allocStart,e=this._packetRW.write.alloc(1);e[t]=ye.USERAUTH_SUCCESS,this._authsQueue.shift(),this._authenticated=!0,this._debug&&this._debug("Outbound: Sending USERAUTH_SUCCESS"),we(this,this._packetRW.write.finalize(e)),this._kex.negotiated.cs.compress==="zlib@openssh.com"&&(this._packetRW.read=new El),this._kex.negotiated.sc.compress==="zlib@openssh.com"&&(this._packetRW.write=new pl(this))}authPKOK(t,e){if(!this._server)throw new Error("Server-only method called in client mode");if(this._authsQueue.length===0||this._authsQueue[0]!=="publickey")throw new Error('"publickey" auth not in progress');let r=Buffer.byteLength(t),i=e.length,s=this._packetRW.write.allocStart,o=this._packetRW.write.alloc(1+4+r+4+i);o[s]=ye.USERAUTH_PK_OK,m(o,r,++s),o.utf8Write(t,s+=4,r),m(o,i,s+=r),o.set(e,s+=4),this._authsQueue.shift(),this._debug&&this._debug("Outbound: Sending USERAUTH_PK_OK"),we(this,this._packetRW.write.finalize(o))}authPasswdChg(t){if(!this._server)throw new Error("Server-only method called in client mode");let e=Buffer.byteLength(t),r=this._packetRW.write.allocStart,i=this._packetRW.write.alloc(1+4+e+4);i[r]=ye.USERAUTH_PASSWD_CHANGEREQ,m(i,e,++r),i.utf8Write(t,r+=4,e),m(i,0,r+=e),this._debug&&this._debug("Outbound: Sending USERAUTH_PASSWD_CHANGEREQ"),we(this,this._packetRW.write.finalize(i))}authInfoReq(t,e,r){if(!this._server)throw new Error("Server-only method called in client mode");let i=0,s=t?Buffer.byteLength(t):0,o=e?Buffer.byteLength(e):0;for(let u=0;u<r.length;++u)i+=4+Buffer.byteLength(r[u].prompt)+1;let f=this._packetRW.write.allocStart,a=this._packetRW.write.alloc(1+4+s+4+o+4+4+i);a[f]=ye.USERAUTH_INFO_REQUEST,m(a,s,++f),f+=4,t&&(a.utf8Write(t,f,s),f+=s),m(a,o,f),f+=4,e&&(a.utf8Write(e,f,o),f+=o),m(a,0,f),m(a,r.length,f+=4),f+=4;for(let u=0;u<r.length;++u){let h=r[u],l=Buffer.byteLength(h.prompt);m(a,l,f),f+=4,l&&(a.utf8Write(h.prompt,f,l),f+=l),a[f++]=h.echo?1:0}this._debug&&this._debug("Outbound: Sending USERAUTH_INFO_REQUEST"),we(this,this._packetRW.write.finalize(a))}},Tg=/^SSH-(2\.0|1\.99)-([^ ]+)(?: (.*))?$/;function Og(n,t,e){let r,i;this._buffer?(r=Buffer.allocUnsafe(this._buffer.length+(e-t)),r.set(this._buffer,0),t===0?r.set(n,this._buffer.length):r.set(new Uint8Array(n.buffer,n.byteOffset+t,e-t),this._buffer.length),i=this._buffer.length,t=0):(r=n,i=0);let s=t,o=t,f=t,a=!1,u=0,h=0;for(;t<r.length;++t){let l=r[t];if(l===13){a=!0;continue}if(l===10){if(f>o&&f-o>4&&r[o]===83&&r[o+1]===83&&r[o+2]===72&&r[o+3]===45){let A=r.latin1Slice(s,f+1),p=o===s?A:A.slice(o-s),y=Tg.exec(p);if(!y)throw new Error("Invalid identification string");let I={greeting:o===s?"":A.slice(0,o-s),identRaw:p,versions:{protocol:y[1],software:y[2]},comments:y[3]};return this._remoteIdentRaw=Buffer.from(p),this._debug&&this._debug(`Remote ident: ${dl(p)}`),this._compatFlags=Ug(I),this._buffer=void 0,this._decipher=new pg(0,yg.bind(this,{firstPacket:!0})),this._parse=Lg,this._onHeader(I),this._destruct?(_l(this),t+1-i):e}if(this._server)throw new Error("Greetings from clients not permitted");if(++h>Ng)throw new Error("Max greeting lines exceeded");a=!1,o=t+1,u=0}else{if(a)throw new Error("Invalid header: expected newline");if(++u>=vg)throw new Error("Header line too long")}f=t}return this._buffer||(this._buffer=gl(r,s)),t-i}function Lg(n,t,e){return this._decipher.decrypt(n,t,e)}function Pg(n){if(this._onPacket(),n.length===0){this._debug&&this._debug("Inbound: Skipping empty packet payload");return}n=this._packetRW.read.read(n);let t=n[0];t===ye.USERAUTH_SUCCESS&&!this._server&&!this._authenticated&&(this._authenticated=!0,this._kex.negotiated.cs.compress==="zlib@openssh.com"&&(this._packetRW.write=new pl(this)),this._kex.negotiated.sc.compress==="zlib@openssh.com"&&(this._packetRW.read=new El));let e=xg[t];if(e===void 0){this._debug&&this._debug(`Inbound: Unsupported message type: ${t}`);return}return e(this,n)}function Ug(n){let t=n.versions.software,e=0;for(let r of bg)typeof r[0]=="string"?t===r[0]&&(e|=r[1]):r[0].test(t)&&(e|=r[1]);return e}function Dg(n){let t=Object.keys(n),e=Buffer.allocUnsafe(5*t.length+1),r=0;for(let i=0;i<t.length;++i){let s=t[i];if(s==="TTY_OP_END")continue;let o=$f[s];if(o===void 0)continue;let f=n[s];typeof f=="number"&&isFinite(f)&&(e[r++]=o,e[r++]=f>>>24,e[r++]=f>>>16,e[r++]=f>>>8,e[r++]=f)}return e[r++]=$f.TTY_OP_END,r<e.length?gl(e,0,r):e}Il.exports=Yf});var Cl=_e(yi=>{"use strict";var Ds=require("assert"),{inspect:Qg}=require("util");function yl(n){let t="",e=n.length,r=n[0]==="-"?1:0;for(;e>=r+4;e-=3)t=`_${n.slice(e-3,e)}${t}`;return`${n.slice(0,e)}${t}`}function xl(n,t){if(Ds(typeof t=="string","`thing` has to be of type string"),Array.isArray(n)){let e=n.length;return Ds(e>0,"At least one expected value needs to be specified"),n=n.map(r=>String(r)),e>2?`one of ${t} ${n.slice(0,e-1).join(", ")}, or `+n[e-1]:e===2?`one of ${t} ${n[0]} or ${n[1]}`:`of ${t} ${n[0]}`}return`of ${t} ${String(n)}`}yi.ERR_INTERNAL_ASSERTION=class Sl extends Error{constructor(t){super(),Error.captureStackTrace(this,Sl);let e=`This is caused by either a bug in ssh2 or incorrect usage of ssh2 internals.
Please open an issue with this stack trace at https://github.com/mscdex/ssh2/issues
`;this.message=t===void 0?e:`${t}
${e}`}};var Hg=2**32,wl=(()=>{try{return new Function("return 2n ** 32n")()}catch{}})();yi.ERR_OUT_OF_RANGE=class ml extends RangeError{constructor(t,e,r,i){super(),Error.captureStackTrace(this,ml),Ds(e,'Missing "range" argument');let s=i?t:`The value of "${t}" is out of range.`,o;Number.isInteger(r)&&Math.abs(r)>Hg?o=yl(String(r)):typeof r=="bigint"?(o=String(r),(r>wl||r<-wl)&&(o=yl(o)),o+="n"):o=Qg(r),s+=` It must be ${e}. Received ${o}`,this.message=s}};var Qr=class extends TypeError{constructor(t,e,r){super(),Error.captureStackTrace(this,Qr),Ds(typeof t=="string","'name' must be a string");let i;typeof e=="string"&&e.startsWith("not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be";let s;if(t.endsWith(" argument"))s=`The ${t} ${i} ${xl(e,"type")}`;else{let o=t.includes(".")?"property":"argument";s=`The "${t}" ${o} ${i} ${xl(e,"type")}`}s+=`. Received type ${typeof r}`,this.message=s}};yi.ERR_INVALID_ARG_TYPE=Qr;yi.validateNumber=function(t,e){if(typeof t!="number")throw new Qr(e,"number",t)}});var xi=_e((Ub,Hl)=>{"use strict";var Fg=require("events"),Vn=require("fs"),{constants:Xt}=Vn,{Readable:Tl,Writable:ra}=require("stream"),{inherits:Ol,isDate:zf}=require("util"),qg=Buffer[Symbol.species],{bufferCopy:Xn,bufferSlice:qr,makeBufferParser:Mg,writeUInt32BE:Q}=An(),Dn={SIZE:1,UIDGID:2,PERMISSIONS:4,ACMODTIME:8,EXTENDED:2147483648},Re=Buffer.alloc(28),tt={OK:0,EOF:1,NO_SUCH_FILE:2,PERMISSION_DENIED:3,FAILURE:4,BAD_MESSAGE:5,NO_CONNECTION:6,CONNECTION_LOST:7,OP_UNSUPPORTED:8},Kg=new Map(Object.values(tt).map(n=>[n,1])),Wg={[tt.OK]:"No error",[tt.EOF]:"End of file",[tt.NO_SUCH_FILE]:"No such file or directory",[tt.PERMISSION_DENIED]:"Permission denied",[tt.FAILURE]:"Failure",[tt.BAD_MESSAGE]:"Bad message",[tt.NO_CONNECTION]:"No connection",[tt.CONNECTION_LOST]:"Connection lost",[tt.OP_UNSUPPORTED]:"Operation unsupported"},Be={INIT:1,OPEN:3,CLOSE:4,READ:5,WRITE:6,LSTAT:7,FSTAT:8,SETSTAT:9,FSETSTAT:10,OPENDIR:11,READDIR:12,REMOVE:13,MKDIR:14,RMDIR:15,REALPATH:16,STAT:17,RENAME:18,READLINK:19,SYMLINK:20,EXTENDED:200},Vt={VERSION:2,STATUS:101,HANDLE:102,DATA:103,NAME:104,ATTRS:105,EXTENDED:201},xe={READ:1,WRITE:2,APPEND:4,CREAT:8,TRUNC:16,EXCL:32},Rl=2*1024,ht=2**32-1,Gg=Buffer.from([0,0,0,5,Be.INIT,0,0,0,3]),$g=Buffer.from([0,0,0,5,Vt.VERSION,0,0,0,3]),Yg=/^SSH-2.0-(?:OpenSSH|dropbear)/,Xf=256*1024,N=Mg(),jg={readable:!1,writable:!1,push:n=>{},once:()=>{},on:()=>{},emit:()=>{},end:()=>{}};function Ll(){}var Jf=class extends Fg{constructor(t,e,r){super(),(typeof r!="object"||!r)&&(r={});let i=t._protocol._remoteIdentRaw;this.server=!!r.server,this._debug=typeof r.debug=="function"?r.debug:void 0,this._isOpenSSH=i&&Yg.test(i),this._version=-1,this._extensions={},this._biOpt=r.biOpt,this._pktLenBytes=0,this._pktLen=0,this._pktPos=0,this._pktType=0,this._pktData=void 0,this._writeReqid=-1,this._requests={},this._maxInPktLen=Xf,this._maxOutPktLen=34e3,this._maxReadLen=(this._isOpenSSH?Xf:34e3)-Rl,this._maxWriteLen=(this._isOpenSSH?Xf:34e3)-Rl,this.maxOpenHandles=void 0,this._client=t,this._protocol=t._protocol,this._callbacks=[],this._hasX11=!1,this._exit={code:void 0,signal:void 0,dump:void 0,desc:void 0},this._waitWindow=!1,this._chunkcb=void 0,this._buffer=[],this.type=e.type,this.subtype=void 0,this.incoming=e.incoming,this.outgoing=e.outgoing,this.stderr=jg,this.readable=!0}push(t){if(t===null){if(Ql(this),!this.readable)return;this.readable=!1,this.emit("end");return}let e=0;for(;e<t.length;){if(this._pktLenBytes<4){let o=Math.min(4-this._pktLenBytes,t.length-e);for(this._pktLenBytes+=o;o--;)this._pktLen=(this._pktLen<<8)+t[e++];if(this._pktLenBytes<4)return;if(this._pktLen===0)return st(this,"Invalid packet length");if(this._pktLen>this._maxInPktLen){let f=this._maxInPktLen;return st(this,`Packet length ${this._pktLen} exceeds max length of ${f}`)}if(e>=t.length)return}if(this._pktPos<this._pktLen){let o=Math.min(this._pktLen-this._pktPos,t.length-e);if(e!==0||o!==t.length?o===this._pktLen?this._pkt=new qg(t.buffer,t.byteOffset+e,o):(this._pkt||(this._pkt=Buffer.allocUnsafe(this._pktLen)),this._pkt.set(new Uint8Array(t.buffer,t.byteOffset+e,o),this._pktPos)):o===this._pktLen?this._pkt=t:(this._pkt||(this._pkt=Buffer.allocUnsafe(this._pktLen)),this._pkt.set(t,this._pktPos)),e+=o,this._pktPos+=o,this._pktPos<this._pktLen)return}let r=this._pkt[0],i=this._pkt;this._pktLen=0,this._pktLenBytes=0,this._pkt=void 0,this._pktPos=0;let s=this.server?Zg[r]:Jg[r];if(!s)return st(this,`Unknown packet type ${r}`);if(this._version===-1){if(this.server){if(r!==Be.INIT)return st(this,`Expected INIT packet, got ${r}`)}else if(r!==Vt.VERSION)return st(this,`Expected VERSION packet, got ${r}`)}if(s(this,i)===!1)return}}end(){this.destroy()}destroy(){(this.outgoing.state==="open"||this.outgoing.state==="eof")&&(this.outgoing.state="closing",this._protocol.channelClose(this.outgoing.id))}_init(){this._init=Ll,this.server||et(this,Gg)}createReadStream(t,e){if(this.server)throw new Error("Client-only method called in server mode");return new Qn(this,t,e)}createWriteStream(t,e){if(this.server)throw new Error("Client-only method called in server mode");return new un(this,t,e)}open(t,e,r,i){if(this.server)throw new Error("Client-only method called in server mode");typeof r=="function"&&(i=r,r=void 0);let s=typeof e=="number"?e:Ul(e);if(s===null)throw new Error(`Unknown flags string: ${e}`);let o=0,f=0;(typeof r=="string"||typeof r=="number")&&(r={mode:r}),typeof r=="object"&&r!==null&&(r=lr(r),o=r.flags,f=r.nb);let a=Buffer.byteLength(t),u=9,h=Buffer.allocUnsafe(4+1+4+4+a+4+4+f);Q(h,h.length-4,0),h[4]=Be.OPEN;let l=this._writeReqid=this._writeReqid+1&ht;Q(h,l,5),Q(h,a,u),h.utf8Write(t,u+=4,a),Q(h,s,u+=a),Q(h,o,u+=4),f&&(u+=4,f===Re.length?h.set(Re,u):Xn(Re,h,0,f,u),u+=f),this._requests[l]={cb:i};let A=et(this,h);this._debug&&this._debug(`SFTP: Outbound: ${A?"Buffered":"Sending"} OPEN`)}close(t,e){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");let r=t.length,i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Be.CLOSE;let o=this._writeReqid=this._writeReqid+1&ht;Q(s,o,5),Q(s,r,i),s.set(t,i+=4),this._requests[o]={cb:e};let f=et(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} CLOSE`)}read(t,e,r,i,s,o){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(e))throw new Error("buffer is not a Buffer");if(r>=e.length)throw new Error("offset is out of bounds");if(r+i>e.length)throw new Error("length extends beyond buffer");if(s===null)throw new Error("null position currently unsupported");Pl(this,t,e,r,i,s,o)}readData(t,e,r,i,s,o){this.read(t,e,r,i,s,o)}write(t,e,r,i,s,o){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(e))throw new Error("buffer is not a Buffer");if(r>e.length)throw new Error("offset is out of bounds");if(r+i>e.length)throw new Error("length extends beyond buffer");if(s===null)throw new Error("null position currently unsupported");if(!i){o&&process.nextTick(o,void 0,0);return}let f=this._maxWriteLen,a=Math.max(i-f,0),u=s;a&&(i=f);let h=t.length,l=9,A=Buffer.allocUnsafe(4+1+4+4+h+8+4+i);Q(A,A.length-4,0),A[4]=Be.WRITE;let p=this._writeReqid=this._writeReqid+1&ht;Q(A,p,5),Q(A,h,l),A.set(t,l+=4),l+=h;for(let I=7;I>=0;--I)A[l+I]=s&255,s/=256;Q(A,i,l+=8),Xn(e,A,r,r+i,l+=4),this._requests[p]={cb:I=>{I?typeof o=="function"&&o(I):a?this.write(t,e,r+i,a,u+i,o):typeof o=="function"&&o(void 0,r+i)}};let y=et(this,A);if(this._debug){let I=y?"Sent":"Buffered";this._debug(`SFTP: Outbound: ${I} WRITE (id:${p})`)}}writeData(t,e,r,i,s,o){this.write(t,e,r,i,s,o)}fastGet(t,e,r,i){if(this.server)throw new Error("Client-only method called in server mode");Bl(this,Vn,t,e,r,i)}fastPut(t,e,r,i){if(this.server)throw new Error("Client-only method called in server mode");Bl(Vn,this,t,e,r,i)}readFile(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");let i;if(typeof r=="function"?i=r:typeof e=="function"&&(i=e,e=void 0),typeof e=="string")e={encoding:e,flag:"r"};else if(!e)e={encoding:null,flag:"r"};else if(typeof e!="object")throw new TypeError("Bad arguments");let s=e.encoding;if(s&&!Buffer.isEncoding(s))throw new Error(`Unknown encoding: ${s}`);let o,f,a,u=0,h,l=0,A=e.flag||"r",p=()=>{o===0?(f=Buffer.allocUnsafe(8192),this.read(h,f,0,8192,l,y)):this.read(h,f,u,o-u,l,y)},y=(v,x)=>{let O;if(v){if(O=v.code===tt.EOF,!O)return this.close(h,()=>i&&i(v))}else O=!1;if(O||o===0&&x===0)return I();l+=x,u+=x,o!==0?u===o?I():p():(a.push(qr(f,0,x)),p())};y._wantEOFError=!0;let I=()=>{this.close(h,v=>(o===0?f=Buffer.concat(a,u):u<o&&(f=qr(f,0,u)),s&&(f=f.toString(s)),i&&i(v,f)))};this.open(t,A,438,(v,x)=>{if(v)return i&&i(v);h=x;let O=(X,H)=>{if(X){this.stat(t,(te,ce)=>{if(te)return this.close(h,()=>{i&&i(X)});O(null,ce)});return}if(o=H.size||0,o===0)return a=[],p();f=Buffer.allocUnsafe(o),p()};this.fstat(h,O)})}writeFile(t,e,r,i){if(this.server)throw new Error("Client-only method called in server mode");let s;if(typeof i=="function"?s=i:typeof r=="function"&&(s=r,r=void 0),typeof r=="string")r={encoding:r,mode:438,flag:"w"};else if(!r)r={encoding:"utf8",mode:438,flag:"w"};else if(typeof r!="object")throw new TypeError("Bad arguments");if(r.encoding&&!Buffer.isEncoding(r.encoding))throw new Error(`Unknown encoding: ${r.encoding}`);let o=r.flag||"w";this.open(t,o,r.mode,(f,a)=>{if(f)s&&s(f);else{let u=Buffer.isBuffer(e)?e:Buffer.from(""+e,r.encoding||"utf8"),h=/a/.test(o)?null:0;if(h===null){let l=(A,p)=>{if(A){this.stat(t,(y,I)=>{if(y)return this.close(a,()=>{s&&s(A)});l(null,I)});return}Zf(this,a,u,0,u.length,p.size,s)};this.fstat(a,l);return}Zf(this,a,u,0,u.length,h,s)}})}appendFile(t,e,r,i){if(this.server)throw new Error("Client-only method called in server mode");let s;if(typeof i=="function"?s=i:typeof r=="function"&&(s=r,r=void 0),typeof r=="string")r={encoding:r,mode:438,flag:"a"};else if(!r)r={encoding:"utf8",mode:438,flag:"a"};else if(typeof r!="object")throw new TypeError("Bad arguments");r.flag||(r=Object.assign({flag:"a"},r)),this.writeFile(t,e,r,s)}exists(t,e){if(this.server)throw new Error("Client-only method called in server mode");this.stat(t,r=>{e&&e(!r)})}unlink(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Be.REMOVE;let o=this._writeReqid=this._writeReqid+1&ht;Q(s,o,5),Q(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:e};let f=et(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} REMOVE`)}rename(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(t),s=Buffer.byteLength(e),o=9,f=Buffer.allocUnsafe(4+1+4+4+i+4+s);Q(f,f.length-4,0),f[4]=Be.RENAME;let a=this._writeReqid=this._writeReqid+1&ht;Q(f,a,5),Q(f,i,o),f.utf8Write(t,o+=4,i),Q(f,s,o+=i),f.utf8Write(e,o+=4,s),this._requests[a]={cb:r};let u=et(this,f);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} RENAME`)}mkdir(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");let i=0,s=0;typeof e=="function"&&(r=e,e=void 0),typeof e=="object"&&e!==null&&(e=lr(e),i=e.flags,s=e.nb);let o=Buffer.byteLength(t),f=9,a=Buffer.allocUnsafe(4+1+4+4+o+4+s);Q(a,a.length-4,0),a[4]=Be.MKDIR;let u=this._writeReqid=this._writeReqid+1&ht;Q(a,u,5),Q(a,o,f),a.utf8Write(t,f+=4,o),Q(a,i,f+=o),s&&(f+=4,s===Re.length?a.set(Re,f):Xn(Re,a,0,s,f),f+=s),this._requests[u]={cb:r};let h=et(this,a);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} MKDIR`)}rmdir(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Be.RMDIR;let o=this._writeReqid=this._writeReqid+1&ht;Q(s,o,5),Q(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:e};let f=et(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} RMDIR`)}readdir(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");typeof e=="function"&&(r=e,e={}),(typeof e!="object"||e===null)&&(e={});let i=!(e&&e.full);if(!Buffer.isBuffer(t)&&typeof t!="string")throw new Error("missing directory handle or path");if(typeof t=="string"){let h=[],l=0,A=(p,y)=>{if(p)return r(p);this.readdir(y,e,(I,v)=>{let x=I&&I.code===tt.EOF;if(I&&!x)return this.close(y,()=>r(I));if(x)return this.close(y,O=>{if(O)return r(O);r(void 0,h)});for(let O=0;O<v.length;++O,++l)h[l]=v[O];A(void 0,y)})};return this.opendir(t,A)}let s=t.length,o=9,f=Buffer.allocUnsafe(4+1+4+4+s);Q(f,f.length-4,0),f[4]=Be.READDIR;let a=this._writeReqid=this._writeReqid+1&ht;Q(f,a,5),Q(f,s,o),f.set(t,o+=4),this._requests[a]={cb:i?(h,l)=>{if(typeof r=="function"){if(h)return r(h);for(let A=l.length-1;A>=0;--A)(l[A].filename==="."||l[A].filename==="..")&&l.splice(A,1);r(void 0,l)}}:r};let u=et(this,f);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} READDIR`)}fstat(t,e){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");let r=t.length,i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Be.FSTAT;let o=this._writeReqid=this._writeReqid+1&ht;Q(s,o,5),Q(s,r,i),s.set(t,i+=4),this._requests[o]={cb:e};let f=et(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} FSTAT`)}stat(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Be.STAT;let o=this._writeReqid=this._writeReqid+1&ht;Q(s,o,5),Q(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:e};let f=et(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} STAT`)}lstat(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Be.LSTAT;let o=this._writeReqid=this._writeReqid+1&ht;Q(s,o,5),Q(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:e};let f=et(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} LSTAT`)}opendir(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Be.OPENDIR;let o=this._writeReqid=this._writeReqid+1&ht;Q(s,o,5),Q(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:e};let f=et(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} OPENDIR`)}setstat(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");let i=0,s=0;typeof e=="object"&&e!==null?(e=lr(e),i=e.flags,s=e.nb):typeof e=="function"&&(r=e);let o=Buffer.byteLength(t),f=9,a=Buffer.allocUnsafe(4+1+4+4+o+4+s);Q(a,a.length-4,0),a[4]=Be.SETSTAT;let u=this._writeReqid=this._writeReqid+1&ht;Q(a,u,5),Q(a,o,f),a.utf8Write(t,f+=4,o),Q(a,i,f+=o),s&&(f+=4,s===Re.length?a.set(Re,f):Xn(Re,a,0,s,f),f+=s),this._requests[u]={cb:r};let h=et(this,a);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} SETSTAT`)}fsetstat(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");let i=0,s=0;typeof e=="object"&&e!==null?(e=lr(e),i=e.flags,s=e.nb):typeof e=="function"&&(r=e);let o=t.length,f=9,a=Buffer.allocUnsafe(4+1+4+4+o+4+s);Q(a,a.length-4,0),a[4]=Be.FSETSTAT;let u=this._writeReqid=this._writeReqid+1&ht;Q(a,u,5),Q(a,o,f),a.set(t,f+=4),Q(a,i,f+=o),s&&(f+=4,s===Re.length?a.set(Re,f):Xn(Re,a,0,s,f),f+=s),this._requests[u]={cb:r};let h=et(this,a);this._debug&&this._debug(`SFTP: Outbound: ${h?"Buffered":"Sending"} FSETSTAT`)}futimes(t,e,r,i){return this.fsetstat(t,{atime:Hr(e),mtime:Hr(r)},i)}utimes(t,e,r,i){return this.setstat(t,{atime:Hr(e),mtime:Hr(r)},i)}fchown(t,e,r,i){return this.fsetstat(t,{uid:e,gid:r},i)}chown(t,e,r,i){return this.setstat(t,{uid:e,gid:r},i)}fchmod(t,e,r){return this.fsetstat(t,{mode:e},r)}chmod(t,e,r){return this.setstat(t,{mode:e},r)}readlink(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Be.READLINK;let o=this._writeReqid=this._writeReqid+1&ht;Q(s,o,5),Q(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:(a,u)=>{if(typeof e=="function"){if(a)return e(a);if(!u||!u.length)return e(new Error("Response missing link info"));e(void 0,u[0].filename)}}};let f=et(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} READLINK`)}symlink(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");let i=Buffer.byteLength(e),s=Buffer.byteLength(t),o=9,f=Buffer.allocUnsafe(4+1+4+4+i+4+s);Q(f,f.length-4,0),f[4]=Be.SYMLINK;let a=this._writeReqid=this._writeReqid+1&ht;Q(f,a,5),this._isOpenSSH?(Q(f,s,o),f.utf8Write(t,o+=4,s),Q(f,i,o+=s),f.utf8Write(e,o+=4,i)):(Q(f,i,o),f.utf8Write(e,o+=4,i),Q(f,s,o+=i),f.utf8Write(t,o+=4,s)),this._requests[a]={cb:r};let u=et(this,f);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} SYMLINK`)}realpath(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=Buffer.byteLength(t),i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Be.REALPATH;let o=this._writeReqid=this._writeReqid+1&ht;Q(s,o,5),Q(s,r,i),s.utf8Write(t,i+=4,r),this._requests[o]={cb:(a,u)=>{if(typeof e=="function"){if(a)return e(a);if(!u||!u.length)return e(new Error("Response missing path info"));e(void 0,u[0].filename)}}};let f=et(this,s);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} REALPATH`)}ext_openssh_rename(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");let i=this._extensions["posix-rename@openssh.com"];if(!i||i!=="1")throw new Error("Server does not support this extended request");let s=Buffer.byteLength(t),o=Buffer.byteLength(e),f=9,a=Buffer.allocUnsafe(4+1+4+4+24+4+s+4+o);Q(a,a.length-4,0),a[4]=Be.EXTENDED;let u=this._writeReqid=this._writeReqid+1&ht;Q(a,u,5),Q(a,24,f),a.utf8Write("posix-rename@openssh.com",f+=4,24),Q(a,s,f+=24),a.utf8Write(t,f+=4,s),Q(a,o,f+=s),a.utf8Write(e,f+=4,o),this._requests[u]={cb:r};let h=et(this,a);if(this._debug){let l=h?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${l} posix-rename@openssh.com`)}}ext_openssh_statvfs(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=this._extensions["statvfs@openssh.com"];if(!r||r!=="2")throw new Error("Server does not support this extended request");let i=Buffer.byteLength(t),s=9,o=Buffer.allocUnsafe(4+1+4+4+19+4+i);Q(o,o.length-4,0),o[4]=Be.EXTENDED;let f=this._writeReqid=this._writeReqid+1&ht;Q(o,f,5),Q(o,19,s),o.utf8Write("statvfs@openssh.com",s+=4,19),Q(o,i,s+=19),o.utf8Write(t,s+=4,i),this._requests[f]={extended:"statvfs@openssh.com",cb:e};let a=et(this,o);if(this._debug){let u=a?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${u} statvfs@openssh.com`)}}ext_openssh_fstatvfs(t,e){if(this.server)throw new Error("Client-only method called in server mode");let r=this._extensions["fstatvfs@openssh.com"];if(!r||r!=="2")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");let i=t.length,s=9,o=Buffer.allocUnsafe(4+1+4+4+20+4+i);Q(o,o.length-4,0),o[4]=Be.EXTENDED;let f=this._writeReqid=this._writeReqid+1&ht;Q(o,f,5),Q(o,20,s),o.utf8Write("fstatvfs@openssh.com",s+=4,20),Q(o,i,s+=20),o.set(t,s+=4),this._requests[f]={extended:"fstatvfs@openssh.com",cb:e};let a=et(this,o);if(this._debug){let u=a?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${u} fstatvfs@openssh.com`)}}ext_openssh_hardlink(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["hardlink@openssh.com"]!=="1")throw new Error("Server does not support this extended request");let s=Buffer.byteLength(t),o=Buffer.byteLength(e),f=9,a=Buffer.allocUnsafe(4+1+4+4+20+4+s+4+o);Q(a,a.length-4,0),a[4]=Be.EXTENDED;let u=this._writeReqid=this._writeReqid+1&ht;Q(a,u,5),Q(a,20,f),a.utf8Write("hardlink@openssh.com",f+=4,20),Q(a,s,f+=20),a.utf8Write(t,f+=4,s),Q(a,o,f+=s),a.utf8Write(e,f+=4,o),this._requests[u]={cb:r};let h=et(this,a);if(this._debug){let l=h?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${l} hardlink@openssh.com`)}}ext_openssh_fsync(t,e){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["fsync@openssh.com"]!=="1")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");let i=t.length,s=9,o=Buffer.allocUnsafe(4+1+4+4+17+4+i);Q(o,o.length-4,0),o[4]=Be.EXTENDED;let f=this._writeReqid=this._writeReqid+1&ht;Q(o,f,5),Q(o,17,s),o.utf8Write("fsync@openssh.com",s+=4,17),Q(o,i,s+=17),o.set(t,s+=4),this._requests[f]={cb:e};let a=et(this,o);this._debug&&this._debug(`SFTP: Outbound: ${a?"Buffered":"Sending"} fsync@openssh.com`)}ext_openssh_lsetstat(t,e,r){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["lsetstat@openssh.com"]!=="1")throw new Error("Server does not support this extended request");let s=0,o=0;typeof e=="object"&&e!==null?(e=lr(e),s=e.flags,o=e.nb):typeof e=="function"&&(r=e);let f=Buffer.byteLength(t),a=9,u=Buffer.allocUnsafe(4+1+4+4+20+4+f+4+o);Q(u,u.length-4,0),u[4]=Be.EXTENDED;let h=this._writeReqid=this._writeReqid+1&ht;Q(u,h,5),Q(u,20,a),u.utf8Write("lsetstat@openssh.com",a+=4,20),Q(u,f,a+=20),u.utf8Write(t,a+=4,f),Q(u,s,a+=f),o&&(a+=4,o===Re.length?u.set(Re,a):Xn(Re,u,0,o,a),a+=o),this._requests[h]={cb:r};let l=et(this,u);if(this._debug){let A=l?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${A} lsetstat@openssh.com`)}}ext_openssh_expandPath(t,e){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["expand-path@openssh.com"]!=="1")throw new Error("Server does not support this extended request");let i=Buffer.byteLength(t),s=9,o=Buffer.allocUnsafe(4+1+4+4+23+4+i);Q(o,o.length-4,0),o[4]=Be.EXTENDED;let f=this._writeReqid=this._writeReqid+1&ht;Q(o,f,5),Q(o,23,s),o.utf8Write("expand-path@openssh.com",s+=4,23),Q(o,i,s+=20),o.utf8Write(t,s+=4,i),this._requests[f]={cb:e};let a=et(this,o);if(this._debug){let u=a?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${u} expand-path@openssh.com`)}}ext_copy_data(t,e,r,i,s,o){if(this.server)throw new Error("Client-only method called in server mode");if(this._extensions["copy-data"]!=="1")throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(t))throw new Error("Source handle is not a Buffer");if(!Buffer.isBuffer(i))throw new Error("Destination handle is not a Buffer");let a=0,u=Buffer.allocUnsafe(4+1+4+4+9+4+t.length+8+8+4+i.length+8);Q(u,u.length-4,a),a+=4,u[a]=Be.EXTENDED,++a;let h=this._writeReqid=this._writeReqid+1&ht;Q(u,h,a),a+=4,Q(u,9,a),a+=4,u.utf8Write("copy-data",a,9),a+=9,Q(u,t.length,a),a+=4,u.set(t,a),a+=t.length;for(let A=7;A>=0;--A)u[a+A]=e&255,e/=256;a+=8;for(let A=7;A>=0;--A)u[a+A]=r&255,r/=256;a+=8,Q(u,i.length,a),a+=4,u.set(i,a),a+=i.length;for(let A=7;A>=0;--A)u[a+A]=s&255,s/=256;this._requests[h]={cb:o};let l=et(this,u);if(this._debug){let A=l?"Buffered":"Sending";this._debug(`SFTP: Outbound: ${A} copy-data`)}}handle(t,e){if(!this.server)throw new Error("Server-only method called in client mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");let r=e.length;if(r>256)throw new Error("handle too large (> 256 bytes)");let i=9,s=Buffer.allocUnsafe(4+1+4+4+r);Q(s,s.length-4,0),s[4]=Vt.HANDLE,Q(s,t,5),Q(s,r,i),r&&s.set(e,i+=4);let o=et(this,s);this._debug&&this._debug(`SFTP: Outbound: ${o?"Buffered":"Sending"} HANDLE`)}status(t,e,r){if(!this.server)throw new Error("Server-only method called in client mode");if(!Kg.has(e))throw new Error(`Bad status code: ${e}`);r||(r="");let i=Buffer.byteLength(r),s=9,o=Buffer.allocUnsafe(4+1+4+4+4+i+4);Q(o,o.length-4,0),o[4]=Vt.STATUS,Q(o,t,5),Q(o,e,s),Q(o,i,s+=4),s+=4,i&&(o.utf8Write(r,s,i),s+=i),Q(o,0,s);let f=et(this,o);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} STATUS`)}data(t,e,r){if(!this.server)throw new Error("Server-only method called in client mode");let i=Buffer.isBuffer(e);if(!i&&typeof e!="string")throw new Error("data is not a Buffer or string");let s;!i&&!r&&(r=void 0,s=!0);let o=i?e.length:Buffer.byteLength(e,r),f=9,a=Buffer.allocUnsafe(4+1+4+4+o);Q(a,a.length-4,0),a[4]=Vt.DATA,Q(a,t,5),Q(a,o,f),o&&(i?a.set(e,f+=4):s?a.utf8Write(e,f+=4,o):a.write(e,f+=4,o,r));let u=et(this,a);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} DATA`)}name(t,e){if(!this.server)throw new Error("Server-only method called in client mode");if(!Array.isArray(e)){if(typeof e!="object"||e===null)throw new Error("names is not an object or array");e=[e]}let r=e.length,i=0,s,o=[];for(let h=0;h<r;++h){let l=e[h],A=!l||!l.filename||typeof l.filename!="string"?"":l.filename;i+=4+Buffer.byteLength(A);let p=!l||!l.longname||typeof l.longname!="string"?"":l.longname;if(i+=4+Buffer.byteLength(p),typeof l.attrs=="object"&&l.attrs!==null){if(s=lr(l.attrs),i+=4+s.nb,s.nb){let y;s.nb===Re.length?y=new Uint8Array(Re):(y=new Uint8Array(s.nb),Xn(Re,y,0,s.nb,0)),s.bytes=y}o.push(s)}else i+=4,o.push(null)}let f=9,a=Buffer.allocUnsafe(4+1+4+4+i);Q(a,a.length-4,0),a[4]=Vt.NAME,Q(a,t,5),Q(a,r,f),f+=4;for(let h=0;h<r;++h){let l=e[h];{let p=!l||!l.filename||typeof l.filename!="string"?"":l.filename,y=Buffer.byteLength(p);Q(a,y,f),f+=4,y&&(a.utf8Write(p,f,y),f+=y)}{let p=!l||!l.longname||typeof l.longname!="string"?"":l.longname,y=Buffer.byteLength(p);Q(a,y,f),f+=4,y&&(a.utf8Write(p,f,y),f+=y)}let A=o[h];A?(Q(a,A.flags,f),f+=4,A.flags&&A.bytes&&(a.set(A.bytes,f),f+=A.nb)):(Q(a,0,f),f+=4)}let u=et(this,a);this._debug&&this._debug(`SFTP: Outbound: ${u?"Buffered":"Sending"} NAME`)}attrs(t,e){if(!this.server)throw new Error("Server-only method called in client mode");if(typeof e!="object"||e===null)throw new Error("attrs is not an object");e=lr(e);let r=e.flags,i=e.nb,s=9,o=Buffer.allocUnsafe(4+1+4+4+i);Q(o,o.length-4,0),o[4]=Vt.ATTRS,Q(o,t,5),Q(o,r,s),i&&(s+=4,i===Re.length?o.set(Re,s):Xn(Re,o,0,i,s),s+=i);let f=et(this,o);this._debug&&this._debug(`SFTP: Outbound: ${f?"Buffered":"Sending"} ATTRS`)}};function Xg(n){try{return Buffer.allocUnsafe(n)}catch(t){return t}}function Pl(n,t,e,r,i,s,o,f){let a=n._maxReadLen,u=Math.max(i-a,0);u&&(i=a);let h=t.length,l=9,A=s,p=Buffer.allocUnsafe(4+1+4+4+h+8+4);Q(p,p.length-4,0),p[4]=Be.READ;let y=n._writeReqid=n._writeReqid+1&ht;Q(p,y,5),Q(p,h,l),p.set(t,l+=4),l+=h;for(let x=7;x>=0;--x)p[l+x]=A&255,A/=256;Q(p,i,l+=8),typeof o!="function"&&(o=Ll);let I=f||{nb:0,position:s,off:r,origOff:r,len:void 0,overflow:void 0,cb:(x,O,X)=>{let H=I.len,te=I.overflow;if(x){if(o._wantEOFError||x.code!==tt.EOF)return o(x)}else{if(X>H)return o(new Error("Received more data than requested"));if(X===H&&te){I.nb+=X,I.position+=X,I.off+=X,Pl(n,t,e,I.off,te,I.position,o,I);return}}X=X||0,I.origOff===0&&e.length===I.nb?O=e:O=qr(e,I.origOff,I.origOff+I.nb+X),o(void 0,I.nb+X,O,I.position)},buffer:void 0};I.len=i,I.overflow=u,I.buffer=qr(e,r,r+i),n._requests[y]=I;let v=et(n,p);n._debug&&n._debug(`SFTP: Outbound: ${v?"Buffered":"Sending"} READ`)}function Bl(n,t,e,r,i,s){let o=64,f=32768,a,u,h;typeof i=="function"?s=i:typeof i=="object"&&i!==null&&(typeof i.concurrency=="number"&&i.concurrency>0&&!isNaN(i.concurrency)&&(o=i.concurrency),typeof i.chunkSize=="number"&&i.chunkSize>0&&!isNaN(i.chunkSize)&&(f=i.chunkSize),typeof i.fileSize=="number"&&i.fileSize>0&&!isNaN(i.fileSize)&&(h=i.fileSize),typeof i.step=="function"&&(a=i.step),(typeof i.mode=="string"||typeof i.mode=="number")&&(u=ia(i.mode)));let l,A=0,p=0,y=!1,I,v,x,O=f*o;function X(H){if(y)return;y=!0;let te=0,ce;I||v?(ce=()=>{--te===0&&s(H)},I&&(n===Vn||n.outgoing.state==="open")&&++te,v&&(t===Vn||t.outgoing.state==="open")&&++te,I&&(n===Vn||n.outgoing.state==="open")&&n.close(I,ce),v&&(t===Vn||t.outgoing.state==="open")&&t.close(v,ce)):s(H)}n.open(e,"r",(H,te)=>{if(H)return X(H);I=te,h===void 0?n.fstat(I,ce):ce(null,{size:h});function ce(M,q){if(M){if(n!==Vn){n.stat(e,(C,T)=>{if(C)return X(M);ce(null,T)});return}return X(M)}l=q.size,t.open(r,"w",(C,T)=>{if(C)return X(C);if(v=T,l<=0)return X();for(;O>l;){if(o===1){O=l;break}O-=f,--o}if(x=Xg(O),x instanceof Error)return X(x);u!==void 0?t.fchmod(v,u,function ie(ee){if(ee){t.chmod(r,u,w=>ie());return}re()}):re();function F(ie,ee,w,k,$,K){if(ie)return X(ie);$=$||0,t.write(v,x,$,ee,k,pe);function pe(Ne){if(Ne)return X(Ne);if(p+=ee,a&&a(p,ee,l),ee<K)return ne($,k+ee,K-ee);if(p===l){t.close(v,Qe=>{if(v=void 0,Qe)return X(Qe);n.close(I,St=>{if(I=void 0,St)return X(St);s()})});return}if(A>=l)return;let Ye=A+f>l?l-A:f;ne($,A,Ye),A+=Ye}}function D(ie,ee,w){return(k,$,K)=>{F(k,$,K,ee,ie,w)}}function ne(ie,ee,w){n.read(I,x,ie,w,ee,D(ie,ee,w))}function re(){let ie=0,ee=0;for(;A<l&&ie<o;){let w=A+f>l?l-A:f;ne(ee,A,w),ee+=w,A+=w,++ie}}})}})}function Zf(n,t,e,r,i,s,o){let f=typeof o=="function"?o:void 0;n.write(t,e,r,i,s,(a,u)=>{if(a)return n.close(t,()=>{f&&f(a)});u===i?n.close(t,f):(r+=u,i-=u,s+=u,Zf(n,t,e,r,i,s,f))})}var Hs=class{constructor(t){this.mode=t&&t.mode,this.uid=t&&t.uid,this.gid=t&&t.gid,this.size=t&&t.size,this.atime=t&&t.atime,this.mtime=t&&t.mtime,this.extended=t&&t.extended}isDirectory(){return(this.mode&Xt.S_IFMT)===Xt.S_IFDIR}isFile(){return(this.mode&Xt.S_IFMT)===Xt.S_IFREG}isBlockDevice(){return(this.mode&Xt.S_IFMT)===Xt.S_IFBLK}isCharacterDevice(){return(this.mode&Xt.S_IFMT)===Xt.S_IFCHR}isSymbolicLink(){return(this.mode&Xt.S_IFMT)===Xt.S_IFLNK}isFIFO(){return(this.mode&Xt.S_IFMT)===Xt.S_IFIFO}isSocket(){return(this.mode&Xt.S_IFMT)===Xt.S_IFSOCK}};function lr(n){let t=0,e=0;if(typeof n=="object"&&n!==null){if(typeof n.size=="number"){t|=Dn.SIZE;let r=n.size;Re[e++]=r/72057594037927940,Re[e++]=r/281474976710656,Re[e++]=r/1099511627776,Re[e++]=r/4294967296,Re[e++]=r/16777216,Re[e++]=r/65536,Re[e++]=r/256,Re[e++]=r}if(typeof n.uid=="number"&&typeof n.gid=="number"){t|=Dn.UIDGID;let r=n.uid,i=n.gid;Re[e++]=r>>>24,Re[e++]=r>>>16,Re[e++]=r>>>8,Re[e++]=r,Re[e++]=i>>>24,Re[e++]=i>>>16,Re[e++]=i>>>8,Re[e++]=i}if(typeof n.mode=="number"||typeof n.mode=="string"){let r=ia(n.mode);t|=Dn.PERMISSIONS,Re[e++]=r>>>24,Re[e++]=r>>>16,Re[e++]=r>>>8,Re[e++]=r}if((typeof n.atime=="number"||zf(n.atime))&&(typeof n.mtime=="number"||zf(n.mtime))){let r=Hr(n.atime),i=Hr(n.mtime);t|=Dn.ACMODTIME,Re[e++]=r>>>24,Re[e++]=r>>>16,Re[e++]=r>>>8,Re[e++]=r,Re[e++]=i>>>24,Re[e++]=i>>>16,Re[e++]=i>>>8,Re[e++]=i}}return{flags:t,nb:e}}function Hr(n){if(typeof n=="number"&&n===n)return n;if(zf(n))return parseInt(n.getTime()/1e3,10);throw new Error(`Cannot parse time: ${n}`)}function ia(n){if(typeof n=="number"&&n===n)return n;if(typeof n=="string")return ia(parseInt(n,8));throw new Error(`Cannot parse mode: ${n}`)}var ea={r:xe.READ,"r+":xe.READ|xe.WRITE,w:xe.TRUNC|xe.CREAT|xe.WRITE,wx:xe.TRUNC|xe.CREAT|xe.WRITE|xe.EXCL,xw:xe.TRUNC|xe.CREAT|xe.WRITE|xe.EXCL,"w+":xe.TRUNC|xe.CREAT|xe.READ|xe.WRITE,"wx+":xe.TRUNC|xe.CREAT|xe.READ|xe.WRITE|xe.EXCL,"xw+":xe.TRUNC|xe.CREAT|xe.READ|xe.WRITE|xe.EXCL,a:xe.APPEND|xe.CREAT|xe.WRITE,ax:xe.APPEND|xe.CREAT|xe.WRITE|xe.EXCL,xa:xe.APPEND|xe.CREAT|xe.WRITE|xe.EXCL,"a+":xe.APPEND|xe.CREAT|xe.READ|xe.WRITE,"ax+":xe.APPEND|xe.CREAT|xe.READ|xe.WRITE|xe.EXCL,"xa+":xe.APPEND|xe.CREAT|xe.READ|xe.WRITE|xe.EXCL};function Ul(n){let t=ea[n];return t!==void 0?t:null}var Vg=(()=>{let n=Object.keys(ea);return t=>{for(let e=0;e<n.length;++e){let r=n[e];if(ea[r]===t)return r}return null}})();function Fr(n){let t=N.readUInt32BE();if(t===void 0)return;let e=new Hs;if(t&Dn.SIZE){let r=N.readUInt64BE(n);if(r===void 0)return;e.size=r}if(t&Dn.UIDGID){let r=N.readUInt32BE(),i=N.readUInt32BE();if(i===void 0)return;e.uid=r,e.gid=i}if(t&Dn.PERMISSIONS){let r=N.readUInt32BE();if(r===void 0)return;e.mode=r}if(t&Dn.ACMODTIME){let r=N.readUInt32BE(),i=N.readUInt32BE();if(i===void 0)return;e.atime=r,e.mtime=i}if(t&Dn.EXTENDED){let r=N.readUInt32BE();if(r===void 0)return;let i={};for(let s=0;s<r;++s){let o=N.readString(!0),f=N.readString();if(f===void 0)return;i[o]=f}e.extended=i}return e}function et(n,t){let e=Dl(n,t);return e!==void 0?(n._buffer.push(e),!1):!0}function Dl(n,t){let e=n.outgoing;if(e.state!=="open")return;if(e.window===0)return n._waitWindow=!0,n._chunkcb=vl,t;let r,i=t.length,s=0;for(;i-s>0&&e.window>0;){let o=Math.min(i-s,e.window,e.packetSize);e.window-=o,e.window===0&&(n._waitWindow=!0,n._chunkcb=vl),s===0&&o===i?n._protocol.channelData(n.outgoing.id,t):n._protocol.channelData(n.outgoing.id,qr(t,s,s+o)),s+=o}return i-s>0&&(s>0?r=qr(t,s,i):r=t),r}function vl(){this._chunkcb=void 0;let n=this._buffer,t=0;for(;t<n.length;){let e=n[t],r=Dl(this,e);if(r!==void 0){r!==e&&(n[t]=r),t>0&&(this._buffer=n.slice(t));return}++t}t>0&&(this._buffer=[])}function st(n,t,e){let r=new Error(t);return r.level="sftp-protocol",!e&&n._debug&&n._debug(`SFTP: Inbound: ${t}`),n.emit("error",r),n.destroy(),Ql(n),!1}function Ql(n){let t=Object.keys(n._requests);if(t.length===0)return;let e=n._requests;n._requests={};let r=new Error("No response from server");for(let i=0;i<t.length;++i){let s=e[t[i]];typeof s.cb=="function"&&s.cb(r)}}function zg(n,t){let e=9,r=Buffer.allocUnsafe(4+1+4+4+18);Q(r,r.length-4,0),r[4]=Be.EXTENDED;let i=n._writeReqid=n._writeReqid+1&ht;Q(r,i,5),Q(r,18,e),r.utf8Write("limits@openssh.com",e+=4,18),n._requests[i]={extended:"limits@openssh.com",cb:t};let s=et(n,r);if(n._debug){let o=s?"Buffered":"Sending";n._debug(`SFTP: Outbound: ${o} limits@openssh.com`)}}var Jg={[Vt.VERSION]:(n,t)=>{if(n._version!==-1)return st(n,"Duplicate VERSION packet");let e={};N.init(t,1);let r=N.readUInt32BE();for(;N.avail();){let i=N.readString(!0),s=N.readString(!0);if(s===void 0){r=void 0;break}e[i]=s}if(N.clear(),r===void 0)return st(n,"Malformed VERSION packet");if(n._debug){let i=Object.keys(e);i.length?n._debug(`SFTP: Inbound: Received VERSION (v${r}, exts:${i})`):n._debug(`SFTP: Inbound: Received VERSION (v${r})`)}if(n._version=r,n._extensions=e,e["limits@openssh.com"]==="1")return zg(n,(i,s)=>{i||(s.maxPktLen>0&&(n._maxOutPktLen=s.maxPktLen),s.maxReadLen>0&&(n._maxReadLen=s.maxReadLen),s.maxWriteLen>0&&(n._maxWriteLen=s.maxWriteLen),n.maxOpenHandles=s.maxOpenHandles>0?s.maxOpenHandles:1/0),n.emit("ready")});n.emit("ready")},[Vt.STATUS]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readUInt32BE(),i=N.readString(!0);if(N.clear(),n._debug){let o=JSON.stringify(i);n._debug(`SFTP: Inbound: Received STATUS (id:${e}, ${r}, ${o})`)}let s=n._requests[e];if(delete n._requests[e],s&&typeof s.cb=="function"){if(r===tt.OK){s.cb();return}let o=new Error(i||Wg[r]||"Unknown status");o.code=r,s.cb(o)}},[Vt.HANDLE]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString();if(N.clear(),r===void 0)return e!==void 0&&delete n._requests[e],st(n,"Malformed HANDLE packet");n._debug&&n._debug(`SFTP: Inbound: Received HANDLE (id:${e})`);let i=n._requests[e];delete n._requests[e],i&&typeof i.cb=="function"&&i.cb(void 0,r)},[Vt.DATA]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r;if(e!==void 0&&(r=n._requests[e],delete n._requests[e]),r&&typeof r.cb=="function")if(r.buffer){let i=N.readString(r.buffer);if(N.clear(),i!==void 0){n._debug&&n._debug(`SFTP: Inbound: Received DATA (id:${e}, ${i})`),r.cb(void 0,r.buffer,i);return}}else{let i=N.readString();if(N.clear(),i!==void 0){n._debug&&n._debug(`SFTP: Inbound: Received DATA (id:${e}, ${i.length})`),r.cb(void 0,i);return}}else{let i=N.skipString();if(N.clear(),i!==void 0){n._debug&&n._debug(`SFTP: Inbound: Received DATA (id:${e}, ${i})`);return}}return st(n,"Malformed DATA packet")},[Vt.NAME]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r;e!==void 0&&(r=n._requests[e],delete n._requests[e]);let i=N.readUInt32BE();if(i!==void 0){let s=[];for(let o=0;o<i;++o){let f=N.readString(!0),a=N.readString(!0),u=Fr(n._biOpt);if(u===void 0){s=void 0;break}s.push({filename:f,longname:a,attrs:u})}if(s!==void 0){n._debug&&n._debug(`SFTP: Inbound: Received NAME (id:${e}, ${s.length})`),N.clear(),r&&typeof r.cb=="function"&&r.cb(void 0,s);return}}return N.clear(),st(n,"Malformed NAME packet")},[Vt.ATTRS]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r;e!==void 0&&(r=n._requests[e],delete n._requests[e]);let i=Fr(n._biOpt);if(N.clear(),i!==void 0){n._debug&&n._debug(`SFTP: Inbound: Received ATTRS (id:${e})`),r&&typeof r.cb=="function"&&r.cb(void 0,i);return}return st(n,"Malformed ATTRS packet")},[Vt.EXTENDED]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE();if(e!==void 0){let r=n._requests[e];if(r)switch(delete n._requests[e],r.extended){case"statvfs@openssh.com":case"fstatvfs@openssh.com":{let i=n._biOpt,s={f_bsize:N.readUInt64BE(i),f_frsize:N.readUInt64BE(i),f_blocks:N.readUInt64BE(i),f_bfree:N.readUInt64BE(i),f_bavail:N.readUInt64BE(i),f_files:N.readUInt64BE(i),f_ffree:N.readUInt64BE(i),f_favail:N.readUInt64BE(i),f_sid:N.readUInt64BE(i),f_flag:N.readUInt64BE(i),f_namemax:N.readUInt64BE(i)};if(s.f_namemax===void 0)break;n._debug&&n._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${e}, ${r.extended})`),N.clear(),typeof r.cb=="function"&&r.cb(void 0,s);return}case"limits@openssh.com":{let i={maxPktLen:N.readUInt64BE(),maxReadLen:N.readUInt64BE(),maxWriteLen:N.readUInt64BE(),maxOpenHandles:N.readUInt64BE()};if(i.maxOpenHandles===void 0)break;n._debug&&n._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${e}, ${r.extended})`),N.clear(),typeof r.cb=="function"&&r.cb(void 0,i);return}default:n._debug&&n._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${e}, ???)`),N.clear(),typeof r.cb=="function"&&r.cb();return}else{n._debug&&n._debug(`SFTP: Inbound: Received EXTENDED_REPLY (id:${e}, ???)`),N.clear();return}}return N.clear(),st(n,"Malformed EXTENDED_REPLY packet")}},Zg={[Be.INIT]:(n,t)=>{if(n._version!==-1)return st(n,"Duplicate INIT packet");let e={};N.init(t,1);let r=N.readUInt32BE();for(;N.avail();){let i=N.readString(!0),s=N.readString(!0);if(s===void 0){r=void 0;break}e[i]=s}if(N.clear(),r===void 0)return st(n,"Malformed INIT packet");if(n._debug){let i=Object.keys(e);i.length?n._debug(`SFTP: Inbound: Received INIT (v${r}, exts:${i})`):n._debug(`SFTP: Inbound: Received INIT (v${r})`)}et(n,$g),n._version=r,n._extensions=e,n.emit("ready")},[Be.OPEN]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString(!0),i=N.readUInt32BE(),s=Fr(n._biOpt);if(N.clear(),s===void 0)return st(n,"Malformed OPEN packet");n._debug&&n._debug(`SFTP: Inbound: Received OPEN (id:${e})`),n.emit("OPEN",e,r,i,s)||n.status(e,tt.OP_UNSUPPORTED)},[Be.CLOSE]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString();if(N.clear(),r===void 0||r.length>256)return st(n,"Malformed CLOSE packet");n._debug&&n._debug(`SFTP: Inbound: Received CLOSE (id:${e})`),n.emit("CLOSE",e,r)||n.status(e,tt.OP_UNSUPPORTED)},[Be.READ]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString(),i=N.readUInt64BE(n._biOpt),s=N.readUInt32BE();if(N.clear(),s===void 0||r.length>256)return st(n,"Malformed READ packet");n._debug&&n._debug(`SFTP: Inbound: Received READ (id:${e})`),n.emit("READ",e,r,i,s)||n.status(e,tt.OP_UNSUPPORTED)},[Be.WRITE]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString(),i=N.readUInt64BE(n._biOpt),s=N.readString();if(N.clear(),s===void 0||r.length>256)return st(n,"Malformed WRITE packet");n._debug&&n._debug(`SFTP: Inbound: Received WRITE (id:${e})`),n.emit("WRITE",e,r,i,s)||n.status(e,tt.OP_UNSUPPORTED)},[Be.LSTAT]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString(!0);if(N.clear(),r===void 0)return st(n,"Malformed LSTAT packet");n._debug&&n._debug(`SFTP: Inbound: Received LSTAT (id:${e})`),n.emit("LSTAT",e,r)||n.status(e,tt.OP_UNSUPPORTED)},[Be.FSTAT]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString();if(N.clear(),r===void 0||r.length>256)return st(n,"Malformed FSTAT packet");n._debug&&n._debug(`SFTP: Inbound: Received FSTAT (id:${e})`),n.emit("FSTAT",e,r)||n.status(e,tt.OP_UNSUPPORTED)},[Be.SETSTAT]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString(!0),i=Fr(n._biOpt);if(N.clear(),i===void 0)return st(n,"Malformed SETSTAT packet");n._debug&&n._debug(`SFTP: Inbound: Received SETSTAT (id:${e})`),n.emit("SETSTAT",e,r,i)||n.status(e,tt.OP_UNSUPPORTED)},[Be.FSETSTAT]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString(),i=Fr(n._biOpt);if(N.clear(),i===void 0||r.length>256)return st(n,"Malformed FSETSTAT packet");n._debug&&n._debug(`SFTP: Inbound: Received FSETSTAT (id:${e})`),n.emit("FSETSTAT",e,r,i)||n.status(e,tt.OP_UNSUPPORTED)},[Be.OPENDIR]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString(!0);if(N.clear(),r===void 0)return st(n,"Malformed OPENDIR packet");n._debug&&n._debug(`SFTP: Inbound: Received OPENDIR (id:${e})`),n.emit("OPENDIR",e,r)||n.status(e,tt.OP_UNSUPPORTED)},[Be.READDIR]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString();if(N.clear(),r===void 0||r.length>256)return st(n,"Malformed READDIR packet");n._debug&&n._debug(`SFTP: Inbound: Received READDIR (id:${e})`),n.emit("READDIR",e,r)||n.status(e,tt.OP_UNSUPPORTED)},[Be.REMOVE]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString(!0);if(N.clear(),r===void 0)return st(n,"Malformed REMOVE packet");n._debug&&n._debug(`SFTP: Inbound: Received REMOVE (id:${e})`),n.emit("REMOVE",e,r)||n.status(e,tt.OP_UNSUPPORTED)},[Be.MKDIR]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString(!0),i=Fr(n._biOpt);if(N.clear(),i===void 0)return st(n,"Malformed MKDIR packet");n._debug&&n._debug(`SFTP: Inbound: Received MKDIR (id:${e})`),n.emit("MKDIR",e,r,i)||n.status(e,tt.OP_UNSUPPORTED)},[Be.RMDIR]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString(!0);if(N.clear(),r===void 0)return st(n,"Malformed RMDIR packet");n._debug&&n._debug(`SFTP: Inbound: Received RMDIR (id:${e})`),n.emit("RMDIR",e,r)||n.status(e,tt.OP_UNSUPPORTED)},[Be.REALPATH]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString(!0);if(N.clear(),r===void 0)return st(n,"Malformed REALPATH packet");n._debug&&n._debug(`SFTP: Inbound: Received REALPATH (id:${e})`),n.emit("REALPATH",e,r)||n.status(e,tt.OP_UNSUPPORTED)},[Be.STAT]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString(!0);if(N.clear(),r===void 0)return st(n,"Malformed STAT packet");n._debug&&n._debug(`SFTP: Inbound: Received STAT (id:${e})`),n.emit("STAT",e,r)||n.status(e,tt.OP_UNSUPPORTED)},[Be.RENAME]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString(!0),i=N.readString(!0);if(N.clear(),i===void 0)return st(n,"Malformed RENAME packet");n._debug&&n._debug(`SFTP: Inbound: Received RENAME (id:${e})`),n.emit("RENAME",e,r,i)||n.status(e,tt.OP_UNSUPPORTED)},[Be.READLINK]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString(!0);if(N.clear(),r===void 0)return st(n,"Malformed READLINK packet");n._debug&&n._debug(`SFTP: Inbound: Received READLINK (id:${e})`),n.emit("READLINK",e,r)||n.status(e,tt.OP_UNSUPPORTED)},[Be.SYMLINK]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString(!0),i=N.readString(!0);if(N.clear(),i===void 0)return st(n,"Malformed SYMLINK packet");n._debug&&n._debug(`SFTP: Inbound: Received SYMLINK (id:${e})`);let s;n._isOpenSSH?s=n.emit("SYMLINK",e,i,r):s=n.emit("SYMLINK",e,r,i),s||n.status(e,tt.OP_UNSUPPORTED)},[Be.EXTENDED]:(n,t)=>{N.init(t,1);let e=N.readUInt32BE(),r=N.readString(!0);if(r===void 0)return N.clear(),st(n,"Malformed EXTENDED packet");let i;N.avail()&&(i=N.readRaw()),N.clear(),n._debug&&n._debug(`SFTP: Inbound: Received EXTENDED (id:${e})`),n.emit("EXTENDED",e,r,i)||n.status(e,tt.OP_UNSUPPORTED)}},{ERR_INVALID_ARG_TYPE:eE,ERR_OUT_OF_RANGE:Qs,validateNumber:tE}=Cl(),Nl=128,Wt,ta=[];function nE(n){ta.length>0?Wt=ta.pop():Wt=Buffer.allocUnsafe(n),Wt.used=0}function na(n,t){if(!Number.isSafeInteger(n))throw tE(n,t),Number.isInteger(n)?new Qs(t,">= 0 and <= 2 ** 53 - 1",n):new Qs(t,"an integer",n);if(n<0)throw new Qs(t,">= 0 and <= 2 ** 53 - 1",n)}function Vf(n){return n+7&-8}function Qn(n,t,e){if(e===void 0)e={};else if(typeof e=="string")e={encoding:e};else{if(e===null||typeof e!="object")throw new TypeError('"options" argument must be a string or an object');e=Object.create(e)}if(e.highWaterMark===void 0&&(e.highWaterMark=64*1024),e.emitClose=!1,e.autoDestroy=!1,Tl.call(this,e),this.path=t,this.flags=e.flags===void 0?"r":e.flags,this.mode=e.mode===void 0?438:e.mode,this.start=e.start,this.end=e.end,this.autoClose=e.autoClose===void 0?!0:e.autoClose,this.pos=0,this.bytesRead=0,this.isClosed=!1,this.handle=e.handle===void 0?null:e.handle,this.sftp=n,this._opening=!1,this.start!==void 0&&(na(this.start,"start"),this.pos=this.start),this.end===void 0)this.end=1/0;else if(this.end!==1/0&&(na(this.end,"end"),this.start!==void 0&&this.start>this.end))throw new Qs("start",`<= "end" (here: ${this.end})`,this.start);this.on("end",function(){this.autoClose&&this.destroy()}),Buffer.isBuffer(this.handle)||this.open()}Ol(Qn,Tl);Qn.prototype.open=function(){this._opening||(this._opening=!0,this.sftp.open(this.path,this.flags,this.mode,(n,t)=>{if(this._opening=!1,n){this.emit("error",n),this.autoClose&&this.destroy();return}this.handle=t,this.emit("open",t),this.emit("ready"),this.read()}))};Qn.prototype._read=function(n){if(!Buffer.isBuffer(this.handle))return this.once("open",()=>this._read(n));if(this.destroyed)return;(!Wt||Wt.length-Wt.used<Nl)&&nE(this.readableHighWaterMark||this._readableState.highWaterMark);let t=Wt,e=Math.min(Wt.length-Wt.used,n),r=Wt.used;if(this.end!==void 0&&(e=Math.min(this.end-this.pos+1,e)),e<=0)return this.push(null);this.sftp.read(this.handle,Wt,Wt.used,e,this.pos,(i,s)=>{if(i){this.emit("error",i),this.autoClose&&this.destroy();return}let o=null;if(r+e===t.used&&t===Wt)t.used=Vf(t.used+s-e);else{let f=r+e&-8,a=Vf(r+s);f-a>=Nl&&ta.push(t.slice(a,f))}s>0&&(this.bytesRead+=s,o=t.slice(r,r+s)),this.pos+=s,this.push(o)}),Wt.used=Vf(Wt.used+e)};Qn.prototype._destroy=function(n,t){if(this._opening&&!Buffer.isBuffer(this.handle)){this.once("open",kl.bind(null,this,t,n));return}kl(this,t,n),this.handle=null,this._opening=!1};function kl(n,t,e){if(!n.handle)return r();n.sftp.close(n.handle,r);function r(i){i=i||e,t(i),n.isClosed=!0,i||n.emit("close")}}Qn.prototype.close=function(n){this.destroy(null,n)};Object.defineProperty(Qn.prototype,"pending",{get(){return this.handle===null},configurable:!0});function un(n,t,e){if(e===void 0)e={};else if(typeof e=="string")e={encoding:e};else{if(e===null||typeof e!="object")throw new TypeError('"options" argument must be a string or an object');e=Object.create(e)}e.emitClose=!1,e.autoDestroy=!1,ra.call(this,e),this.path=t,this.flags=e.flags===void 0?"w":e.flags,this.mode=e.mode===void 0?438:e.mode,this.start=e.start,this.autoClose=e.autoClose===void 0?!0:e.autoClose,this.pos=0,this.bytesWritten=0,this.isClosed=!1,this.handle=e.handle===void 0?null:e.handle,this.sftp=n,this._opening=!1,this.start!==void 0&&(na(this.start,"start"),this.pos=this.start),e.encoding&&this.setDefaultEncoding(e.encoding),this.on("finish",function(){this._writableState.finalCalled||this.autoClose&&this.destroy()}),Buffer.isBuffer(this.handle)||this.open()}Ol(un,ra);un.prototype._final=function(n){this.autoClose&&this.destroy(),n()};un.prototype.open=function(){this._opening||(this._opening=!0,this.sftp.open(this.path,this.flags,this.mode,(n,t)=>{if(this._opening=!1,n){this.emit("error",n),this.autoClose&&this.destroy();return}this.handle=t;let e=r=>{if(r){this.sftp.chmod(this.path,this.mode,i=>e());return}if(this.flags[0]==="a"){let i=(s,o)=>{if(s){this.sftp.stat(this.path,(f,a)=>{if(f){this.destroy(),this.emit("error",s);return}i(null,a)});return}this.pos=o.size,this.emit("open",t),this.emit("ready")};this.sftp.fstat(t,i);return}this.emit("open",t),this.emit("ready")};this.sftp.fchmod(t,this.mode,e)}))};un.prototype._write=function(n,t,e){if(!Buffer.isBuffer(n)){let r=new eE("data","Buffer",n);return this.emit("error",r)}if(!Buffer.isBuffer(this.handle))return this.once("open",function(){this._write(n,t,e)});this.sftp.write(this.handle,n,0,n.length,this.pos,(r,i)=>{if(r)return this.autoClose&&this.destroy(),e(r);this.bytesWritten+=i,e()}),this.pos+=n.length};un.prototype._writev=function(n,t){if(!Buffer.isBuffer(this.handle))return this.once("open",function(){this._writev(n,t)});let e=this.sftp,r=this.handle,i=n.length,s=(o,f)=>{if(o)return this.destroy(),t(o);this.bytesWritten+=f,--i===0&&t()};for(let o=0;o<n.length;++o){let f=n[o].chunk;e.write(r,f,0,f.length,this.pos,s),this.pos+=f.length}};typeof ra.prototype.destroy!="function"&&(un.prototype.destroy=Qn.prototype.destroy);un.prototype._destroy=Qn.prototype._destroy;un.prototype.close=function(n){if(n){if(this.isClosed){process.nextTick(n);return}this.on("close",n)}this.autoClose||this.on("finish",this.destroy.bind(this)),this.end()};un.prototype.destroySoon=un.prototype.end;Object.defineProperty(un.prototype,"pending",{get(){return this.handle===null},configurable:!0});Hl.exports={flagsToString:Vg,OPEN_MODE:xe,SFTP:Jf,Stats:Hs,STATUS_CODE:tt,stringToFlags:Ul}});var ua=_e((Db,Kl)=>{"use strict";var{Duplex:rE,Readable:iE,Writable:sE}=require("stream"),{CHANNEL_EXTENDED_DATATYPE:{STDERR:Fl}}=Ln(),{bufferSlice:Fs}=An(),oE=32*1024,wi=2*1024*1024,aa=wi/2,sa=class extends iE{constructor(t,e){super(e),this._channel=t}_read(t){this._channel._waitChanDrain&&(this._channel._waitChanDrain=!1,this._channel.incoming.window<=aa&&ca(this._channel))}},oa=class extends sE{constructor(t){super({highWaterMark:wi}),this._channel=t}_write(t,e,r){let i=this._channel,s=i._client._protocol,o=i.outgoing,f=o.packetSize,a=o.id,u=o.window,h=t.length,l=0;if(o.state==="open"){for(;h-l>0&&u>0;){let A=h-l;A>u&&(A=u),A>f&&(A=f),l===0&&A===h?s.channelExtData(a,t,Fl):s.channelExtData(a,Fs(t,l,l+A),Fl),l+=A,u-=A}if(o.window=u,h-l>0){u===0&&(i._waitWindow=!0),l>0?i._chunkErr=Fs(t,l,h):i._chunkErr=t,i._chunkcbErr=r;return}r()}}},fa=class extends rE{constructor(t,e,r){let i={highWaterMark:wi,allowHalfOpen:!r||r&&r.allowHalfOpen!==!1,emitClose:!1};super(i),this.allowHalfOpen=i.allowHalfOpen;let s=!!(r&&r.server);this.server=s,this.type=e.type,this.subtype=void 0,this.incoming=e.incoming,this.outgoing=e.outgoing,this._callbacks=[],this._client=t,this._hasX11=!1,this._exit={code:void 0,signal:void 0,dump:void 0,desc:void 0},this.stdin=this.stdout=this,s?this.stderr=new oa(this):this.stderr=new sa(this,i),this._waitWindow=!1,this._waitChanDrain=!1,this._chunk=void 0,this._chunkcb=void 0,this._chunkErr=void 0,this._chunkcbErr=void 0,this.on("finish",ql).on("prefinish",ql),this.on("end",Ml).on("close",Ml)}_read(t){this._waitChanDrain&&(this._waitChanDrain=!1,this.incoming.window<=aa&&ca(this))}_write(t,e,r){let i=this._client._protocol,s=this.outgoing,o=s.packetSize,f=s.id,a=s.window,u=t.length,h=0;if(s.state==="open"){for(;u-h>0&&a>0;){let l=u-h;l>a&&(l=a),l>o&&(l=o),h===0&&l===u?i.channelData(f,t):i.channelData(f,Fs(t,h,h+l)),h+=l,a-=l}if(s.window=a,u-h>0){a===0&&(this._waitWindow=!0),h>0?this._chunk=Fs(t,h,u):this._chunk=t,this._chunkcb=r;return}r()}}eof(){this.outgoing.state==="open"&&(this.outgoing.state="eof",this._client._protocol.channelEOF(this.outgoing.id))}close(){(this.outgoing.state==="open"||this.outgoing.state==="eof")&&(this.outgoing.state="closing",this._client._protocol.channelClose(this.outgoing.id))}destroy(){return this.end(),this.close(),this}setWindow(t,e,r,i){if(this.server)throw new Error("Client-only method called in server mode");this.type==="session"&&(this.subtype==="shell"||this.subtype==="exec")&&this.writable&&this.outgoing.state==="open"&&this._client._protocol.windowChange(this.outgoing.id,t,e,r,i)}signal(t){if(this.server)throw new Error("Client-only method called in server mode");this.type==="session"&&this.writable&&this.outgoing.state==="open"&&this._client._protocol.signal(this.outgoing.id,t)}exit(t,e,r){if(!this.server)throw new Error("Server-only method called in client mode");this.type==="session"&&this.writable&&this.outgoing.state==="open"&&(typeof t=="number"?this._client._protocol.exitStatus(this.outgoing.id,t):this._client._protocol.exitSignal(this.outgoing.id,t,e,r))}};function ql(){this.eof(),(this.server||!this.allowHalfOpen)&&this.close(),this.writable=!1}function Ml(){this.readable=!1}function ca(n){if(n.outgoing.state==="closed")return;let t=wi-n.incoming.window;t<=0||(n.incoming.window+=t,n._client._protocol.channelWindowAdjust(n.outgoing.id,t))}Kl.exports={Channel:fa,MAX_WINDOW:wi,PACKET_SIZE:oE,windowAdjust:ca,WINDOW_THRESHOLD:aa}});var da=_e((Qb,$l)=>{"use strict";var{SFTP:fE}=xi(),Si=2**32-1;function Wl(n,t,e,r){if(n._chanMgr.remove(t),typeof r!="function")return;let i;e instanceof Error?i=e:typeof e=="object"&&e!==null?(i=new Error(`(SSH) Channel open failure: ${e.description}`),i.reason=e.reason):(i=new Error("(SSH) Channel open failure: server closed channel unexpectedly"),i.reason=""),r(i)}function Gl(n,t,e,r,i){if(typeof e=="function"){Wl(n,t,r,e);return}if(typeof e!="object"||e===null||e.incoming&&e.incoming.state==="closed"||(n._chanMgr.remove(t),e.server&&e.constructor.name==="Session"))return;e.incoming.state="closed",e.readable&&e.push(null),e.server?e.stderr.writable&&e.stderr.end():e.stderr.readable&&e.stderr.push(null),e.constructor!==fE&&(e.outgoing.state==="open"||e.outgoing.state==="eof")&&!i&&e.close(),e.outgoing.state==="closing"&&(e.outgoing.state="closed");let s=e._readableState,o=e._writableState;o&&!o.ending&&!o.finished&&!i&&e.end();let f=e._callbacks;e._callbacks=[];for(let a=0;a<f.length;++a)f[a](!0);if(e.server)!e.readable||e.destroyed||s&&s.endEmitted?e.emit("close"):e.once("end",()=>e.emit("close"));else{let a;switch(e.type){case"direct-streamlocal@openssh.com":case"direct-tcpip":a=()=>e.emit("close");break;default:{let h=e._exit;a=()=>{h.code===null?e.emit("close",h.code,h.signal,h.dump,h.desc):e.emit("close",h.code)}}}!e.readable||e.destroyed||s&&s.endEmitted?a():e.once("end",a);let u=e.stderr._readableState;!e.stderr.readable||e.stderr.destroyed||u&&u.endEmitted?e.stderr.emit("close"):e.stderr.once("end",()=>e.stderr.emit("close"))}}var ha=class{constructor(t){this._client=t,this._channels={},this._cur=-1,this._count=0}add(t){let e;if(this._cur<Si)e=++this._cur;else if(this._count===0)this._cur=0,e=0;else{let r=this._channels;for(let i=0;i<Si;++i)if(r[i]===void 0){e=i;break}}return e===void 0?-1:(this._channels[e]=t||!0,++this._count,e)}update(t,e){if(typeof t!="number"||t<0||t>=Si||!isFinite(t))throw new Error(`Invalid channel id: ${t}`);e&&this._channels[t]&&(this._channels[t]=e)}get(t){if(typeof t!="number"||t<0||t>=Si||!isFinite(t))throw new Error(`Invalid channel id: ${t}`);return this._channels[t]}remove(t){if(typeof t!="number"||t<0||t>=Si||!isFinite(t))throw new Error(`Invalid channel id: ${t}`);this._channels[t]&&(delete this._channels[t],this._count&&--this._count)}cleanup(t){let e=this._channels;this._channels={},this._cur=-1,this._count=0;let r=Object.keys(e),i=this._client;for(let s=0;s<r.length;++s){let o=+r[s],f=e[o];Gl(i,o,f._channel||f,t,!0)}}},la=(()=>{let n=Object.prototype.toString;return t=>n.call(t)==="[object RegExp]"})();function aE(n,t,e){if(Array.isArray(n)&&n.length>0){for(let r=0;r<n.length;++r)if(e.indexOf(n[r])===-1)throw new Error(`Unsupported algorithm: ${n[r]}`);return n}if(typeof n=="object"&&n!==null){let r=Object.keys(n),i=t;for(let s=0;s<r.length;++s){let o=r[s],f=n[o];switch(o){case"append":if(Array.isArray(f)||(f=[f]),Array.isArray(f))for(let a=0;a<f.length;++a){let u=f[a];if(typeof u=="string"){if(!u||i.indexOf(u)!==-1)continue;if(e.indexOf(u)===-1)throw new Error(`Unsupported algorithm: ${u}`);i===t&&(i=i.slice()),i.push(u)}else if(la(u))for(let h=0;h<e.length;++h){let l=e[h];if(u.test(l)){if(i.indexOf(l)!==-1)continue;i===t&&(i=i.slice()),i.push(l)}}}break;case"prepend":if(Array.isArray(f)||(f=[f]),Array.isArray(f))for(let a=f.length;a>=0;--a){let u=f[a];if(typeof u=="string"){if(!u||i.indexOf(u)!==-1)continue;if(e.indexOf(u)===-1)throw new Error(`Unsupported algorithm: ${u}`);i===t&&(i=i.slice()),i.unshift(u)}else if(la(u))for(let h=e.length;h>=0;--h){let l=e[h];if(u.test(l)){if(i.indexOf(l)!==-1)continue;i===t&&(i=i.slice()),i.unshift(l)}}}break;case"remove":if(Array.isArray(f)||(f=[f]),Array.isArray(f))for(let a=0;a<f.length;++a){let u=f[a];if(typeof u=="string"){if(!u)continue;let h=i.indexOf(u);if(h===-1)continue;i===t&&(i=i.slice()),i.splice(h,1)}else if(la(u))for(let h=0;h<i.length;++h)u.test(i[h])&&(i===t&&(i=i.slice()),i.splice(h,1),--h)}break}}return i}return t}$l.exports={ChannelManager:ha,generateAlgorithmList:aE,onChannelOpenFailure:Wl,onCHANNEL_CLOSE:Gl,isWritable:n=>n&&n.writable&&n._readableState&&n._readableState.ended===!1}});var Ea=_e((Hb,dh)=>{"use strict";var{createHash:cE,getHashes:uE,randomFillSync:lE}=require("crypto"),{Socket:hE}=require("net"),{lookup:dE}=require("dns"),AE=require("events"),_E=uE(),{COMPAT:gE,CHANNEL_EXTENDED_DATATYPE:{STDERR:EE},CHANNEL_OPEN_FAILURE:mi,DEFAULT_CIPHER:Yl,DEFAULT_COMPRESSION:jl,DEFAULT_KEX:Xl,DEFAULT_MAC:Vl,DEFAULT_SERVER_HOST_KEY:zl,DISCONNECT_REASON:Jl,DISCONNECT_REASON_BY_VALUE:pE,SUPPORTED_CIPHER:bE,SUPPORTED_COMPRESSION:IE,SUPPORTED_KEX:yE,SUPPORTED_MAC:xE,SUPPORTED_SERVER_HOST_KEY:wE}=Ln(),{init:SE}=fr(),mE=jf(),{parseKey:Ks}=jn(),{SFTP:CE}=xi(),{bufferCopy:Zl,makeBufferParser:lh,makeError:RE,readUInt32BE:BE,sigSSHToASN1:vE,writeUInt32BE:Aa}=An(),{AgentContext:eh,createAgent:th,isAgent:nh}=kf(),{Channel:hh,MAX_WINDOW:Ws,PACKET_SIZE:Gs,windowAdjust:rh,WINDOW_THRESHOLD:ih}=ua(),{ChannelManager:NE,generateAlgorithmList:Ci,isWritable:Ct,onChannelOpenFailure:kE,onCHANNEL_CLOSE:TE}=da(),qs=lh(),Ms=lh(),Ri=/^OpenSSH_(?:(?![0-4])\d)|(?:\d{2,})/,_a=n=>{},ga=class extends AE{constructor(){super(),this.config={host:void 0,port:void 0,localAddress:void 0,localPort:void 0,forceIPv4:void 0,forceIPv6:void 0,keepaliveCountMax:void 0,keepaliveInterval:void 0,readyTimeout:void 0,ident:void 0,username:void 0,password:void 0,privateKey:void 0,tryKeyboard:void 0,agent:void 0,allowAgentFwd:void 0,authHandler:void 0,hostHashAlgo:void 0,hostHashCb:void 0,strictVendor:void 0,debug:void 0},this._agent=void 0,this._readyTimeout=void 0,this._chanMgr=void 0,this._callbacks=void 0,this._forwarding=void 0,this._forwardingUnix=void 0,this._acceptX11=void 0,this._agentFwdEnabled=void 0,this._remoteVer=void 0,this._protocol=void 0,this._sock=void 0,this._resetKA=void 0}connect(t){if(this._sock&&Ct(this._sock))return this.once("close",()=>{this.connect(t)}),this.end(),this;this.config.host=t.hostname||t.host||"localhost",this.config.port=t.port||22,this.config.localAddress=typeof t.localAddress=="string"?t.localAddress:void 0,this.config.localPort=typeof t.localPort=="string"||typeof t.localPort=="number"?t.localPort:void 0,this.config.forceIPv4=t.forceIPv4||!1,this.config.forceIPv6=t.forceIPv6||!1,this.config.keepaliveCountMax=typeof t.keepaliveCountMax=="number"&&t.keepaliveCountMax>=0?t.keepaliveCountMax:3,this.config.keepaliveInterval=typeof t.keepaliveInterval=="number"&&t.keepaliveInterval>0?t.keepaliveInterval:0,this.config.readyTimeout=typeof t.readyTimeout=="number"&&t.readyTimeout>=0?t.readyTimeout:2e4,this.config.ident=typeof t.ident=="string"||Buffer.isBuffer(t.ident)?t.ident:void 0;let e={kex:void 0,serverHostKey:void 0,cs:{cipher:void 0,mac:void 0,compress:void 0,lang:[]},sc:void 0},r=!0;if(typeof t.algorithms=="object"&&t.algorithms!==null&&(e.kex=Ci(t.algorithms.kex,Xl,yE),e.kex!==Xl&&(r=!1),e.serverHostKey=Ci(t.algorithms.serverHostKey,zl,wE),e.serverHostKey!==zl&&(r=!1),e.cs.cipher=Ci(t.algorithms.cipher,Yl,bE),e.cs.cipher!==Yl&&(r=!1),e.cs.mac=Ci(t.algorithms.hmac,Vl,xE),e.cs.mac!==Vl&&(r=!1),e.cs.compress=Ci(t.algorithms.compress,jl,IE),e.cs.compress!==jl&&(r=!1),r||(e.sc=e.cs)),typeof t.username=="string")this.config.username=t.username;else if(typeof t.user=="string")this.config.username=t.user;else throw new Error("Invalid username");this.config.password=typeof t.password=="string"?t.password:void 0,this.config.privateKey=typeof t.privateKey=="string"||Buffer.isBuffer(t.privateKey)?t.privateKey:void 0,this.config.localHostname=typeof t.localHostname=="string"?t.localHostname:void 0,this.config.localUsername=typeof t.localUsername=="string"?t.localUsername:void 0,this.config.tryKeyboard=t.tryKeyboard===!0,typeof t.agent=="string"&&t.agent.length?this.config.agent=th(t.agent):nh(t.agent)?this.config.agent=t.agent:this.config.agent=void 0,this.config.allowAgentFwd=t.agentForward===!0&&this.config.agent!==void 0;let i=this.config.authHandler=typeof t.authHandler=="function"||Array.isArray(t.authHandler)?t.authHandler:void 0;this.config.strictVendor=typeof t.strictVendor=="boolean"?t.strictVendor:!0;let s=this.config.debug=typeof t.debug=="function"?t.debug:void 0;if(t.agentForward===!0&&!this.config.allowAgentFwd)throw new Error("You must set a valid agent path to allow agent forwarding");let o=this._callbacks=[];this._chanMgr=new NE(this),this._forwarding={},this._forwardingUnix={},this._acceptX11=0,this._agentFwdEnabled=!1,this._agent=this.config.agent?this.config.agent:void 0,this._remoteVer=void 0;let f;if(this.config.privateKey){if(f=Ks(this.config.privateKey,t.passphrase),f instanceof Error)throw new Error(`Cannot parse privateKey: ${f.message}`);if(Array.isArray(f)&&(f=f[0]),f.getPrivatePEM()===null)throw new Error("privateKey value does not contain a (valid) private key")}let a;if(typeof t.hostVerifier=="function"){let w=t.hostVerifier,k;_E.indexOf(t.hostHash)!==-1&&(k=cE(t.hostHash)),a=($,K)=>{k&&(k.update($),$=k.digest("hex"));let pe=w($,K);pe!==void 0&&K(pe)}}let u=this._sock=t.sock||new hE,h=!1,l=!1;this._protocol&&this._protocol.cleanup();let A=s?(w,k,$)=>{s(`Debug output from server: ${JSON.stringify($)}`)}:void 0,p=this._protocol=new mE({ident:this.config.ident,offer:r?void 0:e,onWrite:w=>{Ct(u)&&u.write(w)},onError:w=>{w.level==="handshake"&&clearTimeout(this._readyTimeout),p._destruct||u.removeAllListeners("data"),this.emit("error",w);try{u.end()}catch{}},onHeader:w=>{l=!0,this._remoteVer=w.versions.software,w.greeting&&this.emit("greeting",w.greeting)},onHandshakeComplete:w=>{this.emit("handshake",w),h||(h=!0,p.service("ssh-userauth"))},debug:s,hostVerifier:a,messageHandlers:{DEBUG:A,DISCONNECT:(w,k,$)=>{if(k!==Jl.BY_APPLICATION){$||($=pE[k],$===void 0&&($=`Unexpected disconnection reason: ${k}`));let K=new Error($);K.code=k,this.emit("error",K)}u.end()},SERVICE_ACCEPT:(w,k)=>{k==="ssh-userauth"&&re()},USERAUTH_BANNER:(w,k)=>{this.emit("banner",k)},USERAUTH_SUCCESS:w=>{X(),clearTimeout(this._readyTimeout),this.emit("ready")},USERAUTH_FAILURE:(w,k,$)=>{if(M.type==="agent"){let K=M.agentCtx.pos();return s&&s(`Client: Agent key #${K+1} failed`),ie()}s&&s(`Client: ${M.type} auth failed`),q=$,C=k,re()},USERAUTH_PASSWD_CHANGEREQ:(w,k)=>{M.type==="password"&&this.emit("change password",k,$=>{p.authPassword(this.config.username,this.config.password,$)})},USERAUTH_PK_OK:w=>{if(M.type==="agent"){let k=M.agentCtx.currentKey();p.authPK(M.username,k,($,K)=>{M.agentCtx.sign(k,$,{},(pe,Ne)=>{if(pe)pe.level="agent",this.emit("error",pe);else return K(Ne);ie()})})}else M.type==="publickey"&&p.authPK(M.username,M.key,(k,$)=>{let K=M.key.sign(k);if(K instanceof Error)return K.message=`Error signing data with key: ${K.message}`,K.level="client-authentication",this.emit("error",K),re();$(K)})},USERAUTH_INFO_REQUEST:(w,k,$,K)=>{if(M.type==="keyboard-interactive"){if((Array.isArray(K)?K.length:0)===0){s&&s("Client: Sending automatic USERAUTH_INFO_RESPONSE"),p.authInfoRes();return}M.prompt(k,$,"",K,Ne=>{p.authInfoRes(Ne)})}},REQUEST_SUCCESS:(w,k)=>{o.length&&o.shift()(!1,k)},REQUEST_FAILURE:w=>{o.length&&o.shift()(!0)},GLOBAL_REQUEST:(w,k,$,K)=>{switch(k){case"hostkeys-00@openssh.com":DE(this,K,(pe,Ne)=>{pe||this.emit("hostkeys",Ne)}),$&&p.requestSuccess();break;default:$&&p.requestFailure()}},CHANNEL_OPEN:(w,k)=>{PE(this,k)},CHANNEL_OPEN_CONFIRMATION:(w,k)=>{let $=this._chanMgr.get(k.recipient);if(typeof $!="function")return;let K=$.type==="sftp",Ne={type:K?"session":$.type,incoming:{id:k.recipient,window:Ws,packetSize:Gs,state:"open"},outgoing:{id:k.sender,window:k.window,packetSize:k.packetSize,state:"open"}},Ye=K?new CE(this,Ne,{debug:s}):new hh(this,Ne);this._chanMgr.update(k.recipient,Ye),$(void 0,Ye)},CHANNEL_OPEN_FAILURE:(w,k,$,K)=>{let pe=this._chanMgr.get(k);if(typeof pe!="function")return;kE(this,k,{reason:$,description:K},pe)},CHANNEL_DATA:(w,k,$)=>{let K=this._chanMgr.get(k);if(!(typeof K!="object"||K===null)&&K.incoming.window!==0){if(K.incoming.window-=$.length,K.push($)===!1){K._waitChanDrain=!0;return}K.incoming.window<=ih&&rh(K)}},CHANNEL_EXTENDED_DATA:(w,k,$,K)=>{if(K!==EE)return;let pe=this._chanMgr.get(k);if(!(typeof pe!="object"||pe===null)&&pe.incoming.window!==0){if(pe.incoming.window-=$.length,!pe.stderr.push($)){pe._waitChanDrain=!0;return}pe.incoming.window<=ih&&rh(pe)}},CHANNEL_WINDOW_ADJUST:(w,k,$)=>{let K=this._chanMgr.get(k);typeof K!="object"||K===null||(K.outgoing.window+=$,K._waitWindow&&(K._waitWindow=!1,K._chunk?K._write(K._chunk,null,K._chunkcb):K._chunkcb?K._chunkcb():K._chunkErr?K.stderr._write(K._chunkErr,null,K._chunkcbErr):K._chunkcbErr&&K._chunkcbErr()))},CHANNEL_SUCCESS:(w,k)=>{let $=this._chanMgr.get(k);typeof $!="object"||$===null||(this._resetKA(),$._callbacks.length&&$._callbacks.shift()(!1))},CHANNEL_FAILURE:(w,k)=>{let $=this._chanMgr.get(k);typeof $!="object"||$===null||(this._resetKA(),$._callbacks.length&&$._callbacks.shift()(!0))},CHANNEL_REQUEST:(w,k,$,K,pe)=>{let Ne=this._chanMgr.get(k);if(typeof Ne!="object"||Ne===null)return;let Ye=Ne._exit;if(Ye.code===void 0){switch($){case"exit-status":Ne.emit("exit",Ye.code=pe);return;case"exit-signal":Ne.emit("exit",Ye.code=null,Ye.signal=`SIG${pe.signal}`,Ye.dump=pe.coreDumped,Ye.desc=pe.errorMessage);return}K&&w.channelFailure(Ne.outgoing.id)}},CHANNEL_EOF:(w,k)=>{let $=this._chanMgr.get(k);typeof $!="object"||$===null||$.incoming.state==="open"&&($.incoming.state="eof",$.readable&&$.push(null),$.stderr.readable&&$.stderr.push(null))},CHANNEL_CLOSE:(w,k)=>{TE(this,k,this._chanMgr.get(k))}}});u.pause();let y=this.config.keepaliveInterval,I=this.config.keepaliveCountMax,v=0,x,O=()=>{if(++v>I){if(clearInterval(x),u.readable){let w=new Error("Keepalive timeout");w.level="client-timeout",this.emit("error",w),u.destroy()}return}Ct(u)?(o.push(X),p.ping()):clearInterval(x)};function X(){y>0&&(v=0,clearInterval(x),Ct(u)&&(x=setInterval(O,y)))}this._resetKA=X;let H=(()=>{let w=!1;return()=>{if(!w&&(w=!0,ce&&!l)){let k=RE("Connection lost before handshake","protocol",!0);this.emit("error",k)}}})(),te=(()=>{let w=!1;return()=>{w||(w=!0,ce=!0,s&&s("Socket connected"),this.emit("connect"),SE.then(()=>{p.start(),u.on("data",k=>{try{p.parse(k,0,k.length)}catch($){this.emit("error",$);try{Ct(u)&&u.end()}catch{}}}),u.stderr&&typeof u.stderr.resume=="function"&&u.stderr.resume(),u.resume()}).catch(k=>{this.emit("error",k);try{Ct(u)&&u.end()}catch{}}))}})(),ce=!1;u.on("connect",te).on("timeout",()=>{this.emit("timeout")}).on("error",w=>{s&&s(`Socket error: ${w.message}`),clearTimeout(this._readyTimeout),w.level="client-socket",this.emit("error",w)}).on("end",()=>{s&&s("Socket ended"),H(),p.cleanup(),clearTimeout(this._readyTimeout),clearInterval(x),this.emit("end")}).on("close",()=>{s&&s("Socket closed"),H(),p.cleanup(),clearTimeout(this._readyTimeout),clearInterval(x),this.emit("close");let w=o;o=this._callbacks=[];let k=new Error("No response from server");for(let $=0;$<w.length;++$)w[$](k);this._chanMgr.cleanup(k)});let M,q=null,C=null,T=["none"];this.config.password!==void 0&&T.push("password"),f!==void 0&&T.push("publickey"),this._agent!==void 0&&T.push("agent"),this.config.tryKeyboard&&T.push("keyboard-interactive"),f!==void 0&&this.config.localHostname!==void 0&&this.config.localUsername!==void 0&&T.push("hostbased"),Array.isArray(i)?i=uh(i):typeof i!="function"&&(i=uh(T));let F=!1,D=w=>{if(!F){if(F=!0,w===!1){let k=new Error("All configured authentication methods failed");k.level="client-authentication",this.emit("error",k),this.end();return}if(typeof w=="string"){let k=w;if(T.indexOf(k)===-1)return ne(`Authentication method not allowed: ${k}`);let $=this.config.username;switch(k){case"password":w={type:k,username:$,password:this.config.password};break;case"publickey":w={type:k,username:$,key:f};break;case"hostbased":w={type:k,username:$,key:f,localHostname:this.config.localHostname,localUsername:this.config.localUsername};break;case"agent":w={type:k,username:$,agentCtx:new eh(this._agent)};break;case"keyboard-interactive":w={type:k,username:$,prompt:(...K)=>this.emit("keyboard-interactive",...K)};break;case"none":w={type:k,username:$};break;default:return ne(`Skipping unsupported authentication method: ${w}`)}}else{if(typeof w!="object"||w===null)return ne(`Skipping invalid authentication attempt: ${w}`);{let k=w.username;if(typeof k!="string")return ne(`Skipping invalid authentication attempt: ${w}`);let $=w.type;switch($){case"password":{let{password:K}=w;if(typeof K!="string"&&!Buffer.isBuffer(K))return ne("Skipping invalid password auth attempt");w={type:$,username:k,password:K};break}case"publickey":{let K=Ks(w.key,w.passphrase);if(K instanceof Error)return ne("Skipping invalid key auth attempt");if(!K.isPrivateKey())return ne("Skipping non-private key");w={type:$,username:k,key:K};break}case"hostbased":{let{localHostname:K,localUsername:pe}=w,Ne=Ks(w.key,w.passphrase);if(Ne instanceof Error||typeof K!="string"||typeof pe!="string")return ne("Skipping invalid hostbased auth attempt");if(!Ne.isPrivateKey())return ne("Skipping non-private key");w={type:$,username:k,key:Ne,localHostname:K,localUsername:pe};break}case"agent":{let K=w.agent;if(typeof K=="string"&&K.length)K=th(K);else if(!nh(K))return ne(`Skipping invalid agent: ${w.agent}`);w={type:$,username:k,agentCtx:new eh(K)};break}case"keyboard-interactive":{let{prompt:K}=w;if(typeof K!="function")return ne("Skipping invalid keyboard-interactive auth attempt");w={type:$,username:k,prompt:K};break}case"none":w={type:$,username:k};break;default:return ne(`Skipping unsupported authentication method: ${w}`)}}}M=w;try{let k=M.username;switch(M.type){case"password":p.authPassword(k,M.password);break;case"publickey":p.authPK(k,M.key);break;case"hostbased":p.authHostbased(k,M.key,M.localHostname,M.localUsername,($,K)=>{let pe=M.key.sign($);if(pe instanceof Error)return pe.message=`Error while signing with key: ${pe.message}`,pe.level="client-authentication",this.emit("error",pe),re();K(pe)});break;case"agent":M.agentCtx.init($=>{if($)return $.level="agent",this.emit("error",$),re();ie()});break;case"keyboard-interactive":p.authKeyboard(k);break;case"none":p.authNone(k);break}}finally{F=!1}}};function ne(w){s&&s(w),process.nextTick(re)}function re(){F=!1;let w=i(C,q,D);F||w===void 0||D(w)}let ie=()=>{if(M.type==="agent"){let w=M.agentCtx.nextKey();if(w===!1)s&&s("Agent: No more keys left to try"),s&&s("Client: agent auth failed"),re();else{let k=M.agentCtx.pos();s&&s(`Agent: Trying key #${k+1}`),p.authPK(M.username,w)}}},ee=()=>{this.config.readyTimeout>0&&(this._readyTimeout=setTimeout(()=>{let w=new Error("Timed out while waiting for handshake");w.level="client-timeout",this.emit("error",w),u.destroy()},this.config.readyTimeout))};if(t.sock)ee(),typeof u.connecting=="boolean"&&u.connecting||te();else{let w=this.config.host,k=this.config.forceIPv4,$=this.config.forceIPv6;s&&s(`Client: Trying ${w} on port ${this.config.port} ...`);let K=()=>{ee(),u.connect({host:w,port:this.config.port,localAddress:this.config.localAddress,localPort:this.config.localPort}),u.setNoDelay(!0),u.setMaxListeners(0),u.setTimeout(typeof t.timeout=="number"?t.timeout:0)};!k&&!$||k&&$?K():dE(w,k?4:6,(pe,Ne,Ye)=>{if(pe){let Qe=k?"IPv4":"IPv6",St=new Error(`Error while looking up ${Qe} address for '${w}': ${pe}`);clearTimeout(this._readyTimeout),St.level="client-dns",this.emit("error",St),this.emit("close");return}w=Ne,K()})}return this}end(){return this._sock&&Ct(this._sock)&&(this._protocol.disconnect(Jl.BY_APPLICATION),this._sock.end()),this}destroy(){return this._sock&&Ct(this._sock)&&this._sock.destroy(),this}exec(t,e,r){if(!this._sock||!Ct(this._sock))throw new Error("Not connected");typeof e=="function"&&(r=e,e={});let i={allowHalfOpen:e.allowHalfOpen!==!1};return Mr(this,"session",i,(s,o)=>{if(s){r(s);return}let f=[];function a(u){if(u){o.close(),r(u);return}f.length&&f.shift()()}(this.config.allowAgentFwd===!0||e&&e.agentForward===!0&&this._agent!==void 0)&&f.push(()=>fh(o,a)),typeof e=="object"&&e!==null&&(typeof e.env=="object"&&e.env!==null&&ah(o,e.env),(typeof e.pty=="object"&&e.pty!==null||e.pty===!0)&&f.push(()=>oh(o,e.pty,a)),(typeof e.x11=="object"&&e.x11!==null||e.x11==="number"||e.x11===!0)&&f.push(()=>sh(o,e.x11,a))),f.push(()=>LE(o,t,e,r)),f.shift()()}),this}shell(t,e,r){if(!this._sock||!Ct(this._sock))throw new Error("Not connected");return typeof t=="function"?(r=t,t=e=void 0):typeof e=="function"&&(r=e,e=void 0),t&&(t.x11!==void 0||t.env!==void 0)&&(e=t,t=void 0),Mr(this,"session",(i,s)=>{if(i){r(i);return}let o=[];function f(a){if(a){s.close(),r(a);return}o.length&&o.shift()()}(this.config.allowAgentFwd===!0||e&&e.agentForward===!0&&this._agent!==void 0)&&o.push(()=>fh(s,f)),t!==!1&&o.push(()=>oh(s,t,f)),typeof e=="object"&&e!==null&&(typeof e.env=="object"&&e.env!==null&&ah(s,e.env),(typeof e.x11=="object"&&e.x11!==null||e.x11==="number"||e.x11===!0)&&o.push(()=>sh(s,e.x11,f))),o.push(()=>OE(s,r)),o.shift()()}),this}subsys(t,e){if(!this._sock||!Ct(this._sock))throw new Error("Not connected");return Mr(this,"session",(r,i)=>{if(r){e(r);return}ch(i,t,(s,o)=>{if(s){e(s);return}e(void 0,o)})}),this}forwardIn(t,e,r){if(!this._sock||!Ct(this._sock))throw new Error("Not connected");let i=typeof r=="function";return i&&this._callbacks.push((s,o)=>{if(s){r(s!==!0?s:new Error(`Unable to bind to ${t}:${e}`));return}let f=e;e===0&&o&&o.length>=4&&(f=BE(o,0),this._protocol._compatFlags&gE.DYN_RPORT_BUG||(e=f)),this._forwarding[`${t}:${e}`]=f,r(void 0,f)}),this._protocol.tcpipForward(t,e,i),this}unforwardIn(t,e,r){if(!this._sock||!Ct(this._sock))throw new Error("Not connected");let i=typeof r=="function";return i&&this._callbacks.push(s=>{if(s){r(s!==!0?s:new Error(`Unable to unbind from ${t}:${e}`));return}delete this._forwarding[`${t}:${e}`],r()}),this._protocol.cancelTcpipForward(t,e,i),this}forwardOut(t,e,r,i,s){if(!this._sock||!Ct(this._sock))throw new Error("Not connected");let o={srcIP:t,srcPort:e,dstIP:r,dstPort:i};return typeof s!="function"&&(s=_a),Mr(this,"direct-tcpip",o,s),this}openssh_noMoreSessions(t){if(!this._sock||!Ct(this._sock))throw new Error("Not connected");let e=typeof t=="function";return!this.config.strictVendor||this.config.strictVendor&&Ri.test(this._remoteVer)?(e&&this._callbacks.push(r=>{if(r){t(r!==!0?r:new Error("Unable to disable future sessions"));return}t()}),this._protocol.openssh_noMoreSessions(e),this):e?(process.nextTick(t,new Error("strictVendor enabled and server is not OpenSSH or compatible version")),this):this}openssh_forwardInStreamLocal(t,e){if(!this._sock||!Ct(this._sock))throw new Error("Not connected");let r=typeof e=="function";return!this.config.strictVendor||this.config.strictVendor&&Ri.test(this._remoteVer)?(r&&this._callbacks.push(i=>{if(i){e(i!==!0?i:new Error(`Unable to bind to ${t}`));return}this._forwardingUnix[t]=!0,e()}),this._protocol.openssh_streamLocalForward(t,r),this):r?(process.nextTick(e,new Error("strictVendor enabled and server is not OpenSSH or compatible version")),this):this}openssh_unforwardInStreamLocal(t,e){if(!this._sock||!Ct(this._sock))throw new Error("Not connected");let r=typeof e=="function";return!this.config.strictVendor||this.config.strictVendor&&Ri.test(this._remoteVer)?(r&&this._callbacks.push(i=>{if(i){e(i!==!0?i:new Error(`Unable to unbind from ${t}`));return}delete this._forwardingUnix[t],e()}),this._protocol.openssh_cancelStreamLocalForward(t,r),this):r?(process.nextTick(e,new Error("strictVendor enabled and server is not OpenSSH or compatible version")),this):this}openssh_forwardOutStreamLocal(t,e){if(!this._sock||!Ct(this._sock))throw new Error("Not connected");return typeof e!="function"&&(e=_a),!this.config.strictVendor||this.config.strictVendor&&Ri.test(this._remoteVer)?(Mr(this,"direct-streamlocal@openssh.com",{socketPath:t},e),this):(process.nextTick(e,new Error("strictVendor enabled and server is not OpenSSH or compatible version")),this)}sftp(t){if(!this._sock||!Ct(this._sock))throw new Error("Not connected");return Mr(this,"sftp",(e,r)=>{if(e){t(e);return}ch(r,"sftp",(i,s)=>{if(i){t(i);return}function o(){r.removeListener("ready",f),r.removeListener("error",a),r.removeListener("exit",u),r.removeListener("close",u)}function f(){o(),t(void 0,r)}function a(h){o(),t(h)}function u(h,l){o();let A;typeof h=="number"?A=`Received exit code ${h} while establishing SFTP session`:l!==void 0?A=`Received signal ${l} while establishing SFTP session`:A="Received unexpected SFTP session termination";let p=new Error(A);p.code=h,p.signal=l,t(p)}r.on("ready",f).on("error",a).on("exit",u).on("close",u),r._init()})}),this}};function Mr(n,t,e,r){let i=Ws,s=Gs;typeof e=="function"&&(r=e,e={});let o=(a,u)=>{r(a,u)};o.type=t;let f=n._chanMgr.add(o);if(f===-1){r(new Error("No free channels available"));return}switch(t){case"session":case"sftp":n._protocol.session(f,i,s);break;case"direct-tcpip":n._protocol.directTcpip(f,i,s,e);break;case"direct-streamlocal@openssh.com":n._protocol.openssh_directStreamLocal(f,i,s,e);break;default:throw new Error(`Unsupported channel type: ${t}`)}}function sh(n,t,e){let r={single:!1,protocol:"MIT-MAGIC-COOKIE-1",cookie:void 0,screen:0};typeof t=="function"?e=t:typeof t=="object"&&t!==null&&(typeof t.single=="boolean"&&(r.single=t.single),typeof t.screen=="number"&&(r.screen=t.screen),typeof t.protocol=="string"&&(r.protocol=t.protocol),typeof t.cookie=="string"?r.cookie=t.cookie:Buffer.isBuffer(t.cookie)&&(r.cookie=t.cookie.hexSlice(0,t.cookie.length))),r.cookie===void 0&&(r.cookie=UE());let i=typeof e=="function";if(n.outgoing.state!=="open"){i&&e(new Error("Channel is not open"));return}i&&n._callbacks.push(s=>{if(s){e(s!==!0?s:new Error("Unable to request X11"));return}n._hasX11=!0,++n._client._acceptX11,n.once("close",()=>{n._client._acceptX11&&--n._client._acceptX11}),e()}),n._client._protocol.x11Forward(n.outgoing.id,r,i)}function oh(n,t,e){let r=24,i=80,s=640,o=480,f="vt100",a=null;typeof t=="function"?e=t:typeof t=="object"&&t!==null&&(typeof t.rows=="number"&&(r=t.rows),typeof t.cols=="number"&&(i=t.cols),typeof t.width=="number"&&(s=t.width),typeof t.height=="number"&&(o=t.height),typeof t.term=="string"&&(f=t.term),typeof t.modes=="object"&&(a=t.modes));let u=typeof e=="function";if(n.outgoing.state!=="open"){u&&e(new Error("Channel is not open"));return}u&&n._callbacks.push(h=>{if(h){e(h!==!0?h:new Error("Unable to request a pseudo-terminal"));return}e()}),n._client._protocol.pty(n.outgoing.id,r,i,o,s,f,a,u)}function fh(n,t){let e=typeof t=="function";if(n.outgoing.state!=="open"){e&&t(new Error("Channel is not open"));return}if(n._client._agentFwdEnabled){e&&t(!1);return}n._client._agentFwdEnabled=!0,n._callbacks.push(r=>{if(r){n._client._agentFwdEnabled=!1,e&&t(r!==!0?r:new Error("Unable to request agent forwarding"));return}e&&t()}),n._client._protocol.openssh_agentForward(n.outgoing.id,!0)}function OE(n,t){if(n.outgoing.state!=="open"){t(new Error("Channel is not open"));return}n._callbacks.push(e=>{if(e){t(e!==!0?e:new Error("Unable to open shell"));return}n.subtype="shell",t(void 0,n)}),n._client._protocol.shell(n.outgoing.id,!0)}function LE(n,t,e,r){if(n.outgoing.state!=="open"){r(new Error("Channel is not open"));return}n._callbacks.push(i=>{if(i){r(i!==!0?i:new Error("Unable to exec"));return}n.subtype="exec",n.allowHalfOpen=e.allowHalfOpen!==!1,r(void 0,n)}),n._client._protocol.exec(n.outgoing.id,t,!0)}function ah(n,t){if(n.outgoing.state!=="open")return;let e=Object.keys(t||{});for(let r=0;r<e.length;++r){let i=e[r],s=t[i];n._client._protocol.env(n.outgoing.id,i,s,!1)}}function ch(n,t,e){if(n.outgoing.state!=="open"){e(new Error("Channel is not open"));return}n._callbacks.push(r=>{if(r){e(r!==!0?r:new Error(`Unable to start subsystem: ${t}`));return}n.subtype="subsystem",e(void 0,n)}),n._client._protocol.subsystem(n.outgoing.id,t,!0)}function PE(n,t){let e=-1,r,i=()=>{let a={type:t.type,incoming:{id:e,window:Ws,packetSize:Gs,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}},u=new hh(n,a);return n._chanMgr.update(e,u),n._protocol.channelOpenConfirm(t.sender,e,Ws,Gs),u},s=()=>{r===void 0&&(e===-1?r=mi.RESOURCE_SHORTAGE:r=mi.CONNECT_FAILED),e!==-1&&n._chanMgr.remove(e),n._protocol.channelOpenFail(t.sender,r,"")},o=()=>(e=n._chanMgr.add(),e===-1&&(r=mi.RESOURCE_SHORTAGE,n.config.debug&&n.config.debug("Client: Automatic rejection of incoming channel open: no channels available")),e!==-1),f=t.data;switch(t.type){case"forwarded-tcpip":{let a=n._forwarding[`${f.destIP}:${f.destPort}`];if(a!==void 0&&o()){f.destPort===0&&(f.destPort=a),n.emit("tcp connection",f,i,s);return}break}case"forwarded-streamlocal@openssh.com":if(n._forwardingUnix[f.socketPath]!==void 0&&o()){n.emit("unix connection",f,i,s);return}break;case"auth-agent@openssh.com":if(n._agentFwdEnabled&&typeof n._agent.getStream=="function"&&o()){n._agent.getStream((a,u)=>{if(a)return s();let h=i();h.pipe(u).pipe(h)});return}break;case"x11":if(n._acceptX11!==0&&o()){n.emit("x11",f,i,s);return}break;default:r=mi.UNKNOWN_CHANNEL_TYPE,n.config.debug&&n.config.debug(`Client: Automatic rejection of unsupported incoming channel open type: ${t.type}`)}r===void 0&&(r=mi.ADMINISTRATIVELY_PROHIBITED,n.config.debug&&n.config.debug("Client: Automatic rejection of unexpected incoming channel open for: "+t.type)),s()}var UE=(()=>{let n=Buffer.allocUnsafe(16);return()=>(lE(n,0,16),n.hexSlice(0,16))})();function uh(n){if(!Array.isArray(n))throw new Error("authList must be an array");let t=0;return(e,r,i)=>t===n.length?!1:n[t++]}function DE(n,t,e){if(!n._sock||!Ct(n._sock))return;if(typeof e!="function"&&(e=_a),!Array.isArray(t))throw new TypeError("Invalid keys argument type");let r=[];for(let i of t){let s=Ks(i);if(s instanceof Error)throw s;r.push(s)}if(!n.config.strictVendor||n.config.strictVendor&&Ri.test(n._remoteVer)){n._callbacks.push((i,s)=>{if(i){e(i!==!0?i:new Error("Server failed to prove supplied keys"));return}let o=[],f=0;for(qs.init(s,0);qs.avail()&&f!==r.length;){let a=r[f++],u=a.getPublicSSH(),h=qs.readString();Ms.init(h,0);let l=Ms.readString(!0),A=Ms.readString(),p;if(l!==a.type)if(a.type==="ssh-rsa")switch(l){case"rsa-sha2-256":p="sha256";break;case"rsa-sha2-512":p="sha512";break;default:continue}else continue;let y=n._protocol._kex.sessionID,I=Buffer.allocUnsafe(4+29+4+y.length+4+u.length),v=0;Aa(I,29,v),I.utf8Write("hostkeys-prove-00@openssh.com",v+=4,29),Aa(I,y.length,v+=29),Zl(y,I,0,y.length,v+=4),Aa(I,u.length,v+=y.length),Zl(u,I,0,u.length,v+=4),!!(A=vE(A,l))&&a.verify(I,A,p)===!0&&o.push(a)}Ms.clear(),qs.clear(),e(null,o)}),n._protocol.openssh_hostKeysProve(r);return}process.nextTick(e,new Error("strictVendor enabled and server is not OpenSSH or compatible version"))}dh.exports=ga});var _h=_e(Ah=>{"use strict";var{Agent:ba}=require("http"),{Agent:QE}=require("https"),{connect:HE}=require("tls"),pa;for(let n of[ba,QE]){class t extends n{constructor(r,i){super(i),this._connectCfg=r,this._defaultSrcIP=i&&i.srcIP||"localhost"}createConnection(r,i){let s=r&&r.localAddress||this._defaultSrcIP,o=r&&r.localPort||0,f=r.host,a=r.port;pa===void 0&&(pa=Ea());let u=new pa,h=!1;u.on("ready",()=>{u.forwardOut(s,o,f,a,(l,A)=>{if(h=!0,l)return u.end(),i(l);A.once("close",()=>u.end()),i(null,FE(A,n,r))})}).on("error",i).on("close",()=>{h||i(new Error("Unexpected connection close"))}).connect(this._connectCfg)}}Ah[n===ba?"SSHTTPAgent":"SSHTTPSAgent"]=t}function Bi(){}function FE(n,t,e){if(t===ba)return n.setKeepAlive=Bi,n.setNoDelay=Bi,n.setTimeout=Bi,n.ref=Bi,n.unref=Bi,n.destroySoon=n.destroy,n;e.socket=n;let r=HE(e),i=(()=>{let s=!1;return()=>{s||(s=!0,n.isPaused()&&n.resume())}})();return r.on("end",i).on("close",i),r}});var Eh=_e((qb,wa)=>{"use strict";var{Server:qE}=require("net"),Ni=require("events"),{listenerCount:Ht}=Ni,{CHANNEL_OPEN_FAILURE:Kr,DEFAULT_CIPHER:ME,DEFAULT_COMPRESSION:KE,DEFAULT_KEX:WE,DEFAULT_MAC:GE,DEFAULT_SERVER_HOST_KEY:$E,DISCONNECT_REASON:Wr,DISCONNECT_REASON_BY_VALUE:YE,SUPPORTED_CIPHER:jE,SUPPORTED_COMPRESSION:XE,SUPPORTED_KEX:VE,SUPPORTED_MAC:zE,SUPPORTED_SERVER_HOST_KEY:JE}=Ln(),{init:ZE}=fr(),{KexInit:ep}=Os(),{parseKey:gh}=jn(),tp=jf(),{SFTP:np}=xi(),{writeUInt32BE:rp}=An(),{Channel:Gr,MAX_WINDOW:zn,PACKET_SIZE:Jn,windowAdjust:ip,WINDOW_THRESHOLD:sp}=ua(),{ChannelManager:op,generateAlgorithmList:vi,isWritable:$s,onChannelOpenFailure:fp,onCHANNEL_CLOSE:ap}=da(),cp=10,Zn=class extends Ni{constructor(t,e,r,i,s){super(),this.username=this.user=e,this.service=r,this.method=i,this._initialResponse=!1,this._finalResponse=!1,this._multistep=!1,this._cbfinal=(o,f,a)=>{this._finalResponse||(this._finalResponse=!0,s(this,o,f,a))},this._protocol=t}accept(){this._cleanup&&this._cleanup(),this._initialResponse=!0,this._cbfinal(!0)}reject(t,e){this._cleanup&&this._cleanup(),this._initialResponse=!0,this._cbfinal(!1,t,e)}},Ys=class extends Zn{constructor(t,e,r,i,s,o){super(t,e,r,i,o),this._multistep=!0,this._cb=void 0,this._onInfoResponse=f=>{let a=this._cb;a&&(this._cb=void 0,a(f))},this.submethods=s,this.on("abort",()=>{this._cb&&this._cb(new Error("Authentication request aborted"))})}prompt(t,e,r,i){Array.isArray(t)||(t=[t]),typeof e=="function"?(i=e,e=r=void 0):typeof r=="function"?(i=r,r=void 0):typeof i!="function"&&(i=void 0);for(let s=0;s<t.length;++s)typeof t[s]=="string"&&(t[s]={prompt:t[s],echo:!0});this._cb=i,this._initialResponse=!0,this._protocol.authInfoReq(e,r,t)}},ya=class extends Zn{constructor(t,e,r,i,s,o){super(t,e,r,i,o),this.key={algo:s.keyAlgo,data:s.key},this.signature=s.signature,this.blob=s.blob}accept(){this.signature?Zn.prototype.accept.call(this):(this._initialResponse=!0,this._protocol.authPKOK(this.key.algo,this.key.data))}},xa=class extends Zn{constructor(t,e,r,i,s,o){super(t,e,r,i,o),this.key={algo:s.keyAlgo,data:s.key},this.signature=s.signature,this.blob=s.blob,this.localHostname=s.localHostname,this.localUsername=s.localUsername}},js=class extends Zn{constructor(t,e,r,i,s,o){super(t,e,r,i,o),this.password=s,this._changeCb=void 0}requestChange(t,e){if(this._changeCb)throw new Error("Change request already in progress");if(typeof t!="string")throw new Error("prompt argument must be a string");if(typeof e!="function")throw new Error("Callback argument must be a function");this._changeCb=e,this._protocol.authPasswdChg(t)}},mn=class extends Ni{constructor(t,e,r){super(),this.type="session",this.subtype=void 0,this.server=!0,this._ending=!1,this._channel=void 0,this._chanInfo={type:"session",incoming:{id:r,window:zn,packetSize:Jn,state:"open"},outgoing:{id:e.sender,window:e.window,packetSize:e.packetSize,state:"open"}}}},tn=class extends Ni{constructor(t,e){if(super(),typeof t!="object"||t===null)throw new Error("Missing configuration object");let r=Object.create(null),i=[],s=t.hostKeys;if(!Array.isArray(s))throw new Error("hostKeys must be an array");let o=typeof t.algorithms=="object"&&t.algorithms!==null?t.algorithms:{},f=vi(o.serverHostKey,$E,JE);for(let A=0;A<s.length;++A){let p;if(Buffer.isBuffer(s[A])||typeof s[A]=="string"?p=gh(s[A]):p=gh(s[A].key,s[A].passphrase),p instanceof Error)throw new Error(`Cannot parse privateKey: ${p.message}`);if(Array.isArray(p)&&(p=p[0]),p.getPrivatePEM()===null)throw new Error("privateKey value contains an invalid private key");if(!i.includes(p.type))if(p.type==="ssh-rsa"){let y=f.indexOf("ssh-rsa"),I=f.indexOf("rsa-sha2-256"),v=f.indexOf("rsa-sha2-512");y===-1&&(y=1/0),[y,I,v].sort(up).forEach(x=>{if(x===-1)return;let O;switch(x){case y:O="ssh-rsa";break;case I:O="rsa-sha2-256";break;case v:O="rsa-sha2-512";break;default:return}r[O]=p,i.push(O)})}else r[p.type]=p,i.push(p.type)}let a={kex:vi(o.kex,WE,VE),serverHostKey:i,cs:{cipher:vi(o.cipher,ME,jE),mac:vi(o.hmac,GE,zE),compress:vi(o.compress,KE,XE),lang:[]},sc:void 0};a.sc=a.cs,typeof e=="function"&&this.on("connection",e);let u=typeof t.debug=="function"?t.debug:void 0,h=t.ident?Buffer.from(t.ident):void 0,l=new ep(a);this._srv=new qE(A=>{if(this._connections>=this.maxConnections){A.destroy();return}++this._connections,A.once("close",()=>{--this._connections});let p;if(u){let y=`[${process.hrtime().join(".")}] `;p=I=>{u(`${y}${I}`)}}new Xs(A,r,h,l,p,this,t)}).on("error",A=>{this.emit("error",A)}).on("listening",()=>{this.emit("listening")}).on("close",()=>{this.emit("close")}),this._connections=0,this.maxConnections=1/0}injectSocket(t){this._srv.emit("connection",t)}listen(...t){return this._srv.listen(...t),this}address(){return this._srv.address()}getConnections(t){return this._srv.getConnections(t),this}close(t){return this._srv.close(t),this}ref(){return this._srv.ref(),this}unref(){return this._srv.unref(),this}};tn.KEEPALIVE_CLIENT_INTERVAL=15e3;tn.KEEPALIVE_CLIENT_COUNT_MAX=3;var Xs=class extends Ni{constructor(t,e,r,i,s,o,f){super();let a=0,u=!1,h=[],l,A,p,y=[];this._sock=t,this._chanMgr=new op(this),this._debug=s,this.noMoreSessions=!1,this.authenticated=!1;function I(M){}this.on("error",I);let v=s?(M,q,C)=>{s(`Debug output from client: ${JSON.stringify(C)}`)}:void 0,x=typeof f.keepaliveInterval=="number"&&isFinite(f.keepaliveInterval)&&f.keepaliveInterval>0?f.keepaliveInterval:typeof tn.KEEPALIVE_CLIENT_INTERVAL=="number"&&isFinite(tn.KEEPALIVE_CLIENT_INTERVAL)&&tn.KEEPALIVE_CLIENT_INTERVAL>0?tn.KEEPALIVE_CLIENT_INTERVAL:-1,O=typeof f.keepaliveCountMax=="number"&&isFinite(f.keepaliveCountMax)&&f.keepaliveCountMax>=0?f.keepaliveCountMax:typeof tn.KEEPALIVE_CLIENT_COUNT_MAX=="number"&&isFinite(tn.KEEPALIVE_CLIENT_COUNT_MAX)&&tn.KEEPALIVE_CLIENT_COUNT_MAX>=0?tn.KEEPALIVE_CLIENT_COUNT_MAX:-1,X=0;x!==-1&&O!==-1&&(this.once("ready",()=>{let M=()=>{clearInterval(A)};this.on("close",M).on("end",M),A=setInterval(()=>{if(++X>O){clearInterval(A);let q=new Error("Keepalive timeout");q.level="client-timeout",this.emit("error",q),this.end()}else H.ping()},x)}),p=()=>{A&&A.refresh(),X=0});let H=this._protocol=new tp({server:!0,hostKeys:e,ident:r,offer:i,onPacket:p,greeting:f.greeting,banner:f.banner,onWrite:M=>{$s(t)&&t.write(M)},onError:M=>{H._destruct||t.removeAllListeners("data"),this.emit("error",M);try{t.end()}catch{}},onHeader:M=>{this.removeListener("error",I);let q={ip:t.remoteAddress,family:t.remoteFamily,port:t.remotePort,header:M};if(!o.emit("connection",this,q)){H.disconnect(Wr.BY_APPLICATION),t.end();return}M.greeting&&this.emit("greeting",M.greeting)},onHandshakeComplete:M=>{++a>1&&this.emit("rekey"),this.emit("handshake",M)},debug:s,messageHandlers:{DEBUG:v,DISCONNECT:(M,q,C)=>{if(q!==Wr.BY_APPLICATION){C||(C=YE[q],C===void 0&&(C=`Unexpected disconnection reason: ${q}`));let T=new Error(C);T.code=q,this.emit("error",T)}t.end()},CHANNEL_OPEN:(M,q)=>{if(q.type==="session"&&this.noMoreSessions||!this.authenticated){let ee=Kr.ADMINISTRATIVELY_PROHIBITED;return H.channelOpenFail(q.sender,ee)}let C=-1,T,F=!1,D,ne=()=>{F||(F=!0,T===void 0&&(C===-1?T=Kr.RESOURCE_SHORTAGE:T=Kr.CONNECT_FAILED),C!==-1&&this._chanMgr.remove(C),H.channelOpenFail(q.sender,T,""))},re=()=>(C=this._chanMgr.add(),C===-1&&(T=Kr.RESOURCE_SHORTAGE,s&&s("Automatic rejection of incoming channel open: no channels available")),C!==-1),ie=q.data;switch(q.type){case"session":if(Ht(this,"session")&&re()){D=()=>{if(F)return;F=!0;let ee=new mn(this,q,C);return this._chanMgr.update(C,ee),H.channelOpenConfirm(q.sender,C,zn,Jn),ee},this.emit("session",D,ne);return}break;case"direct-tcpip":if(Ht(this,"tcpip")&&re()){D=()=>{if(F)return;F=!0;let ee={type:void 0,incoming:{id:C,window:zn,packetSize:Jn,state:"open"},outgoing:{id:q.sender,window:q.window,packetSize:q.packetSize,state:"open"}},w=new Gr(this,ee,{server:!0});return this._chanMgr.update(C,w),H.channelOpenConfirm(q.sender,C,zn,Jn),w},this.emit("tcpip",D,ne,ie);return}break;case"direct-streamlocal@openssh.com":if(Ht(this,"openssh.streamlocal")&&re()){D=()=>{if(F)return;F=!0;let ee={type:void 0,incoming:{id:C,window:zn,packetSize:Jn,state:"open"},outgoing:{id:q.sender,window:q.window,packetSize:q.packetSize,state:"open"}},w=new Gr(this,ee,{server:!0});return this._chanMgr.update(C,w),H.channelOpenConfirm(q.sender,C,zn,Jn),w},this.emit("openssh.streamlocal",D,ne,ie);return}break;default:T=Kr.UNKNOWN_CHANNEL_TYPE,s&&s(`Automatic rejection of unsupported incoming channel open type: ${q.type}`)}T===void 0&&(T=Kr.ADMINISTRATIVELY_PROHIBITED,s&&s(`Automatic rejection of unexpected incoming channel open for: ${q.type}`)),ne()},CHANNEL_OPEN_CONFIRMATION:(M,q)=>{let C=this._chanMgr.get(q.recipient);if(typeof C!="function")return;let T={type:C.type,incoming:{id:q.recipient,window:zn,packetSize:Jn,state:"open"},outgoing:{id:q.sender,window:q.window,packetSize:q.packetSize,state:"open"}},F=new Gr(this,T,{server:!0});this._chanMgr.update(q.recipient,F),C(void 0,F)},CHANNEL_OPEN_FAILURE:(M,q,C,T)=>{let F=this._chanMgr.get(q);if(typeof F!="function")return;fp(this,q,{reason:C,description:T},F)},CHANNEL_DATA:(M,q,C)=>{let T=this._chanMgr.get(q);if(!(typeof T!="object"||T===null)&&!(T.constructor===mn&&(T=T._channel,!T))&&T.incoming.window!==0){if(T.incoming.window-=C.length,T.push(C)===!1){T._waitChanDrain=!0;return}T.incoming.window<=sp&&ip(T)}},CHANNEL_EXTENDED_DATA:(M,q,C,T)=>{},CHANNEL_WINDOW_ADJUST:(M,q,C)=>{let T=this._chanMgr.get(q);typeof T!="object"||T===null||T.constructor===mn&&(T=T._channel,!T)||(T.outgoing.window+=C,T._waitWindow&&(T._waitWindow=!1,T._chunk?T._write(T._chunk,null,T._chunkcb):T._chunkcb?T._chunkcb():T._chunkErr?T.stderr._write(T._chunkErr,null,T._chunkcbErr):T._chunkcbErr&&T._chunkcbErr()))},CHANNEL_SUCCESS:(M,q)=>{let C=this._chanMgr.get(q);typeof C!="object"||C===null||C.constructor===mn&&(C=C._channel,!C)||C._callbacks.length&&C._callbacks.shift()(!1)},CHANNEL_FAILURE:(M,q)=>{let C=this._chanMgr.get(q);typeof C!="object"||C===null||C.constructor===mn&&(C=C._channel,!C)||C._callbacks.length&&C._callbacks.shift()(!0)},CHANNEL_REQUEST:(M,q,C,T,F)=>{let D=this._chanMgr.get(q);if(typeof D!="object"||D===null)return;let ne=!1,re,ie;if(D.constructor!==mn){T&&H.channelFailure(D.outgoing.id);return}if(T&&(C!=="shell"&&C!=="exec"&&C!=="subsystem"&&(re=()=>{ne||D._ending||D._channel||(ne=!0,H.channelSuccess(D._chanInfo.outgoing.id))}),ie=()=>{ne||D._ending||D._channel||(ne=!0,H.channelFailure(D._chanInfo.outgoing.id))}),D._ending){ie&&ie();return}switch(C){case"env":if(Ht(D,"env")){D.emit("env",re,ie,{key:F.name,val:F.value});return}break;case"pty-req":if(Ht(D,"pty")){D.emit("pty",re,ie,F);return}break;case"window-change":Ht(D,"window-change")?D.emit("window-change",re,ie,F):ie&&ie();break;case"x11-req":if(Ht(D,"x11")){D.emit("x11",re,ie,F);return}break;case"signal":if(Ht(D,"signal")){D.emit("signal",re,ie,{name:F});return}break;case"auth-agent-req@openssh.com":if(Ht(D,"auth-agent")){D.emit("auth-agent",re,ie);return}break;case"shell":if(Ht(D,"shell")){re=()=>{if(ne||D._ending||D._channel)return;ne=!0,T&&H.channelSuccess(D._chanInfo.outgoing.id);let ee=new Gr(this,D._chanInfo,{server:!0});return ee.subtype=D.subtype=C,D._channel=ee,ee},D.emit("shell",re,ie);return}break;case"exec":if(Ht(D,"exec")){re=()=>{if(ne||D._ending||D._channel)return;ne=!0,T&&H.channelSuccess(D._chanInfo.outgoing.id);let ee=new Gr(this,D._chanInfo,{server:!0});return ee.subtype=D.subtype=C,D._channel=ee,ee},D.emit("exec",re,ie,{command:F});return}break;case"subsystem":{let ee=F==="sftp";if(re=()=>{if(ne||D._ending||D._channel)return;ne=!0,T&&H.channelSuccess(D._chanInfo.outgoing.id);let w;return ee?w=new np(this,D._chanInfo,{server:!0,debug:s}):(w=new Gr(this,D._chanInfo,{server:!0}),w.subtype=D.subtype=`${C}:${F}`),D._channel=w,w},F==="sftp"){if(Ht(D,"sftp")){D.emit("sftp",re,ie);return}ee=!1}if(Ht(D,"subsystem")){D.emit("subsystem",re,ie,{name:F});return}break}}s&&s(`Automatic rejection of incoming channel request: ${C}`),ie&&ie()},CHANNEL_EOF:(M,q)=>{let C=this._chanMgr.get(q);typeof C!="object"||C===null||C.constructor===mn&&(C._ending||(C._ending=!0,C.emit("eof"),C.emit("end")),C=C._channel,!C)||C.incoming.state==="open"&&(C.incoming.state="eof",C.readable&&C.push(null))},CHANNEL_CLOSE:(M,q)=>{let C=this._chanMgr.get(q);typeof C!="object"||C===null||C.constructor===mn&&(C._ending=!0,C.emit("close"),C=C._channel,!C)||ap(this,q,C)},SERVICE_REQUEST:(M,q)=>{if(a===0||u||this.authenticated||q!=="ssh-userauth"){H.disconnect(Wr.SERVICE_NOT_AVAILABLE),t.end();return}u=!0,H.serviceAccept(q)},USERAUTH_REQUEST:(M,q,C,T,F)=>{if(a===0||this.authenticated||l&&(l.username!==q||l.service!==C)||T!=="password"&&T!=="publickey"&&T!=="hostbased"&&T!=="keyboard-interactive"&&T!=="none"||h.length===cp){H.disconnect(Wr.PROTOCOL_ERROR),t.end();return}else if(C!=="ssh-connection"){H.disconnect(Wr.SERVICE_NOT_AVAILABLE),t.end();return}let D;switch(T){case"keyboard-interactive":D=new Ys(H,q,C,T,F,te);break;case"publickey":D=new ya(H,q,C,T,F,te);break;case"hostbased":D=new xa(H,q,C,T,F,te);break;case"password":if(l&&l instanceof js&&l._changeCb){let ne=l._changeCb;l._changeCb=void 0,ne(F.newPassword);return}D=new js(H,q,C,T,F,te);break;case"none":D=new Zn(H,q,C,T,te);break}if(l)if(l._initialResponse)l._multistep&&!l._finalResponse&&(l._cleanup&&l._cleanup(),l.emit("abort"));else return h.push(D);l=D,Ht(this,"authentication")?this.emit("authentication",l):l.reject()},USERAUTH_INFO_RESPONSE:(M,q)=>{l&&l instanceof Ys&&l._onInfoResponse(q)},GLOBAL_REQUEST:(M,q,C,T)=>{let F={type:null,buf:null};function D(ne,re){F.type=ne,F.buf=re,ce()}if(C&&y.push(F),(q==="tcpip-forward"||q==="cancel-tcpip-forward"||q==="no-more-sessions@openssh.com"||q==="streamlocal-forward@openssh.com"||q==="cancel-streamlocal-forward@openssh.com")&&Ht(this,"request")&&this.authenticated){let ne,re;if(C){let ie=!1;ne=ee=>{if(ie)return;ie=!0;let w;q==="tcpip-forward"&&T.bindPort===0&&typeof ee=="number"&&(w=Buffer.allocUnsafe(4),rp(w,ee,0)),D("SUCCESS",w)},re=()=>{ie||(ie=!0,D("FAILURE"))}}if(q==="no-more-sessions@openssh.com"){this.noMoreSessions=!0,ne&&ne();return}this.emit("request",ne,re,q,T)}else C&&D("FAILURE")}}});t.pause(),ZE.then(()=>{H.start(),t.on("data",M=>{try{H.parse(M,0,M.length)}catch(q){this.emit("error",q);try{$s(t)&&t.end()}catch{}}}),t.resume()}).catch(M=>{this.emit("error",M);try{$s(t)&&t.end()}catch{}}),t.on("error",M=>{M.level="socket",this.emit("error",M)}).once("end",()=>{s&&s("Socket ended"),H.cleanup(),this.emit("end")}).once("close",()=>{s&&s("Socket closed"),H.cleanup(),this.emit("close");let M=new Error("No response from server");this._chanMgr.cleanup(M)});let te=(M,q,C,T)=>{l===M&&!this.authenticated&&(q?(l=void 0,this.authenticated=!0,H.authSuccess(),h=[],this.emit("ready")):(H.authFailure(C,T),h.length&&(l=h.pop(),Ht(this,"authentication")?this.emit("authentication",l):l.reject())))};function ce(){for(;y.length>0&&y[0].type;){let M=y.shift();M.type==="SUCCESS"&&H.requestSuccess(M.buf),M.type==="FAILURE"&&H.requestFailure()}}}end(){return this._sock&&$s(this._sock)&&(this._protocol.disconnect(Wr.BY_APPLICATION),this._sock.end()),this}x11(t,e,r){return Ia(this,"x11",{originAddr:t,originPort:e},r),this}forwardOut(t,e,r,i,s){return Ia(this,"forwarded-tcpip",{boundAddr:t,boundPort:e,remoteAddr:r,remotePort:i},s),this}openssh_forwardOutStreamLocal(t,e){return Ia(this,"forwarded-streamlocal@openssh.com",{socketPath:t},e),this}rekey(t){let e;try{this._protocol.rekey()}catch(r){e=r}typeof t=="function"&&(e?process.nextTick(t,e):this.once("rekey",t))}};function Ia(n,t,e,r){let i=zn,s=Jn;typeof e=="function"&&(r=e,e={});let o=(a,u)=>{r(a,u)};o.type=t;let f=n._chanMgr.add(o);if(f===-1){r(new Error("No free channels available"));return}switch(t){case"forwarded-tcpip":n._protocol.forwardedTcpip(f,i,s,e);break;case"x11":n._protocol.x11(f,i,s,e);break;case"forwarded-streamlocal@openssh.com":n._protocol.openssh_forwardedStreamLocal(f,i,s,e);break;default:throw new Error(`Unsupported channel type: ${t}`)}}function up(n,t){return n-t}wa.exports=tn;wa.exports.IncomingClient=Xs});var bh=_e((Mb,ph)=>{"use strict";var{AgentProtocol:lp,BaseAgent:hp,createAgent:dp,CygwinAgent:Ap,OpenSSHAgent:_p,PageantAgent:gp}=kf(),{SSHTTPAgent:Ep,SSHTTPSAgent:pp}=_h(),{parseKey:bp}=jn(),{flagsToString:Ip,OPEN_MODE:yp,STATUS_CODE:xp,stringToFlags:wp}=xi();ph.exports={AgentProtocol:lp,BaseAgent:hp,createAgent:dp,Client:Ea(),CygwinAgent:Ap,HTTPAgent:Ep,HTTPSAgent:pp,OpenSSHAgent:_p,PageantAgent:gp,Server:Eh(),utils:{parseKey:bp,sftp:{flagsToString:Ip,OPEN_MODE:yp,STATUS_CODE:xp,stringToFlags:wp}}}});var Bh=require("node:net"),zt=ln(bo());var $r=ln(require("fs"),1),Ft=ln(require("path"),1),xh=ln(Dc(),1),ma=ln(Hc(),1),Ca=ln(qc(),1);var Oo=ln(require("fs"),1),Lo=ln(require("path"),1),Cr=ln(require("assert"),1);var xn=class{constructor({concurrency:t=1}={}){this.options={concurrency:t},this.running=0,this.queue=[],this.idleCallbacks=[]}clear(){this.queue=[]}onIdle(t){return this.idleCallbacks.push(t),()=>{let e=this.idleCallbacks.indexOf(t);e!==-1&&this.idleCallbacks.splice(e,1)}}waitTillIdle(){return new Promise(t=>{if(this.running===0){t();return}let e=this.onIdle(()=>{e(),t()})})}add(t){return new Promise((e,r)=>{let i=()=>{this.running+=1;try{Promise.resolve(t()).then(s=>{e(s),this.processNext()},s=>{r(s),this.processNext()})}catch(s){r(s),this.processNext()}};this.running>=this.options.concurrency?this.queue.push(i):i()})}processNext(){this.running-=1;let t=this.queue.shift();t?t():this.running===0&&this.idleCallbacks.forEach(e=>e())}};var Mc={join(n,t){return Lo.default.join(n,t)},basename(n){return Lo.default.basename(n)},stat(n){return new Promise((t,e)=>{Oo.default.stat(n,(r,i)=>{r?e(r):t(i)})})},readdir(n){return new Promise((t,e)=>{Oo.default.readdir(n,(r,i)=>{r?e(r):t(i)})})}};async function Kc({path:n,recursive:t,validate:e,result:r,fileSystem:i,queue:s,reject:o}){let f=await i.stat(n);if(f.isFile()?r.files.push(n):f.isDirectory()&&r.directories.push(n),!f.isDirectory()||t==="none")return;(await i.readdir(n)).forEach(u=>{let h=i.join(n,u);!e(h)||s.add(()=>Kc({path:h,recursive:t==="shallow"?"none":"deep",validate:e,result:r,fileSystem:i,queue:s,reject:o})).catch(o)})}async function qA(n,{recursive:t=!0,validate:e=null,concurrency:r=1/0,fileSystem:i=Mc}={}){(0,Cr.default)(n&&typeof n=="string","path must be a valid string"),(0,Cr.default)(typeof t=="boolean","options.recursive must be a valid boolean"),(0,Cr.default)(e===null||typeof e=="function","options.validate must be a valid function"),(0,Cr.default)(typeof r=="number","options.concurrency must be a valid number"),(0,Cr.default)(i!==null&&typeof i=="object","options.fileSystem must be a valid object");let s=new xn({concurrency:r}),o={files:[],directories:[]},f={...Mc,...i};return await new Promise((a,u)=>{Kc({path:n,recursive:t?"deep":"shallow",validate:e??(h=>f.basename(h).slice(0,1)!=="."),result:o,fileSystem:f,queue:s,reject:u}).then(()=>s.waitTillIdle()).then(a,u)}),o}var Po=qA;var Ie=ln(require("assert"),1),wh=ln(bh(),1),Sa=1,Ih=n=>!Ft.default.basename(n).startsWith("."),yh=()=>{},zs=class extends Error{constructor(t,e=null){super(t),this.code=e}};function Vs(n){return n.includes("\\")?n.split("\\").join("/"):n}async function Sp(n){return new Promise((t,e)=>{$r.default.readFile(n,"utf8",(r,i)=>{r?e(r):t(i)})})}var mp=/Error: (E[\S]+): /;async function Cp(n,t){let e=null;try{e=await new Promise((r,i)=>{t.stat(n,(s,o)=>{s?i(s):r(o)})})}catch{}if(e){if(e.isDirectory())return;throw new Error("mkdir() failed, target already exists and is not a directory")}try{await new Promise((r,i)=>{t.mkdir(n,s=>{s?i(s):r()})})}catch(r){if(r!=null&&typeof r.stack=="string"){let i=mp.exec(r.stack);throw i!=null?new zs(r.message,i[1]):r}}}var Js=class{constructor(){this.connection=null}getConnection(){let{connection:t}=this;if(t==null)throw new Error("Not connected to server");return t}async connect(t){(0,Ie.default)(t!=null&&typeof t=="object","config must be a valid object");let e={...t};if((0,Ie.default)(e.username!=null&&typeof e.username=="string","config.username must be a valid string"),e.host!=null)(0,Ie.default)(typeof e.host=="string","config.host must be a valid string");else if(e.sock!=null)(0,Ie.default)(typeof e.sock=="object","config.sock must be a valid object");else throw new Ie.AssertionError({message:"Either config.host or config.sock must be provided"});if(e.privateKey!=null||e.privateKeyPath!=null){if(e.privateKey!=null?((0,Ie.default)(typeof e.privateKey=="string","config.privateKey must be a valid string"),(0,Ie.default)(e.privateKeyPath==null,"config.privateKeyPath must not be specified when config.privateKey is specified")):e.privateKeyPath!=null&&((0,Ie.default)(typeof e.privateKeyPath=="string","config.privateKeyPath must be a valid string"),(0,Ie.default)(e.privateKey==null,"config.privateKey must not be specified when config.privateKeyPath is specified")),(0,Ie.default)(e.passphrase==null||typeof e.passphrase=="string","config.passphrase must be null or a valid string"),e.privateKeyPath!=null)try{e.privateKey=await Sp(e.privateKeyPath)}catch(i){throw i!=null&&i.code==="ENOENT"?new Ie.AssertionError({message:"config.privateKeyPath does not exist at given fs path"}):i}}else e.password!=null&&(0,Ie.default)(typeof e.password=="string","config.password must be a valid string");if(e.tryKeyboard!=null&&(0,Ie.default)(typeof e.tryKeyboard=="boolean","config.tryKeyboard must be a valid boolean"),e.tryKeyboard){let{password:i}=e;e.onKeyboardInteractive!=null?(0,Ie.default)(typeof e.onKeyboardInteractive=="function","config.onKeyboardInteractive must be a valid function"):i!=null&&(e.onKeyboardInteractive=(s,o,f,a,u)=>{a.length>0&&a[0].prompt.toLowerCase().includes("password")&&u([i])})}let r=new wh.default.Client;return this.connection=r,await new Promise((i,s)=>{r.on("error",s),e.onKeyboardInteractive&&r.on("keyboard-interactive",e.onKeyboardInteractive),r.on("ready",()=>{r.removeListener("error",s),i()}),r.on("end",()=>{this.connection===r&&(this.connection=null)}),r.on("close",()=>{this.connection===r&&(this.connection=null),s(new zs("No response from server","ETIMEDOUT"))}),r.connect(e)}),this}isConnected(){return this.connection!=null}async requestShell(t){let e=this.getConnection();return new Promise((r,i)=>{e.on("error",i);let s=(o,f)=>{e.removeListener("error",i),o?i(o):r(f)};t==null?e.shell(s):e.shell(t,s)})}async withShell(t,e){(0,Ie.default)(typeof t=="function","callback must be a valid function");let r=await this.requestShell(e);try{await t(r)}finally{r.close()||r.destroy()}}async requestSFTP(){let t=this.getConnection();return new Promise((e,r)=>{t.on("error",r),t.sftp((i,s)=>{t.removeListener("error",r),i?r(i):e(s)})})}async withSFTP(t){(0,Ie.default)(typeof t=="function","callback must be a valid function");let e=await this.requestSFTP();try{await t(e)}finally{e.end()}}async execCommand(t,e={}){(0,Ie.default)(typeof t=="string","command must be a valid string"),(0,Ie.default)(e!=null&&typeof e=="object","options must be a valid object"),(0,Ie.default)(e.cwd==null||typeof e.cwd=="string","options.cwd must be a valid string"),(0,Ie.default)(e.stdin==null||typeof e.stdin=="string"||ma.default.readable(e.stdin),"options.stdin must be a valid string or readable stream"),(0,Ie.default)(e.execOptions==null||typeof e.execOptions=="object","options.execOptions must be a valid object"),(0,Ie.default)(e.encoding==null||typeof e.encoding=="string","options.encoding must be a valid string"),(0,Ie.default)(e.onChannel==null||typeof e.onChannel=="function","options.onChannel must be a valid function"),(0,Ie.default)(e.onStdout==null||typeof e.onStdout=="function","options.onStdout must be a valid function"),(0,Ie.default)(e.onStderr==null||typeof e.onStderr=="function","options.onStderr must be a valid function");let r=t;e.cwd&&(r=`cd ${(0,Ca.default)([e.cwd])} ; ${r}`);let i=this.getConnection(),s={stdout:[],stderr:[]};return new Promise((o,f)=>{i.on("error",f),i.exec(r,e.execOptions!=null?e.execOptions:{},(a,u)=>{if(i.removeListener("error",f),a){f(a);return}e.onChannel&&e.onChannel(u),u.on("data",A=>{e.onStdout&&e.onStdout(A),s.stdout.push(A.toString(e.encoding))}),u.stderr.on("data",A=>{e.onStderr&&e.onStderr(A),s.stderr.push(A.toString(e.encoding))}),e.stdin!=null?ma.default.readable(e.stdin)?e.stdin.pipe(u,{end:!0}):(u.write(e.stdin),u.end()):u.end();let h=null,l=null;u.on("exit",(A,p)=>{h=A??null,l=p??null}),u.on("close",()=>{o({code:h??null,signal:l??null,stdout:s.stdout.join("").trim(),stderr:s.stderr.join("").trim()})})})})}async exec(t,e,r={}){(0,Ie.default)(typeof t=="string","command must be a valid string"),(0,Ie.default)(Array.isArray(e),"parameters must be a valid array"),(0,Ie.default)(r!=null&&typeof r=="object","options must be a valid object"),(0,Ie.default)(r.stream==null||["both","stdout","stderr"].includes(r.stream),"options.stream must be one of both, stdout, stderr");for(let o=0,{length:f}=e;o<f;o+=1)(0,Ie.default)(typeof e[o]=="string",`parameters[${o}] must be a valid string`);let i=`${t} ${(0,Ca.default)(e)}`,s=await this.execCommand(i,r);if(r.stream==null||r.stream==="stdout"){if(s.stderr)throw new Error(s.stderr);return s.stdout}return r.stream==="stderr"?s.stderr:s}async mkdir(t,e="sftp",r=null){if((0,Ie.default)(typeof t=="string","path must be a valid string"),(0,Ie.default)(typeof e=="string"&&(e==="sftp"||e==="exec"),"method must be either sftp or exec"),(0,Ie.default)(r==null||typeof r=="object","sftp must be a valid object"),e==="exec"){await this.exec("mkdir",["-p",Vs(t)]);return}let i=r||await this.requestSFTP(),s=async o=>Cp(Vs(t),i).catch(async f=>{if(!o||f==null||f.message!=="No such file"&&f.code!=="ENOENT")throw f;await this.mkdir(Ft.default.dirname(t),"sftp",i),await s(!1)});try{await s(!0)}finally{r||i.end()}}async getFile(t,e,r=null,i=null){(0,Ie.default)(typeof t=="string","localFile must be a valid string"),(0,Ie.default)(typeof e=="string","remoteFile must be a valid string"),(0,Ie.default)(r==null||typeof r=="object","sftp must be a valid object"),(0,Ie.default)(i==null||typeof i=="object","transferOptions must be a valid object");let s=r||await this.requestSFTP();try{await new Promise((o,f)=>{s.fastGet(Vs(e),t,i||{},a=>{a?f(a):o()})})}finally{r||s.end()}}async putFile(t,e,r=null,i=null){(0,Ie.default)(typeof t=="string","localFile must be a valid string"),(0,Ie.default)(typeof e=="string","remoteFile must be a valid string"),(0,Ie.default)(r==null||typeof r=="object","sftp must be a valid object"),(0,Ie.default)(i==null||typeof i=="object","transferOptions must be a valid object"),(0,Ie.default)(await new Promise(f=>{$r.default.access(t,$r.default.constants.R_OK,a=>{f(a===null)})}),`localFile does not exist at ${t}`);let s=r||await this.requestSFTP(),o=f=>new Promise((a,u)=>{s.fastPut(t,Vs(e),i||{},h=>{if(h==null){a();return}h.message==="No such file"&&f?a(this.mkdir(Ft.default.dirname(e),"sftp",s).then(()=>o(!1))):u(h)})});try{await o(!0)}finally{r||s.end()}}async putFiles(t,{concurrency:e=Sa,sftp:r=null,transferOptions:i={}}={}){(0,Ie.default)(Array.isArray(t),"files must be an array");for(let a=0,{length:u}=t;a<u;a+=1){let h=t[a];(0,Ie.default)(h,"files items must be valid objects"),(0,Ie.default)(h.local&&typeof h.local=="string",`files[${a}].local must be a string`),(0,Ie.default)(h.remote&&typeof h.remote=="string",`files[${a}].remote must be a string`)}let s=[],o=r||await this.requestSFTP(),f=new xn({concurrency:e});try{await new Promise((a,u)=>{t.forEach(h=>{f.add(async()=>{await this.putFile(h.local,h.remote,o,i),s.push(h)}).catch(u)}),f.waitTillIdle().then(a)})}catch(a){throw a!=null&&(a.transferred=s),a}finally{r||o.end()}}async putDirectory(t,e,{concurrency:r=Sa,sftp:i=null,transferOptions:s={},recursive:o=!0,tick:f=yh,validate:a=Ih}={}){(0,Ie.default)(typeof t=="string"&&t,"localDirectory must be a string"),(0,Ie.default)(typeof e=="string"&&e,"remoteDirectory must be a string");let u=await new Promise(I=>{$r.default.stat(t,(v,x)=>{I(x||null)})});(0,Ie.default)(u!=null,`localDirectory does not exist at ${t}`),(0,Ie.default)(u.isDirectory(),`localDirectory is not a directory at ${t}`);let h=i||await this.requestSFTP(),l=await Po(t,{recursive:o,validate:a}),A=l.files.map(I=>Ft.default.relative(t,I)),p=l.directories.map(I=>Ft.default.relative(t,I));p.sort((I,v)=>I.length-v.length);let y=!1;try{await new Promise((I,v)=>{let x=new xn({concurrency:r});p.forEach(O=>{x.add(async()=>{await this.mkdir(Ft.default.join(e,O),"sftp",h)}).catch(v)}),I(x.waitTillIdle())}),await new Promise((I,v)=>{let x=new xn({concurrency:r});A.forEach(O=>{x.add(async()=>{let X=Ft.default.join(t,O),H=Ft.default.join(e,O);try{await this.putFile(X,H,h,s),f(X,H,null)}catch(te){y=!0,f(X,H,te)}}).catch(v)}),I(x.waitTillIdle())})}finally{i||h.end()}return!y}async getDirectory(t,e,{concurrency:r=Sa,sftp:i=null,transferOptions:s={},recursive:o=!0,tick:f=yh,validate:a=Ih}={}){(0,Ie.default)(typeof t=="string"&&t,"localDirectory must be a string"),(0,Ie.default)(typeof e=="string"&&e,"remoteDirectory must be a string");let u=await new Promise(I=>{$r.default.stat(t,(v,x)=>{I(x||null)})});(0,Ie.default)(u!=null,`localDirectory does not exist at ${t}`),(0,Ie.default)(u.isDirectory(),`localDirectory is not a directory at ${t}`);let h=i||await this.requestSFTP(),l=await Po(e,{recursive:o,validate:a,concurrency:r,fileSystem:{basename(I){return Ft.default.posix.basename(I)},join(I,v){return Ft.default.posix.join(I,v)},readdir(I){return new Promise((v,x)=>{h.readdir(I,(O,X)=>{O?x(O):v(X.map(H=>H.filename))})})},stat(I){return new Promise((v,x)=>{h.stat(I,(O,X)=>{O?x(O):v(X)})})}}}),A=l.files.map(I=>Ft.default.relative(e,I)),p=l.directories.map(I=>Ft.default.relative(e,I));p.sort((I,v)=>I.length-v.length);let y=!1;try{await new Promise((I,v)=>{let x=new xn({concurrency:r});p.forEach(O=>{x.add(async()=>{await(0,xh.default)(Ft.default.join(t,O))}).catch(v)}),I(x.waitTillIdle())}),await new Promise((I,v)=>{let x=new xn({concurrency:r});A.forEach(O=>{x.add(async()=>{let X=Ft.default.join(t,O),H=Ft.default.join(e,O);try{await this.getFile(X,H,h,s),f(X,H,null)}catch(te){y=!0,f(X,H,te)}}).catch(v)}),I(x.waitTillIdle())})}finally{i||h.end()}return!y}dispose(){this.connection&&(this.connection.end(),this.connection=null)}};function Ra(n){let t=/^\\\\\?\\/.test(n),e=/[^\u0000-\u0080]+/.test(n);return t||e?n:n.replace(/\\/g,"/")}var Sh=require("node:fs/promises"),mh=require("node:path");async function*Ch(n){let t=await(0,Sh.readdir)(n,{withFileTypes:!0});for(let e of t){let r=(0,mh.resolve)(n,e.name);e.isDirectory()?yield*Ch(r):yield r}}var Rh=Ch;var Rp=async()=>{try{let n=(0,zt.getInput)("host",{required:!0}),t=(0,zt.getInput)("port"),e=(0,zt.getInput)("username",{required:!0}),r=(0,zt.getInput)("privateKey",{required:!0}),i=(0,zt.getInput)("pm2"),s=(0,zt.getBooleanInput)("dependencies"),o=(0,zt.getInput)("destination",{required:!0}),f=(0,zt.getInput)("file"),a=(0,zt.getInput)("directory");if(!(0,Bh.isIPv4)(n))throw new Error("Invalid Hostname");let u=new Js;if(await u.connect({host:n,port:parseInt(t),username:e,privateKey:r}),a.length>0&&a.startsWith("/")){let h=[];for await(let l of Rh(`.${a}`))l=Ra(l),h.push({local:`.${l.substring(l.lastIndexOf(a))}`,remote:`${o}${l.substring(l.lastIndexOf(a)+a.length)}`});await u.putFiles(h)}else await u.putFile(`.${f}`,`${o}${f}`);s&&(await u.putFile("./package.json",`${o}/package.json`),await u.putFile("./package-lock.json",`${o}/package-lock.json`),await u.execCommand("npm i",{cwd:o})),i&&await u.execCommand(`pm2 restart ${i} --cron-restart="0 0 * * *" --exp-backoff-restart-delay=100`),u.connection&&u.connection.end()}catch(n){n instanceof Error?(0,zt.setFailed)(n.message):(0,zt.setFailed)("Unknown Error")}finally{process.exit()}};Rp();
